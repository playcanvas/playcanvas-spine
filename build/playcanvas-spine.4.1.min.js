/* Copyright 2015-2021 PlayCanvas Ltd */
"use strict";var spine=(()=>{var p,g=Object.defineProperty,v=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,b=Object.prototype.hasOwnProperty,y={},A=y,k={AlphaTimeline:()=>De,Animation:()=>ge,AnimationState:()=>ut,AnimationStateAdapter:()=>pt,AnimationStateData:()=>kt,AssetManagerBase:()=>Ot,AtlasAttachmentLoader:()=>Dt,Attachment:()=>X,AttachmentTimeline:()=>xe,BinaryInput:()=>me,BlendMode:()=>ce,Bone:()=>Nt,BoneData:()=>Vt,BoundingBoxAttachment:()=>St,CURRENT:()=>At,ClippingAttachment:()=>It,Color:()=>fe,ConstraintData:()=>qt,CurveTimeline:()=>t,CurveTimeline1:()=>o,CurveTimeline2:()=>ht,DebugUtils:()=>M,DeformTimeline:()=>Ne,Downloader:()=>Ut,DrawOrderTimeline:()=>be,Event:()=>$e,EventData:()=>Wt,EventQueue:()=>ft,EventTimeline:()=>we,EventType:()=>u,FIRST:()=>vt,FakeTexture:()=>Ft,HOLD_FIRST:()=>wt,HOLD_MIX:()=>bt,HOLD_SUBSEQUENT:()=>xt,IkConstraint:()=>zt,IkConstraintData:()=>$t,IkConstraintTimeline:()=>qe,IntSet:()=>S,Interpolation:()=>C,MathUtils:()=>W,MeshAttachment:()=>m,MixBlend:()=>_,MixDirection:()=>L,PathAttachment:()=>l,PathConstraint:()=>c,PathConstraintData:()=>jt,PathConstraintMixTimeline:()=>ze,PathConstraintPositionTimeline:()=>Ue,PathConstraintSpacingTimeline:()=>We,PointAttachment:()=>_t,Pool:()=>r,PositionMode:()=>Ht,Pow:()=>T,PowOut:()=>Y,RGB2Timeline:()=>Le,RGBA2Timeline:()=>Ve,RGBATimeline:()=>_e,RGBTimeline:()=>Pe,RegionAttachment:()=>f,RotateMode:()=>ee,RotateTimeline:()=>ve,SETUP:()=>yt,SUBSEQUENT:()=>gt,ScaleTimeline:()=>Me,ScaleXTimeline:()=>Fe,ScaleYTimeline:()=>Ee,SequenceTimeline:()=>ye,ShearTimeline:()=>Xe,ShearXTimeline:()=>Re,ShearYTimeline:()=>Be,Skeleton:()=>ie,SkeletonBinary:()=>ue,SkeletonBounds:()=>xs,SkeletonClipping:()=>ws,SkeletonData:()=>ne,SkeletonJson:()=>bs,Skin:()=>he,SkinEntry:()=>oe,Slot:()=>se,SlotData:()=>le,SpacingMode:()=>te,StringSet:()=>I,Texture:()=>Ct,TextureAtlas:()=>Et,TextureAtlasPage:()=>Rt,TextureAtlasRegion:()=>Bt,TextureFilter:()=>Tt,TextureRegion:()=>Mt,TextureWrap:()=>Yt,TimeKeeper:()=>F,Timeline:()=>V,TrackEntry:()=>mt,TransformConstraint:()=>ae,TransformConstraintData:()=>de,TransformConstraintTimeline:()=>Oe,TransformMode:()=>Lt,TranslateTimeline:()=>Ce,TranslateXTimeline:()=>Te,TranslateYTimeline:()=>Ye,Triangulator:()=>P,Utils:()=>pe,Vector2:()=>i,VertexAttachment:()=>D,WindowedMean:()=>E};for(p in k)g(A,p,{get:k[p],enumerable:!0});var S=class{constructor(){this.array=new Array}add(t){var e=this.contains(t);return this.array[0|t]=0|t,!e}contains(t){return null!=this.array[0|t]}remove(t){this.array[0|t]=void 0}clear(){this.array.length=0}},I=class{constructor(){this.entries={},this.size=0}add(t){var e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}addAll(t){for(var e=this.size,s=0,a=t.length;s<a;s++)this.add(t[s]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}},e=class{constructor(t=0,e=0,s=0,a=0){this.r=t,this.g=e,this.b=s,this.a=a}set(t,e,s,a){return this.r=t,this.g=e,this.b=s,this.a=a,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=8!=t.length?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,s,a){return this.r+=t,this.g+=e,this.b+=s,this.a+=a,this.clamp()}clamp(){return this.r<0?this.r=0:1<this.r&&(this.r=1),this.g<0?this.g=0:1<this.g&&(this.g=1),this.b<0?this.b=0:1<this.b&&(this.b=1),this.a<0?this.a=0:1<this.a&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}static rgb888ToColor(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}static fromString(t){return(new e).setFromString(t)}},fe=e,s=(fe.WHITE=new e(1,1,1,1),fe.RED=new e(1,0,0,1),fe.GREEN=new e(0,1,0,1),fe.BLUE=new e(0,0,1,1),fe.MAGENTA=new e(1,0,1,1),class{static clamp(t,e,s){return t<e?e:s<t?s:t}static cosDeg(t){return Math.cos(t*s.degRad)}static sinDeg(t){return Math.sin(t*s.degRad)}static signum(t){return 0<t?1:t<0?-1:0}static toInt(t){return 0<t?Math.floor(t):Math.ceil(t)}static cbrt(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}static randomTriangular(t,e){return s.randomTriangularWith(t,e,.5*(t+e))}static randomTriangularWith(t,e,s){var a=Math.random(),r=e-t;return a<=(s-t)/r?t+Math.sqrt(a*r*(s-t)):e-Math.sqrt((1-a)*r*(e-s))}static isPowerOfTwo(t){return t&&0==(t&t-1)}}),W=s,C=(W.PI=3.1415927,W.PI2=2*s.PI,W.radiansToDegrees=180/s.PI,W.radDeg=s.radiansToDegrees,W.degreesToRadians=s.PI/180,W.degRad=s.degreesToRadians,class{apply(t,e,s){return t+(e-t)*this.applyInternal(s)}}),T=class extends C{constructor(t){super(),this.power=2,this.power=t}applyInternal(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2==0?-2:2)+1}},Y=class extends T{constructor(t){super(t)}applyInternal(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1}},a=class{static arrayCopy(s,a,r,i,n){for(let t=a,e=i;t<a+n;t++,e++)r[e]=s[t]}static arrayFill(e,s,a,r){for(let t=s;t<a;t++)e[t]=r}static setArraySize(e,s,a=0){var r=e.length;if(r!=s&&r<(e.length=s))for(let t=r;t<s;t++)e[t]=a;return e}static ensureArrayCapacity(t,e,s=0){return t.length>=e?t:a.setArraySize(t,e,s)}static newArray(e,s){var a=new Array(e);for(let t=0;t<e;t++)a[t]=s;return a}static newFloatArray(t){if(a.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);var e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}static newShortArray(t){if(a.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);var e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}static toFloatArray(t){return a.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return a.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e,s=0){for(var a=0;a<t.length;a++)if(t[a]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}},pe=a,M=(pe.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,class{static logBones(e){for(let t=0;t<e.bones.length;t++){var s=e.bones[t];console.log(s.data.name+", "+s.a+", "+s.b+", "+s.c+", "+s.d+", "+s.worldX+", "+s.worldY)}}}),r=class{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return 0<this.items.length?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(e){for(let t=0;t<e.length;t++)this.free(e[t])}clear(){this.items.length=0}},i=class{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}},F=class{constructor(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}update(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,1<this.frameTime&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}},E=class{constructor(t=32){this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}hasEnoughData(){return this.addedValues>=this.values.length}addValue(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0}getMean(){if(this.hasEnoughData()){if(this.dirty){let e=0;for(let t=0;t<this.values.length;t++)e+=this.values[t];this.mean=e/this.values.length,this.dirty=!1}return this.mean}return 0}},X=class{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}},R=class extends X{constructor(t){super(t),this.id=R.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVertices(t,s,n,o,h,l){n=h+(n>>1)*l;var a=t.bone.skeleton,r=t.deform;let c=this.vertices;var d=this.bones;if(d){let i=0,e=0;for(let t=0;t<s;t+=2){var u=d[i];i+=u+1,e+=u}var m=a.bones;if(0==r.length)for(let s=h,a=3*e;s<n;s+=l){let t=0,e=0;var f=d[i++];for(f+=i;i<f;i++,a+=3){var p=m[d[i]],g=c[a],v=c[a+1],x=c[a+2];t+=(g*p.a+v*p.b+p.worldX)*x,e+=(g*p.c+v*p.d+p.worldY)*x}o[s]=t,o[s+1]=e}else{var w=r;for(let s=h,a=3*e,r=e<<1;s<n;s+=l){let t=0,e=0;var b=d[i++];for(b+=i;i<b;i++,a+=3,r+=2){var y=m[d[i]],A=c[a]+w[r],k=c[a+1]+w[r+1],S=c[a+2];t+=(A*y.a+k*y.b+y.worldX)*S,e+=(A*y.c+k*y.d+y.worldY)*S}o[s]=t,o[s+1]=e}}}else{0<r.length&&(c=r);var a=t.bone,i=a.worldX,I=a.worldY,C=a.a,T=a.b,Y=a.c,M=a.d;for(let t=s,e=h;e<n;t+=2,e+=l){var F=c[t],E=c[t+1];o[e]=F*C+E*T+i,o[e+1]=F*Y+E*M+I}}}copyTo(t){this.bones?(t.bones=new Array(this.bones.length),pe.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=pe.newFloatArray(this.vertices.length),pe.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttachment=this.timelineAttachment}},D=R,n=(D.nextID=0,class{constructor(t){this.id=n.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(t)}copy(){var t=new n(this.regions.length);return pe.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t}apply(t,e){let s=t.sequenceIndex;(s=-1==s?this.setupIndex:s)>=this.regions.length&&(s=this.regions.length-1);t=this.regions[s];e.region!=t&&(e.region=t,e.updateRegion())}getPath(e,t){let s=e;e=(this.start+t).toString();for(let t=this.digits-e.length;0<t;t--)s+="0";return s+=e}static nextID(){return n._nextID++}}),B=n,Ie=(B._nextID=0,(t=>(t[t.hold=0]="hold",t[t.once=1]="once",t[t.loop=2]="loop",t[t.pingpong=3]="pingpong",t[t.onceReverse=4]="onceReverse",t[t.loopReverse=5]="loopReverse",t[t.pingpongReverse=6]="pingpongReverse",t))({})),Zt=[0,1,2,3,4,5,6],ge=class{constructor(t,e,s){if(this.timelines=[],this.timelineIds=new I,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=s}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(var e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(e){for(let t=0;t<e.length;t++)if(this.timelineIds.contains(e[t]))return!0;return!1}apply(s,a,r,t,i,n,o,h){if(!s)throw new Error("skeleton cannot be null.");t&&0!=this.duration&&(r%=this.duration,0<a)&&(a%=this.duration);var l=this.timelines;for(let t=0,e=l.length;t<e;t++)l[t].apply(s,a,r,i,n,o,h)}},_=(t=>(t[t.setup=0]="setup",t[t.first=1]="first",t[t.replace=2]="replace",t[t.add=3]="add",t))(_||{}),L=(t=>(t[t.mixIn=0]="mixIn",t[t.mixOut=1]="mixOut",t))(L||{}),N=0,q=1,U=2,z=3,$=4,j=5,H=6,G=7,J=8,K=9,Q=10,Z=11,tt=12,et=13,st=14,at=15,rt=16,it=17,nt=18,ot=19,V=class{constructor(t,e){this.propertyIds=e,this.frames=pe.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(e,s){var a=e.length;for(let t=1;t<a;t++)if(e[t]>s)return t-1;return a-1}static search(e,s,a){var r=e.length;for(let t=a;t<r;t+=a)if(e[t]>s)return t-a;return r-a}},t=class extends V{constructor(t,e,s){super(t,s),this.curves=pe.newFloatArray(t+18*e),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){var e,t=this.getFrameCount()+18*t;this.curves.length>t&&(e=pe.newFloatArray(t),pe.arrayCopy(this.curves,0,e,0,t),this.curves=e)}setBezier(t,e,s,a,r,i,n,o,h,l,c){var d=this.curves;let u=this.getFrameCount()+18*t;0==s&&(d[e]=2+u);var t=.03*(a-2*i+o),s=.03*(r-2*n+h),m=.006*(3*(i-o)-a+l),f=.006*(3*(n-h)-r+c);let p=2*t+m,g=2*s+f,v=.3*(i-a)+t+.16666667*m,x=.3*(n-r)+s+.16666667*f,w=a+v,b=r+x;for(var y=u+18;u<y;u+=2)d[u]=w,d[u+1]=b,v+=p,x+=g,p+=m,g+=f,w+=v,b+=x}getBezierValue(t,e,s,a){var r=this.curves;if(r[a]>t)return h=this.frames[e],(l=this.frames[e+s])+(t-h)/(r[a]-h)*(r[a+1]-l);var i,n,o=a+18;for(a+=2;a<o;a+=2)if(r[a]>=t)return i=r[a-2],(n=r[a-1])+(t-i)/(r[a]-i)*(r[a+1]-n);e+=this.getFrameEntries();var h=r[o-2],l=r[o-1];return l+(t-h)/(this.frames[e]-h)*(this.frames[e+s]-l)}},o=class extends t{constructor(t,e,s){super(t,e,[s])}getFrameEntries(){return 2}setFrame(t,e,s){this.frames[t<<=1]=e,this.frames[t+1]=s}getCurveValue(e){var s=this.frames;let a=s.length-2;for(let t=2;t<=a;t+=2)if(s[t]>e){a=t-2;break}var t=this.curves[a>>1];switch(t){case 0:var r=s[a],i=s[a+1];return i+(e-r)/(s[a+2]-r)*(s[a+2+1]-i);case 1:return s[a+1]}return this.getBezierValue(e,a,1,t-2)}},ht=class extends t{constructor(t,e,s,a){super(t,e,[s,a])}getFrameEntries(){return 3}setFrame(t,e,s,a){this.frames[t*=3]=e,this.frames[t+1]=s,this.frames[t+2]=a}},ve=class extends o{constructor(t,e,s){super(t,e,N+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,a,r,i,n){var o=t.bones[this.boneIndex];if(o.active)if(s<this.frames[0])switch(i){case 0:return void(o.rotation=o.data.rotation);case 1:o.rotation+=(o.data.rotation-o.rotation)*r}else{let t=this.getCurveValue(s);switch(i){case 0:o.rotation=o.data.rotation+t*r;break;case 1:case 2:t+=o.data.rotation-o.rotation;case 3:o.rotation+=t*r}}}},Ce=class extends ht{constructor(t,e,s){super(t,e,q+"|"+s,U+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,a,r,i,n){var o=t.bones[this.boneIndex];if(o.active){var h=this.frames;if(s<h[0])switch(i){case 0:return o.x=o.data.x,void(o.y=o.data.y);case 1:o.x+=(o.data.x-o.x)*r,o.y+=(o.data.y-o.y)*r}else{let t=0,e=0;var l=V.search(h,s,3),c=this.curves[l/3];switch(c){case 0:var d=h[l],d=(t=h[l+1],e=h[l+2],(s-d)/(h[l+3]-d));t+=(h[l+3+1]-t)*d,e+=(h[l+3+2]-e)*d;break;case 1:t=h[l+1],e=h[l+2];break;default:t=this.getBezierValue(s,l,1,c-2),e=this.getBezierValue(s,l,2,c+18-2)}switch(i){case 0:o.x=o.data.x+t*r,o.y=o.data.y+e*r;break;case 1:case 2:o.x+=(o.data.x+t-o.x)*r,o.y+=(o.data.y+e-o.y)*r;break;case 3:o.x+=t*r,o.y+=e*r}}}}},Te=class extends o{constructor(t,e,s){super(t,e,q+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,a,r,i,n){var o=t.bones[this.boneIndex];if(o.active)if(s<this.frames[0])switch(i){case 0:return void(o.x=o.data.x);case 1:o.x+=(o.data.x-o.x)*r}else{var h=this.getCurveValue(s);switch(i){case 0:o.x=o.data.x+h*r;break;case 1:case 2:o.x+=(o.data.x+h-o.x)*r;break;case 3:o.x+=h*r}}}},Ye=class extends o{constructor(t,e,s){super(t,e,U+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,a,r,i,n){var o=t.bones[this.boneIndex];if(o.active)if(s<this.frames[0])switch(i){case 0:return void(o.y=o.data.y);case 1:o.y+=(o.data.y-o.y)*r}else{var h=this.getCurveValue(s);switch(i){case 0:o.y=o.data.y+h*r;break;case 1:case 2:o.y+=(o.data.y+h-o.y)*r;break;case 3:o.y+=h*r}}}},Me=class extends ht{constructor(t,e,s){super(t,e,z+"|"+s,$+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,r,s,i,n,o){var h=t.bones[this.boneIndex];if(h.active){var l=this.frames;if(r<l[0])switch(n){case 0:return h.scaleX=h.data.scaleX,void(h.scaleY=h.data.scaleY);case 1:h.scaleX+=(h.data.scaleX-h.scaleX)*i,h.scaleY+=(h.data.scaleY-h.scaleY)*i}else{let s,a;var c=V.search(l,r,3),d=this.curves[c/3];switch(d){case 0:var u=l[c],u=(s=l[c+1],a=l[c+2],(r-u)/(l[c+3]-u));s+=(l[c+3+1]-s)*u,a+=(l[c+3+2]-a)*u;break;case 1:s=l[c+1],a=l[c+2];break;default:s=this.getBezierValue(r,c,1,d-2),a=this.getBezierValue(r,c,2,d+18-2)}if(s*=h.data.scaleX,a*=h.data.scaleY,1==i)3==n?(h.scaleX+=s-h.data.scaleX,h.scaleY+=a-h.data.scaleY):(h.scaleX=s,h.scaleY=a);else{let t=0,e=0;if(1==o)switch(n){case 0:t=h.data.scaleX,e=h.data.scaleY,h.scaleX=t+(Math.abs(s)*W.signum(t)-t)*i,h.scaleY=e+(Math.abs(a)*W.signum(e)-e)*i;break;case 1:case 2:t=h.scaleX,e=h.scaleY,h.scaleX=t+(Math.abs(s)*W.signum(t)-t)*i,h.scaleY=e+(Math.abs(a)*W.signum(e)-e)*i;break;case 3:h.scaleX+=(s-h.data.scaleX)*i,h.scaleY+=(a-h.data.scaleY)*i}else switch(n){case 0:t=Math.abs(h.data.scaleX)*W.signum(s),e=Math.abs(h.data.scaleY)*W.signum(a),h.scaleX=t+(s-t)*i,h.scaleY=e+(a-e)*i;break;case 1:case 2:t=Math.abs(h.scaleX)*W.signum(s),e=Math.abs(h.scaleY)*W.signum(a),h.scaleX=t+(s-t)*i,h.scaleY=e+(a-e)*i;break;case 3:h.scaleX+=(s-h.data.scaleX)*i,h.scaleY+=(a-h.data.scaleY)*i}}}}}},Fe=class extends o{constructor(t,e,s){super(t,e,z+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,a,r,i,n){var o=t.bones[this.boneIndex];if(o.active)if(s<this.frames[0])switch(i){case 0:return void(o.scaleX=o.data.scaleX);case 1:o.scaleX+=(o.data.scaleX-o.scaleX)*r}else{var h=this.getCurveValue(s)*o.data.scaleX;if(1==r)3==i?o.scaleX+=h-o.data.scaleX:o.scaleX=h;else{let t=0;if(1==n)switch(i){case 0:t=o.data.scaleX,o.scaleX=t+(Math.abs(h)*W.signum(t)-t)*r;break;case 1:case 2:t=o.scaleX,o.scaleX=t+(Math.abs(h)*W.signum(t)-t)*r;break;case 3:o.scaleX+=(h-o.data.scaleX)*r}else switch(i){case 0:t=Math.abs(o.data.scaleX)*W.signum(h),o.scaleX=t+(h-t)*r;break;case 1:case 2:t=Math.abs(o.scaleX)*W.signum(h),o.scaleX=t+(h-t)*r;break;case 3:o.scaleX+=(h-o.data.scaleX)*r}}}}},Ee=class extends o{constructor(t,e,s){super(t,e,$+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,a,r,i,n){var o=t.bones[this.boneIndex];if(o.active)if(s<this.frames[0])switch(i){case 0:return void(o.scaleY=o.data.scaleY);case 1:o.scaleY+=(o.data.scaleY-o.scaleY)*r}else{var h=this.getCurveValue(s)*o.data.scaleY;if(1==r)3==i?o.scaleY+=h-o.data.scaleY:o.scaleY=h;else{let t=0;if(1==n)switch(i){case 0:t=o.data.scaleY,o.scaleY=t+(Math.abs(h)*W.signum(t)-t)*r;break;case 1:case 2:t=o.scaleY,o.scaleY=t+(Math.abs(h)*W.signum(t)-t)*r;break;case 3:o.scaleY+=(h-o.data.scaleY)*r}else switch(i){case 0:t=Math.abs(o.data.scaleY)*W.signum(h),o.scaleY=t+(h-t)*r;break;case 1:case 2:t=Math.abs(o.scaleY)*W.signum(h),o.scaleY=t+(h-t)*r;break;case 3:o.scaleY+=(h-o.data.scaleY)*r}}}}},Xe=class extends ht{constructor(t,e,s){super(t,e,j+"|"+s,H+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,a,r,i,n){var o=t.bones[this.boneIndex];if(o.active){var h=this.frames;if(s<h[0])switch(i){case 0:return o.shearX=o.data.shearX,void(o.shearY=o.data.shearY);case 1:o.shearX+=(o.data.shearX-o.shearX)*r,o.shearY+=(o.data.shearY-o.shearY)*r}else{let t=0,e=0;var l=V.search(h,s,3),c=this.curves[l/3];switch(c){case 0:var d=h[l],d=(t=h[l+1],e=h[l+2],(s-d)/(h[l+3]-d));t+=(h[l+3+1]-t)*d,e+=(h[l+3+2]-e)*d;break;case 1:t=h[l+1],e=h[l+2];break;default:t=this.getBezierValue(s,l,1,c-2),e=this.getBezierValue(s,l,2,c+18-2)}switch(i){case 0:o.shearX=o.data.shearX+t*r,o.shearY=o.data.shearY+e*r;break;case 1:case 2:o.shearX+=(o.data.shearX+t-o.shearX)*r,o.shearY+=(o.data.shearY+e-o.shearY)*r;break;case 3:o.shearX+=t*r,o.shearY+=e*r}}}}},Re=class extends o{constructor(t,e,s){super(t,e,j+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,a,r,i,n){var o=t.bones[this.boneIndex];if(o.active)if(s<this.frames[0])switch(i){case 0:return void(o.shearX=o.data.shearX);case 1:o.shearX+=(o.data.shearX-o.shearX)*r}else{var h=this.getCurveValue(s);switch(i){case 0:o.shearX=o.data.shearX+h*r;break;case 1:case 2:o.shearX+=(o.data.shearX+h-o.shearX)*r;break;case 3:o.shearX+=h*r}}}},Be=class extends o{constructor(t,e,s){super(t,e,H+"|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,a,r,i,n){var o=t.bones[this.boneIndex];if(o.active)if(s<this.frames[0])switch(i){case 0:return void(o.shearY=o.data.shearY);case 1:o.shearY+=(o.data.shearY-o.shearY)*r}else{var h=this.getCurveValue(s);switch(i){case 0:o.shearY=o.data.shearY+h*r;break;case 1:case 2:o.shearY+=(o.data.shearY+h-o.shearY)*r;break;case 3:o.shearY+=h*r}}}},_e=class extends t{constructor(t,e,s){super(t,e,[G+"|"+s,J+"|"+s]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 5}setFrame(t,e,s,a,r,i){this.frames[t*=5]=e,this.frames[t+1]=s,this.frames[t+2]=a,this.frames[t+3]=r,this.frames[t+4]=i}apply(r,t,i,e,n,o,s){r=r.slots[this.slotIndex];if(r.bone.active){var h=this.frames,l=r.color;if(i<h[0]){var a=r.data.color;switch(o){case 0:return void l.setFromColor(a);case 1:l.add((a.r-l.r)*n,(a.g-l.g)*n,(a.b-l.b)*n,(a.a-l.a)*n)}}else{let t=0,e=0,s=0,a=0;var c=V.search(h,i,5),d=this.curves[c/5];switch(d){case 0:var u=h[c],u=(t=h[c+1],e=h[c+2],s=h[c+3],a=h[c+4],(i-u)/(h[c+5]-u));t+=(h[c+5+1]-t)*u,e+=(h[c+5+2]-e)*u,s+=(h[c+5+3]-s)*u,a+=(h[c+5+4]-a)*u;break;case 1:t=h[c+1],e=h[c+2],s=h[c+3],a=h[c+4];break;default:t=this.getBezierValue(i,c,1,d-2),e=this.getBezierValue(i,c,2,d+18-2),s=this.getBezierValue(i,c,3,d+36-2),a=this.getBezierValue(i,c,4,d+54-2)}1==n?l.set(t,e,s,a):(0==o&&l.setFromColor(r.data.color),l.add((t-l.r)*n,(e-l.g)*n,(s-l.b)*n,(a-l.a)*n))}}}},Pe=class extends t{constructor(t,e,s){super(t,e,[G+"|"+s]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,a,r){this.frames[t<<=2]=e,this.frames[t+1]=s,this.frames[t+2]=a,this.frames[t+3]=r}apply(a,t,r,e,i,n,s){a=a.slots[this.slotIndex];if(a.bone.active){var o=this.frames,h=a.color;if(r<o[0]){var l=a.data.color;switch(n){case 0:return h.r=l.r,h.g=l.g,void(h.b=l.b);case 1:h.r+=(l.r-h.r)*i,h.g+=(l.g-h.g)*i,h.b+=(l.b-h.b)*i}}else{let t=0,e=0,s=0;var c=V.search(o,r,4),d=this.curves[c>>2];switch(d){case 0:var u=o[c],u=(t=o[c+1],e=o[c+2],s=o[c+3],(r-u)/(o[c+4]-u));t+=(o[c+4+1]-t)*u,e+=(o[c+4+2]-e)*u,s+=(o[c+4+3]-s)*u;break;case 1:t=o[c+1],e=o[c+2],s=o[c+3];break;default:t=this.getBezierValue(r,c,1,d-2),e=this.getBezierValue(r,c,2,d+18-2),s=this.getBezierValue(r,c,3,d+36-2)}1==i?(h.r=t,h.g=e,h.b=s):(0==n&&(n=a.data.color,h.r=n.r,h.g=n.g,h.b=n.b),h.r+=(t-h.r)*i,h.g+=(e-h.g)*i,h.b+=(s-h.b)*i)}}}},De=class extends o{constructor(t,e,s){super(t,e,J+"|"+s),this.slotIndex=0,this.slotIndex=s}apply(t,e,s,a,r,i,n){t=t.slots[this.slotIndex];if(t.bone.active){var o=t.color;if(s<this.frames[0]){var h=t.data.color;switch(i){case 0:return void(o.a=h.a);case 1:o.a+=(h.a-o.a)*r}}else{s=this.getCurveValue(s);1==r?o.a=s:(0==i&&(o.a=t.data.color.a),o.a+=(s-o.a)*r)}}}},Ve=class extends t{constructor(t,e,s){super(t,e,[G+"|"+s,J+"|"+s,K+"|"+s]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 8}setFrame(t,e,s,a,r,i,n,o,h){this.frames[t<<=3]=e,this.frames[t+1]=s,this.frames[t+2]=a,this.frames[t+3]=r,this.frames[t+4]=i,this.frames[t+5]=n,this.frames[t+6]=o,this.frames[t+7]=h}apply(o,t,h,e,l,c,s){o=o.slots[this.slotIndex];if(o.bone.active){var d=this.frames,u=o.color,m=o.darkColor;if(h<d[0]){var a=o.data.color,r=o.data.darkColor;switch(c){case 0:return u.setFromColor(a),m.r=r.r,m.g=r.g,void(m.b=r.b);case 1:u.add((a.r-u.r)*l,(a.g-u.g)*l,(a.b-u.b)*l,(a.a-u.a)*l),m.r+=(r.r-m.r)*l,m.g+=(r.g-m.g)*l,m.b+=(r.b-m.b)*l}}else{let t=0,e=0,s=0,a=0,r=0,i=0,n=0;var f=V.search(d,h,8),p=this.curves[f>>3];switch(p){case 0:var g=d[f],g=(t=d[f+1],e=d[f+2],s=d[f+3],a=d[f+4],r=d[f+5],i=d[f+6],n=d[f+7],(h-g)/(d[f+8]-g));t+=(d[f+8+1]-t)*g,e+=(d[f+8+2]-e)*g,s+=(d[f+8+3]-s)*g,a+=(d[f+8+4]-a)*g,r+=(d[f+8+5]-r)*g,i+=(d[f+8+6]-i)*g,n+=(d[f+8+7]-n)*g;break;case 1:t=d[f+1],e=d[f+2],s=d[f+3],a=d[f+4],r=d[f+5],i=d[f+6],n=d[f+7];break;default:t=this.getBezierValue(h,f,1,p-2),e=this.getBezierValue(h,f,2,p+18-2),s=this.getBezierValue(h,f,3,p+36-2),a=this.getBezierValue(h,f,4,p+54-2),r=this.getBezierValue(h,f,5,p+72-2),i=this.getBezierValue(h,f,6,p+90-2),n=this.getBezierValue(h,f,7,p+108-2)}1==l?(u.set(t,e,s,a),m.r=r,m.g=i,m.b=n):(0==c&&(u.setFromColor(o.data.color),c=o.data.darkColor,m.r=c.r,m.g=c.g,m.b=c.b),u.add((t-u.r)*l,(e-u.g)*l,(s-u.b)*l,(a-u.a)*l),m.r+=(r-m.r)*l,m.g+=(i-m.g)*l,m.b+=(n-m.b)*l)}}}},Le=class extends t{constructor(t,e,s){super(t,e,[G+"|"+s,K+"|"+s]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,a,r,i,n,o){this.frames[t*=7]=e,this.frames[t+1]=s,this.frames[t+2]=a,this.frames[t+3]=r,this.frames[t+4]=i,this.frames[t+5]=n,this.frames[t+6]=o}apply(n,t,o,e,h,l,s){n=n.slots[this.slotIndex];if(n.bone.active){var c=this.frames,d=n.color,u=n.darkColor;if(o<c[0]){var a=n.data.color,r=n.data.darkColor;switch(l){case 0:return d.r=a.r,d.g=a.g,d.b=a.b,u.r=r.r,u.g=r.g,void(u.b=r.b);case 1:d.r+=(a.r-d.r)*h,d.g+=(a.g-d.g)*h,d.b+=(a.b-d.b)*h,u.r+=(r.r-u.r)*h,u.g+=(r.g-u.g)*h,u.b+=(r.b-u.b)*h}}else{let t=0,e=0,s=0,a=0,r=0,i=0;var m=V.search(c,o,7),f=this.curves[m/7];switch(f){case 0:var p=c[m],p=(t=c[m+1],e=c[m+2],s=c[m+3],a=c[m+4],r=c[m+5],i=c[m+6],(o-p)/(c[m+7]-p));t+=(c[m+7+1]-t)*p,e+=(c[m+7+2]-e)*p,s+=(c[m+7+3]-s)*p,a+=(c[m+7+4]-a)*p,r+=(c[m+7+5]-r)*p,i+=(c[m+7+6]-i)*p;break;case 1:t=c[m+1],e=c[m+2],s=c[m+3],a=c[m+4],r=c[m+5],i=c[m+6];break;default:t=this.getBezierValue(o,m,1,f-2),e=this.getBezierValue(o,m,2,f+18-2),s=this.getBezierValue(o,m,3,f+36-2),a=this.getBezierValue(o,m,4,f+54-2),r=this.getBezierValue(o,m,5,f+72-2),i=this.getBezierValue(o,m,6,f+90-2)}1==h?(d.r=t,d.g=e,d.b=s,u.r=a,u.g=r,u.b=i):(0==l&&(l=n.data.color,n=n.data.darkColor,d.r=l.r,d.g=l.g,d.b=l.b,u.r=n.r,u.g=n.g,u.b=n.b),d.r+=(t-d.r)*h,d.g+=(e-d.g)*h,d.b+=(s-d.b)*h,u.r+=(a-u.r)*h,u.g+=(r-u.g)*h,u.b+=(i-u.b)*h)}}}},xe=class extends V{constructor(t,e){super(t,[Q+"|"+e]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.attachmentNames[t]=s}apply(t,e,s,a,r,i,n){var o=t.slots[this.slotIndex];o.bone.active&&(1==n?0==i&&this.setAttachment(t,o,o.data.attachmentName):s<this.frames[0]?0!=i&&1!=i||this.setAttachment(t,o,o.data.attachmentName):this.setAttachment(t,o,this.attachmentNames[V.search1(this.frames,s)]))}setAttachment(t,e,s){e.setAttachment(s?t.getAttachment(this.slotIndex,s):null)}},Ne=class extends t{constructor(t,e,s,a){super(t,e,[Z+"|"+s+"|"+a.id]),this.slotIndex=0,this.slotIndex=s,this.attachment=a,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.vertices[t]=s}setBezier(t,e,s,a,r,i,n,o,h,l,c){var d=this.curves;let u=this.getFrameCount()+18*t;0==s&&(d[e]=2+u);var t=.03*(a-2*i+o),s=.03*h-.06*n,m=.006*(3*(i-o)-a+l),f=.018*(n-h+.33333333);let p=2*t+m,g=2*s+f,v=.3*(i-a)+t+.16666667*m,x=.3*n+s+.16666667*f,w=a+v,b=x;for(var y=u+18;u<y;u+=2)d[u]=w,d[u+1]=b,v+=p,x+=g,p+=m,g+=f,w+=v,b+=x}getCurvePercent(t,e){var s=this.curves;let a=s[e];switch(a){case 0:var r=this.frames[e];return(t-r)/(this.frames[e+this.getFrameEntries()]-r);case 1:return 0}if(s[a-=2]>t)return h=this.frames[e],s[a+1]*(t-h)/(s[a]-h);var i,n,o=a+18;for(a+=2;a<o;a+=2)if(s[a]>=t)return i=s[a-2],(n=s[a-1])+(t-i)/(s[a]-i)*(s[a+1]-n);var h=s[o-2],l=s[o-1];return l+(1-l)*(t-h)/(this.frames[e+this.getFrameEntries()]-h)}apply(t,e,s,_,a,r,P){t=t.slots[this.slotIndex];if(t.bone.active){var i=t.getAttachment();if(i&&i instanceof D&&i.timelineAttachment==this.attachment){var n=t.deform,t=(0==n.length&&(r=0),this.vertices),o=t[0].length,h=this.frames;if(s<h[0])switch(r){case 0:return void(n.length=0);case 1:if(1==a)return void(n.length=0);n.length=o;var l=i;if(l.bones){a=1-a;for(d=0;d<o;d++)n[d]*=a}else for(var c=l.vertices,d=0;d<o;d++)n[d]+=(c[d]-n[d])*a}else if(n.length=o,s>=h[h.length-1]){var u=t[h.length-1];if(1==a)if(3==r){var m=i;if(m.bones)for(let t=0;t<o;t++)n[t]+=u[t];else{var f=m.vertices;for(let t=0;t<o;t++)n[t]+=u[t]-f[t]}}else pe.arrayCopy(u,0,n,0,o);else switch(r){case 0:var p=i;if(p.bones)for(let t=0;t<o;t++)n[t]=u[t]*a;else{var g=p.vertices;for(let t=0;t<o;t++){var v=g[t];n[t]=v+(u[t]-v)*a}}break;case 1:case 2:for(let t=0;t<o;t++)n[t]+=(u[t]-n[t])*a;break;case 3:p=i;if(p.bones)for(let t=0;t<o;t++)n[t]+=u[t]*a;else{var x=p.vertices;for(let t=0;t<o;t++)n[t]+=(u[t]-x[t])*a}}}else{var m=V.search1(h,s),w=this.getCurvePercent(s,m),b=t[m],y=t[m+1];if(1==a)if(3==r){h=i;if(h.bones)for(let t=0;t<o;t++){var A=b[t];n[t]+=A+(y[t]-A)*w}else{var k=h.vertices;for(let t=0;t<o;t++){var S=b[t];n[t]+=S+(y[t]-S)*w-k[t]}}}else for(let t=0;t<o;t++){var I=b[t];n[t]=I+(y[t]-I)*w}else switch(r){case 0:var C=i;if(C.bones)for(let t=0;t<o;t++){var T=b[t];n[t]=(T+(y[t]-T)*w)*a}else{var Y=C.vertices;for(let t=0;t<o;t++){var M=b[t],F=Y[t];n[t]=F+(M+(y[t]-M)*w-F)*a}}break;case 1:case 2:for(let t=0;t<o;t++){var E=b[t];n[t]+=(E+(y[t]-E)*w-n[t])*a}break;case 3:C=i;if(C.bones)for(let t=0;t<o;t++){var X=b[t];n[t]+=(X+(y[t]-X)*w)*a}else{var R=C.vertices;for(let t=0;t<o;t++){var B=b[t];n[t]+=(B+(y[t]-B)*w-R[t])*a}}}}}}}},lt=class extends V{constructor(t){super(t,lt.propertyIds),this.events=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,s,a,r,i,n){if(a){var o=this.frames,h=this.frames.length;if(s<e)this.apply(t,e,Number.MAX_VALUE,a,r,i,n),e=-1;else if(e>=o[h-1])return;if(!(s<o[0])){let t=0;if(e<o[0])t=0;else for(var l=o[t=V.search1(o,e)+1];0<t&&o[t-1]==l;)t--;for(;t<h&&s>=o[t];t++)a.push(this.events[t])}}}},we=lt,ct=(we.propertyIds=[""+tt],class extends V{constructor(t){super(t,ct.propertyIds),this.drawOrders=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.drawOrders[t]=s}apply(t,e,s,a,r,i,n){if(1==n)0==i&&pe.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);else if(s<this.frames[0])0!=i&&1!=i||pe.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);else{var n=V.search1(this.frames,s),o=this.drawOrders[n];if(o){var h=t.drawOrder,l=t.slots;for(let t=0,e=o.length;t<e;t++)h[t]=l[o[t]]}else pe.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length)}}}),be=ct,qe=(be.propertyIds=[""+et],class extends t{constructor(t,e,s){super(t,e,[st+"|"+s]),this.ikConstraintIndex=0,this.ikConstraintIndex=s}getFrameEntries(){return 6}setFrame(t,e,s,a,r,i,n){this.frames[t*=6]=e,this.frames[t+1]=s,this.frames[t+2]=a,this.frames[t+3]=r,this.frames[t+4]=i?1:0,this.frames[t+5]=n?1:0}apply(t,e,s,a,r,i,n){var o=t.ikConstraints[this.ikConstraintIndex];if(o.active){var h=this.frames;if(s<h[0])switch(i){case 0:return o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,void(o.stretch=o.data.stretch);case 1:o.mix+=(o.data.mix-o.mix)*r,o.softness+=(o.data.softness-o.softness)*r,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}else{let t=0,e=0;var l=V.search(h,s,6),c=this.curves[l/6];switch(c){case 0:var d=h[l],d=(t=h[l+1],e=h[l+2],(s-d)/(h[l+6]-d));t+=(h[l+6+1]-t)*d,e+=(h[l+6+2]-e)*d;break;case 1:t=h[l+1],e=h[l+2];break;default:t=this.getBezierValue(s,l,1,c-2),e=this.getBezierValue(s,l,2,c+18-2)}0==i?(o.mix=o.data.mix+(t-o.data.mix)*r,o.softness=o.data.softness+(e-o.data.softness)*r,1==n?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=h[l+3],o.compress=0!=h[l+4],o.stretch=0!=h[l+5])):(o.mix+=(t-o.mix)*r,o.softness+=(e-o.softness)*r,0==n&&(o.bendDirection=h[l+3],o.compress=0!=h[l+4],o.stretch=0!=h[l+5]))}}}}),Oe=class extends t{constructor(t,e,s){super(t,e,[at+"|"+s]),this.transformConstraintIndex=0,this.transformConstraintIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,a,r,i,n,o){var h=this.frames;h[t*=7]=e,h[t+1]=s,h[t+2]=a,h[t+3]=r,h[t+4]=i,h[t+5]=n,h[t+6]=o}apply(n,t,o,e,h,l,s){var c=n.transformConstraints[this.transformConstraintIndex];if(c.active){var d=this.frames;if(o<d[0]){var a=c.data;switch(l){case 0:return c.mixRotate=a.mixRotate,c.mixX=a.mixX,c.mixY=a.mixY,c.mixScaleX=a.mixScaleX,c.mixScaleY=a.mixScaleY,void(c.mixShearY=a.mixShearY);case 1:c.mixRotate+=(a.mixRotate-c.mixRotate)*h,c.mixX+=(a.mixX-c.mixX)*h,c.mixY+=(a.mixY-c.mixY)*h,c.mixScaleX+=(a.mixScaleX-c.mixScaleX)*h,c.mixScaleY+=(a.mixScaleY-c.mixScaleY)*h,c.mixShearY+=(a.mixShearY-c.mixShearY)*h}}else{let t,e,s,a,r,i;var u=V.search(d,o,7),m=this.curves[u/7];switch(m){case 0:var f=d[u],f=(t=d[u+1],e=d[u+2],s=d[u+3],a=d[u+4],r=d[u+5],i=d[u+6],(o-f)/(d[u+7]-f));t+=(d[u+7+1]-t)*f,e+=(d[u+7+2]-e)*f,s+=(d[u+7+3]-s)*f,a+=(d[u+7+4]-a)*f,r+=(d[u+7+5]-r)*f,i+=(d[u+7+6]-i)*f;break;case 1:t=d[u+1],e=d[u+2],s=d[u+3],a=d[u+4],r=d[u+5],i=d[u+6];break;default:t=this.getBezierValue(o,u,1,m-2),e=this.getBezierValue(o,u,2,m+18-2),s=this.getBezierValue(o,u,3,m+36-2),a=this.getBezierValue(o,u,4,m+54-2),r=this.getBezierValue(o,u,5,m+72-2),i=this.getBezierValue(o,u,6,m+90-2)}0==l?(n=c.data,c.mixRotate=n.mixRotate+(t-n.mixRotate)*h,c.mixX=n.mixX+(e-n.mixX)*h,c.mixY=n.mixY+(s-n.mixY)*h,c.mixScaleX=n.mixScaleX+(a-n.mixScaleX)*h,c.mixScaleY=n.mixScaleY+(r-n.mixScaleY)*h,c.mixShearY=n.mixShearY+(i-n.mixShearY)*h):(c.mixRotate+=(t-c.mixRotate)*h,c.mixX+=(e-c.mixX)*h,c.mixY+=(s-c.mixY)*h,c.mixScaleX+=(a-c.mixScaleX)*h,c.mixScaleY+=(r-c.mixScaleY)*h,c.mixShearY+=(i-c.mixShearY)*h)}}}},Ue=class extends o{constructor(t,e,s){super(t,e,rt+"|"+s),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(t,e,s,a,r,i,n){var o=t.pathConstraints[this.pathConstraintIndex];if(o.active)if(s<this.frames[0])switch(i){case 0:return void(o.position=o.data.position);case 1:o.position+=(o.data.position-o.position)*r}else{t=this.getCurveValue(s);0==i?o.position=o.data.position+(t-o.data.position)*r:o.position+=(t-o.position)*r}}},We=class extends o{constructor(t,e,s){super(t,e,it+"|"+s),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(t,e,s,a,r,i,n){var o=t.pathConstraints[this.pathConstraintIndex];if(o.active)if(s<this.frames[0])switch(i){case 0:return void(o.spacing=o.data.spacing);case 1:o.spacing+=(o.data.spacing-o.spacing)*r}else{t=this.getCurveValue(s);0==i?o.spacing=o.data.spacing+(t-o.data.spacing)*r:o.spacing+=(t-o.spacing)*r}}},ze=class extends t{constructor(t,e,s){super(t,e,[nt+"|"+s]),this.pathConstraintIndex=0,this.pathConstraintIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,a,r){var i=this.frames;i[t<<=2]=e,i[t+1]=s,i[t+2]=a,i[t+3]=r}apply(a,t,r,e,i,n,s){var o=a.pathConstraints[this.pathConstraintIndex];if(o.active){var h=this.frames;if(r<h[0])switch(n){case 0:return o.mixRotate=o.data.mixRotate,o.mixX=o.data.mixX,void(o.mixY=o.data.mixY);case 1:o.mixRotate+=(o.data.mixRotate-o.mixRotate)*i,o.mixX+=(o.data.mixX-o.mixX)*i,o.mixY+=(o.data.mixY-o.mixY)*i}else{let t,e,s;var l=V.search(h,r,4),c=this.curves[l>>2];switch(c){case 0:var d=h[l],d=(t=h[l+1],e=h[l+2],s=h[l+3],(r-d)/(h[l+4]-d));t+=(h[l+4+1]-t)*d,e+=(h[l+4+2]-e)*d,s+=(h[l+4+3]-s)*d;break;case 1:t=h[l+1],e=h[l+2],s=h[l+3];break;default:t=this.getBezierValue(r,l,1,c-2),e=this.getBezierValue(r,l,2,c+18-2),s=this.getBezierValue(r,l,3,c+36-2)}0==n?(a=o.data,o.mixRotate=a.mixRotate+(t-a.mixRotate)*i,o.mixX=a.mixX+(e-a.mixX)*i,o.mixY=a.mixY+(s-a.mixY)*i):(o.mixRotate+=(t-o.mixRotate)*i,o.mixX+=(e-o.mixX)*i,o.mixY+=(s-o.mixY)*i)}}}},d=class extends V{constructor(t,e,s){super(t,[ot+"|"+e+"|"+s.sequence.id]),this.slotIndex=e,this.attachment=s}getFrameEntries(){return d.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(t,e,s,a,r){var i=this.frames;i[t*=d.ENTRIES]=e,i[t+d.MODE]=s|a<<4,i[t+d.DELAY]=r}apply(s,t,a,e,r,i,n){s=s.slots[this.slotIndex];if(s.bone.active){var o=s.attachment,h=this.attachment;if(o==h||o instanceof D&&o.timelineAttachment==h){o=this.frames;if(a<o[0])0!=i&&1!=i||(s.sequenceIndex=-1);else{var h=V.search(o,a,d.ENTRIES),i=o[h],l=o[h+d.MODE],o=o[h+d.DELAY];if(this.attachment.sequence){let t=l>>4,e=this.attachment.sequence.regions.length;h=Zt[15&l];if(0!=h)switch(t+=(a-i)/o+1e-5|0,h){case 1:t=Math.min(e-1,t);break;case 2:t%=e;break;case 3:var c=(e<<1)-2;(t=0==c?0:t%c)>=e&&(t=c-t);break;case 4:t=Math.max(e-1-t,0);break;case 5:t=e-1-t%e;break;case 6:c=(e<<1)-2;(t=0==c?0:(t+e-1)%c)>=e&&(t=c-t)}s.sequenceIndex=t}}}}}},ye=d,dt=(ye.ENTRIES=3,ye.MODE=1,ye.DELAY=2,class{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new ft(this),this.propertyIDs=new I,this.animationsChanged=!1,this.trackEntryPool=new r(()=>new mt),this.data=t}static emptyAnimation(){return dt._emptyAnimation}update(a){a*=this.timeScale;var r=this.tracks;for(let s=0,t=r.length;s<t;s++){var i=r[s];if(i){i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast;let t=a*i.timeScale;if(0<i.delay){if(i.delay-=t,0<i.delay)continue;t=-i.delay,i.delay=0}let e=i.next;if(e){var n=i.trackLast-e.delay;if(0<=n){for(e.delay=0,e.trackTime+=0==i.timeScale?0:(n/i.timeScale+a)*e.timeScale,i.trackTime+=t,this.setCurrent(s,e,!0);e.mixingFrom;)e.mixTime+=a,e=e.mixingFrom;continue}}else if(i.trackLast>=i.trackEnd&&!i.mixingFrom){r[s]=null,this.queue.end(i),this.clearNext(i);continue}if(i.mixingFrom&&this.updateMixingFrom(i,a)){let t=i.mixingFrom;for(i.mixingFrom=null,t&&(t.mixingTo=null);t;)this.queue.end(t),t=t.mixingFrom}i.trackTime+=t}}this.queue.drain()}updateMixingFrom(t,e){var s,a=t.mixingFrom;return!a||(s=this.updateMixingFrom(a,e),a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast,0<t.mixTime&&t.mixTime>=t.mixDuration?(0!=a.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=a.mixingFrom,a.mixingFrom&&(a.mixingFrom.mixingTo=t),t.interruptAlpha=a.interruptAlpha,this.queue.end(a)),s):(a.trackTime+=e*a.timeScale,t.mixTime+=e,!1))}apply(n){if(!n)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();var o=this.events,e=this.tracks;let h=!1;for(let i=0,t=e.length;i<t;i++){var l=e[i];if(l&&!(0<l.delay)){h=!0;var c=0==i?1:l.mixBlend;let e=l.alpha,s=(l.mixingFrom?e*=this.applyMixingFrom(l,n,c):l.trackTime>=l.trackEnd&&!l.next&&(e=0),l.animationLast),t=l.getAnimationTime(),a=t,r=o;l.reverse&&(a=l.animation.duration-a,r=null);var d=l.animation.timelines,u=d.length;if(0==i&&1==e||3==c)for(let t=0;t<u;t++){pe.webkit602BugfixHelper(e,c);var m=d[t];m instanceof xe?this.applyAttachmentTimeline(m,n,a,c,!0):m.apply(n,s,a,r,e,c,0)}else{var f=l.timelineMode,p=l.shortestRotation,g=!p&&l.timelinesRotation.length!=u<<1;g&&(l.timelinesRotation.length=u<<1);for(let t=0;t<u;t++){var v=d[t],x=f[t]==gt?c:0;!p&&v instanceof ve?this.applyRotateTimeline(v,n,a,e,x,l.timelinesRotation,t<<1,g):v instanceof xe?this.applyAttachmentTimeline(v,n,a,c,!0):(pe.webkit602BugfixHelper(e,c),v.apply(n,s,a,r,e,x,0))}}this.queueEvents(l,t),o.length=0,l.nextAnimationLast=t,l.nextTrackLast=l.trackTime}}for(var t=this.unkeyedState+yt,s=n.slots,a=0,r=n.slots.length;a<r;a++){var i,w=s[a];w.attachmentState==t&&(i=w.data.attachmentName,w.setAttachment(i?n.getAttachment(w.data.index,i):null))}return this.unkeyedState+=2,this.queue.drain(),h}applyMixingFrom(t,r,i){var n=t.mixingFrom;n.mixingFrom&&this.applyMixingFrom(n,r,i);let e=0;0==t.mixDuration?(e=1)==i&&(i=0):(1<(e=t.mixTime/t.mixDuration)&&(e=1),1!=i&&(i=n.mixBlend));var o=e<n.attachmentThreshold,h=e<n.drawOrderThreshold,l=n.animation.timelines,s=l.length,c=n.alpha*t.interruptAlpha,d=c*(1-e);let u=n.animationLast,a=n.getAnimationTime(),m=a,f=null;if(n.reverse?m=n.animation.duration-m:e<n.eventThreshold&&(f=this.events),3==i)for(let t=0;t<s;t++)l[t].apply(r,u,m,f,d,i,1);else{var p=n.timelineMode,g=n.timelineHoldMix,v=n.shortestRotation,x=!v&&n.timelinesRotation.length!=s<<1;x&&(n.timelinesRotation.length=s<<1);for(let a=n.totalAlpha=0;a<s;a++){var w=l[a];let t=1,e,s=0;switch(p[a]){case gt:if(!h&&w instanceof be)continue;e=i,s=d;break;case vt:e=0,s=d;break;case xt:e=i,s=c;break;case wt:e=0,s=c;break;default:e=0;var b=g[a];s=c*Math.max(0,1-b.mixTime/b.mixDuration)}n.totalAlpha+=s,!v&&w instanceof ve?this.applyRotateTimeline(w,r,m,s,e,n.timelinesRotation,a<<1,x):w instanceof xe?this.applyAttachmentTimeline(w,r,m,e,o):(pe.webkit602BugfixHelper(s,i),h&&w instanceof be&&0==e&&(t=0),w.apply(r,u,m,f,s,e,t))}}return 0<t.mixDuration&&this.queueEvents(n,a),this.events.length=0,n.nextAnimationLast=a,n.nextTrackLast=n.trackTime,e}applyAttachmentTimeline(t,e,s,a,r){var i=e.slots[t.slotIndex];i.bone.active&&(s<t.frames[0]?0!=a&&1!=a||this.setAttachment(e,i,i.data.attachmentName,r):this.setAttachment(e,i,t.attachmentNames[V.search1(t.frames,s)],r),i.attachmentState<=this.unkeyedState)&&(i.attachmentState=this.unkeyedState+yt)}setAttachment(t,e,s,a){e.setAttachment(s?t.getAttachment(e.data.index,s):null),a&&(e.attachmentState=this.unkeyedState+At)}applyRotateTimeline(s,t,a,n,o,h,l,c){if(c&&(h[l]=0),1==n)s.apply(t,0,a,null,1,o,0);else{var d=t.bones[s.boneIndex];if(d.active){let t=0,e=0;if(a<s.frames[0])switch(o){case 0:d.rotation=d.data.rotation;default:return;case 1:t=d.rotation,e=d.data.rotation}else t=(0==o?d.data:d).rotation,e=d.data.rotation+s.getCurveValue(a);let r=0,i=e-t;if(0==(i-=360*(16384-(16384.499999999996-i/360|0))))r=h[l];else{let t=0,e=0,s=(e=c?(t=0,i):(t=h[l],h[l+1]),0<i),a=0<=t;W.signum(e)!=W.signum(i)&&Math.abs(e)<=90&&(180<Math.abs(t)&&(t+=360*W.signum(t)),a=s),r=i+t-t%360,a!=s&&(r+=360*W.signum(t)),h[l]=r}h[l+1]=i,d.rotation=t+r*n}}}queueEvents(t,e){var s=t.animationStart,a=t.animationEnd,r=a-s,i=t.trackLast%r,n=this.events;let o=0,h=n.length;for(;o<h;o++){var l=n[o];if(l.time<i)break;l.time>a||this.queue.event(t,l)}let c=!1;for((c=t.loop?0==r||i>t.trackTime%r:a<=e&&t.animationLast<a)&&this.queue.complete(t);o<h;o++){var d=n[o];d.time<s||this.queue.event(t,d)}}clearTracks(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(e){if(!(e>=this.tracks.length)){e=this.tracks[e];if(e){this.queue.end(e),this.clearNext(e);let t=e;for(;;){var s=t.mixingFrom;if(!s)break;this.queue.end(s),t.mixingFrom=null,t.mixingTo=null,t=s}this.tracks[e.trackIndex]=null,this.queue.drain()}}}setCurrent(t,e,s){var a=this.expandToIndex(t);(this.tracks[t]=e).previous=null,a&&(s&&this.queue.interrupt(a),((e.mixingFrom=a).mixingTo=e).mixTime=0,a.mixingFrom&&0<a.mixDuration&&(e.interruptAlpha*=Math.min(1,a.mixTime/a.mixDuration)),a.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,s=!1){var a=this.data.skeletonData.findAnimation(e);if(a)return this.setAnimationWith(t,a,s);throw new Error("Animation not found: "+e)}setAnimationWith(t,e,s=!1){if(!e)throw new Error("animation cannot be null.");let a=!0,r=this.expandToIndex(t);r&&(-1==r.nextTrackLast?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.clearNext(r),r=r.mixingFrom,a=!1):this.clearNext(r));e=this.trackEntry(t,e,s,r);return this.setCurrent(t,e,a),this.queue.drain(),e}addAnimation(t,e,s=!1,a=0){var r=this.data.skeletonData.findAnimation(e);if(r)return this.addAnimationWith(t,r,s,a);throw new Error("Animation not found: "+e)}addAnimationWith(t,e,s=!1,a=0){if(!e)throw new Error("animation cannot be null.");let r=this.expandToIndex(t);if(r)for(;r.next;)r=r.next;e=this.trackEntry(t,e,s,r);return r?((r.next=e).previous=r,a<=0&&(a+=r.getTrackComplete()-e.mixDuration)):(this.setCurrent(t,e,!0),this.queue.drain()),e.delay=a,e}setEmptyAnimation(t,e=0){t=this.setAnimationWith(t,dt.emptyAnimation(),!1);return t.mixDuration=e,t.trackEnd=e,t}addEmptyAnimation(t,e=0,s=0){t=this.addAnimationWith(t,dt.emptyAnimation(),!1,s);return s<=0&&(t.delay+=t.mixDuration-e),t.mixDuration=e,t.trackEnd=e,t}setEmptyAnimations(s=0){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++){var a=this.tracks[t];a&&this.setEmptyAnimation(a.trackIndex,s)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(pe.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,s,a){var r=this.trackEntryPool.obtain();return r.reset(),r.trackIndex=t,r.animation=e,r.loop=s,r.holdPrevious=!1,r.reverse=!1,r.shortestRotation=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.mixTime=0,r.mixDuration=a?this.data.getMix(a.animation,e):0,r.interruptAlpha=1,r.totalAlpha=0,r.mixBlend=2,r}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();var s=this.tracks;for(let e=0,t=s.length;e<t;e++){let t=s[e];if(t){for(;t.mixingFrom;)t=t.mixingFrom;for(;t.mixingTo&&3==t.mixBlend||this.computeHold(t),t=t.mixingTo;);}}}computeHold(s){var a=s.mixingTo,r=s.animation.timelines,i=s.animation.timelines.length,n=s.timelineMode,o=(n.length=i,s.timelineHoldMix),h=(o.length=0,this.propertyIDs);if(a&&a.holdPrevious)for(let t=0;t<i;t++)n[t]=h.addAll(r[t].getPropertyIds())?wt:xt;else t:for(let e=0;e<i;e++){var t=r[e],l=t.getPropertyIds();if(h.addAll(l))if(!a||t instanceof xe||t instanceof be||t instanceof we||!a.animation.hasTimeline(l))n[e]=vt;else{for(let t=a.mixingTo;t;t=t.mixingTo)if(!t.animation.hasTimeline(l)){if(0<s.mixDuration){n[e]=bt,o[e]=t;continue t}break}n[e]=wt}else n[e]=gt}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){t=this.listeners.indexOf(t);0<=t&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}}),ut=dt,mt=(ut._emptyAnimation=new ge("<empty>",[],0),class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=2,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){var t;return this.loop?0==(t=this.animationEnd-this.animationStart)?this.animationStart:this.trackTime%t+this.animationStart:Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){var t=this.animationEnd-this.animationStart;if(0!=t){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}}),ft=class{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(u.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(u.interrupt),this.objects.push(t)}end(t){this.objects.push(u.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(u.dispose),this.objects.push(t)}complete(t){this.objects.push(u.complete),this.objects.push(t)}event(t,e){this.objects.push(u.event),this.objects.push(t),this.objects.push(e)}drain(){if(!this.drainDisabled){this.drainDisabled=!0;var e=this.objects,s=this.animState.listeners;for(let t=0;t<e.length;t+=2){var a=e[t],r=e[t+1];switch(a){case u.start:r.listener&&r.listener.start&&r.listener.start(r);for(let t=0;t<s.length;t++){var i=s[t];i.start&&i.start(r)}break;case u.interrupt:r.listener&&r.listener.interrupt&&r.listener.interrupt(r);for(let t=0;t<s.length;t++){var n=s[t];n.interrupt&&n.interrupt(r)}break;case u.end:r.listener&&r.listener.end&&r.listener.end(r);for(let t=0;t<s.length;t++){var o=s[t];o.end&&o.end(r)}case u.dispose:r.listener&&r.listener.dispose&&r.listener.dispose(r);for(let t=0;t<s.length;t++){var h=s[t];h.dispose&&h.dispose(r)}this.animState.trackEntryPool.free(r);break;case u.complete:r.listener&&r.listener.complete&&r.listener.complete(r);for(let t=0;t<s.length;t++){var l=s[t];l.complete&&l.complete(r)}break;case u.event:var c=e[2+t++];r.listener&&r.listener.event&&r.listener.event(r,c);for(let t=0;t<s.length;t++){var d=s[t];d.event&&d.event(r,c)}}}this.clear(),this.drainDisabled=!1}}clear(){this.objects.length=0}},u=(t=>(t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event",t))(u||{}),pt=class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}},gt=0,vt=1,xt=2,wt=3,bt=4,yt=1,At=2,kt=class{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,s){var a=this.skeletonData.findAnimation(t);if(!a)throw new Error("Animation not found: "+t);t=this.skeletonData.findAnimation(e);if(!t)throw new Error("Animation not found: "+e);this.setMixWith(a,t,s)}setMixWith(t,e,s){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");t=t.name+"."+e.name;this.animationToMixTime[t]=s}getMix(t,e){t=t.name+"."+e.name,e=this.animationToMixTime[t];return void 0===e?this.defaultMix:e}},St=class extends D{constructor(t){super(t),this.color=new fe(1,1,1,1)}copy(){var t=new St(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}},It=class extends D{constructor(t){super(t),this.endSlot=null,this.color=new fe(.2275,.2275,.8078,1)}copy(){var t=new It(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}},Ct=class{constructor(t){this._image=t}getImage(){return this._image}},Tt=(t=>(t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear",t))(Tt||{}),Yt=(t=>(t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat",t))(Yt||{}),Mt=class{constructor(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.degrees=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0}},Ft=class extends Ct{setFilters(t,e){}setWraps(t,e){}dispose(){}},Et=class{constructor(t){this.pages=new Array,this.regions=new Array;var e=new Xt(t);let s=new Array(4);var a={size:t=>{t.width=parseInt(s[1]),t.height=parseInt(s[2])},format:()=>{},filter:t=>{t.minFilter=pe.enumValue(Tt,s[1]),t.magFilter=pe.enumValue(Tt,s[2])},repeat:t=>{-1!=s[1].indexOf("x")&&(t.uWrap=10497),-1!=s[1].indexOf("y")&&(t.vWrap=10497)},pma:t=>{t.pma="true"==s[1]}},r={xy:t=>{t.x=parseInt(s[1]),t.y=parseInt(s[2])},size:t=>{t.width=parseInt(s[1]),t.height=parseInt(s[2])},bounds:t=>{t.x=parseInt(s[1]),t.y=parseInt(s[2]),t.width=parseInt(s[3]),t.height=parseInt(s[4])},offset:t=>{t.offsetX=parseInt(s[1]),t.offsetY=parseInt(s[2])},orig:t=>{t.originalWidth=parseInt(s[1]),t.originalHeight=parseInt(s[2])},offsets:t=>{t.offsetX=parseInt(s[1]),t.offsetY=parseInt(s[2]),t.originalWidth=parseInt(s[3]),t.originalHeight=parseInt(s[4])},rotate:t=>{var e=s[1];"true"==e?t.degrees=90:"false"!=e&&(t.degrees=parseInt(e))},index:t=>{t.index=parseInt(s[1])}};let i=e.readLine();for(;i&&0==i.trim().length;)i=e.readLine();for(;;){if(!i||0==i.trim().length)break;if(0==e.readEntry(s,i))break;i=e.readLine()}let n=null,o=null,h=null;for(;;){if(null===i)break;if(0==i.trim().length)n=null,i=e.readLine();else if(n){for(var l=new Bt(n,i);;){var c=e.readEntry(s,i=e.readLine());if(0==c)break;var d=r[s[0]];if(d)d(l);else{o=o||[],h=h||[],o.push(s[0]);var u=[];for(let t=0;t<c;t++)u.push(parseInt(s[t+1]));h.push(u)}}0==l.originalWidth&&0==l.originalHeight&&(l.originalWidth=l.width,l.originalHeight=l.height),o&&0<o.length&&h&&0<h.length&&(l.names=o,l.values=h,o=null,h=null),l.u=l.x/n.width,l.v=l.y/n.height,90==l.degrees?(l.u2=(l.x+l.height)/n.width,l.v2=(l.y+l.width)/n.height):(l.u2=(l.x+l.width)/n.width,l.v2=(l.y+l.height)/n.height),this.regions.push(l)}else{for(n=new Rt(i.trim());;){if(0==e.readEntry(s,i=e.readLine()))break;var m=a[s[0]];m&&m(n)}this.pages.push(n)}}}findRegion(e){for(let t=0;t<this.regions.length;t++)if(this.regions[t].name==e)return this.regions[t];return null}setTextures(t,e=""){for(var s of this.pages)s.setTexture(t.get(e+s.name))}dispose(){var e;for(let t=0;t<this.pages.length;t++)null!=(e=this.pages[t].texture)&&e.dispose()}},Xt=class{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(s,a){if(!a)return 0;if(0==(a=a.trim()).length)return 0;var r=a.indexOf(":");if(-1==r)return 0;s[0]=a.substr(0,r).trim();for(let t=1,e=r+1;;t++){var i=a.indexOf(",",e);if(-1==i)return s[t]=a.substr(e).trim(),t;if(s[t]=a.substr(e,i-e).trim(),e=i+1,4==t)return 4}}},Rt=class{constructor(t){this.minFilter=9728,this.magFilter=9728,this.uWrap=33071,this.vWrap=33071,this.texture=null,this.width=0,this.height=0,this.pma=!1,this.regions=new Array,this.name=t}setTexture(t){(this.texture=t).setFilters(this.minFilter,this.magFilter),t.setWraps(this.uWrap,this.vWrap);for(var e of this.regions)e.texture=t}},Bt=class extends Mt{constructor(t,e){super(),this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.index=0,this.degrees=0,this.names=null,this.values=null,this.page=t,this.name=e,t.regions.push(this)}},m=class extends D{constructor(t,e){super(t),this.region=null,this.regionUVs=[],this.uvs=[],this.triangles=[],this.color=new fe(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new fe(0,0,0,0),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");var e=this.regionUVs,s=(this.uvs&&this.uvs.length==e.length||(this.uvs=pe.newFloatArray(e.length)),this.uvs),a=this.uvs.length;let r=this.region.u,i=this.region.v,n=0,o=0;if(this.region instanceof Bt){var t=this.region,h=t.page.texture.getImage(),l=h.width,c=h.height;switch(t.degrees){case 90:r-=(t.originalHeight-t.offsetY-t.height)/l,i-=(t.originalWidth-t.offsetX-t.width)/c,n=t.originalHeight/l,o=t.originalWidth/c;for(let t=0;t<a;t+=2)s[t]=r+e[t+1]*n,s[t+1]=i+(1-e[t])*o;return;case 180:r-=(t.originalWidth-t.offsetX-t.width)/l,i-=t.offsetY/c,n=t.originalWidth/l,o=t.originalHeight/c;for(let t=0;t<a;t+=2)s[t]=r+(1-e[t])*n,s[t+1]=i+(1-e[t+1])*o;return;case 270:r-=t.offsetY/l,i-=t.offsetX/c,n=t.originalHeight/l,o=t.originalWidth/c;for(let t=0;t<a;t+=2)s[t]=r+(1-e[t+1])*n,s[t+1]=i+e[t]*o;return}r-=t.offsetX/l,i-=(t.originalHeight-t.offsetY-t.height)/c,n=t.originalWidth/l,o=t.originalHeight/c}else this.region?(n=this.region.u2-r,o=this.region.v2-i):(r=i=0,n=o=1);for(let t=0;t<a;t+=2)s[t]=r+e[t]*n,s[t+1]=i+e[t+1]*o}getParentMesh(){return this.parentMesh}setParentMesh(t){(this.parentMesh=t)&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){var t;return this.parentMesh?this.newLinkedMesh():((t=new m(this.name,this.path)).region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),pe.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),pe.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),pe.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),pe.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t)}computeWorldVertices(t,e,s,a,r,i){null!=this.sequence&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,s,a,r,i)}newLinkedMesh(){var t=new m(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh||this),null!=t.region&&t.updateRegion(),t}},l=class extends D{constructor(t){super(t),this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new fe(1,1,1,1)}copy(){var t=new l(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),pe.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}},_t=class extends D{constructor(t){super(t),this.x=0,this.y=0,this.rotation=0,this.color=new fe(.38,.94,0,1)}computeWorldPosition(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e}computeWorldRotation(t){var e=W.cosDeg(this.rotation),s=W.sinDeg(this.rotation),a=e*t.a+s*t.b,e=e*t.c+s*t.d;return Math.atan2(e,a)*W.radDeg}copy(){var t=new _t(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}},Pt=class extends X{constructor(t,e){super(t),this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new fe(1,1,1,1),this.region=null,this.sequence=null,this.offset=pe.newFloatArray(8),this.uvs=pe.newFloatArray(8),this.tempColor=new fe(1,1,1,1),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");var t,e,s,a,r,i,n,o,h,l,c,d,u=this.region,m=this.uvs;null==u?(m[0]=0,m[1]=0,m[2]=0,m[3]=1,m[4]=1,m[5]=1,m[6]=1,m[7]=0):(h=this.width/this.region.originalWidth*this.scaleX,c=this.height/this.region.originalHeight*this.scaleY,a=-this.width/2*this.scaleX+this.region.offsetX*h,t=-this.height/2*this.scaleY+this.region.offsetY*c,h=a+this.region.width*h,c=t+this.region.height*c,e=this.rotation*Math.PI/180,n=Math.cos(e),e=Math.sin(e),s=this.x,r=a*e,i=t*n+(l=this.y),o=h*n+s,h*=e,l=c*n+l,c*=e,(d=this.offset)[0]=(a=a*n+s)-(n=t*e),d[1]=i+r,d[2]=a-c,d[3]=l+r,d[4]=o-c,d[5]=l+h,d[6]=o-n,d[7]=i+h,90==u.degrees?(m[0]=u.u2,m[1]=u.v2,m[2]=u.u,m[3]=u.v2,m[4]=u.u,m[5]=u.v,m[6]=u.u2,m[7]=u.v):(m[0]=u.u,m[1]=u.v2,m[2]=u.u,m[3]=u.v,m[4]=u.u2,m[5]=u.v,m[6]=u.u2,m[7]=u.v2))}computeWorldVertices(t,e,s,a){null!=this.sequence&&this.sequence.apply(t,this);var t=t.bone,r=this.offset,i=t.worldX,n=t.worldY,o=t.a,h=t.b,l=t.c,t=t.d,c=r[0],d=r[1];e[s]=c*o+d*h+i,e[s+1]=c*l+d*t+n,c=r[2],d=r[3],e[s+=a]=c*o+d*h+i,e[s+1]=c*l+d*t+n,c=r[4],d=r[5],e[s+=a]=c*o+d*h+i,e[s+1]=c*l+d*t+n,c=r[6],d=r[7],e[s+=a]=c*o+d*h+i,e[s+1]=c*l+d*t+n}copy(){var t=new Pt(this.name,this.path);return t.region=this.region,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,pe.arrayCopy(this.uvs,0,t.uvs,0,8),pe.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t.sequence=null!=this.sequence?this.sequence.copy():null,t}},f=Pt,Dt=(f.X1=0,f.Y1=1,f.C1R=2,f.C1G=3,f.C1B=4,f.C1A=5,f.U1=6,f.V1=7,f.X2=8,f.Y2=9,f.C2R=10,f.C2G=11,f.C2B=12,f.C2A=13,f.U2=14,f.V2=15,f.X3=16,f.Y3=17,f.C3R=18,f.C3G=19,f.C3B=20,f.C3A=21,f.U3=22,f.V3=23,f.X4=24,f.Y4=25,f.C4R=26,f.C4G=27,f.C4B=28,f.C4A=29,f.U4=30,f.V4=31,class{constructor(t){this.atlas=t}loadSequence(s,a,r){var i=r.regions;for(let t=0,e=i.length;t<e;t++){var n=r.getPath(a,t),o=this.atlas.findRegion(n);if(null==o)throw new Error("Region not found in atlas: "+n+" (sequence: "+s+")");i[t]=o}}newRegionAttachment(t,e,s,a){var r=new f(e,s);if(null!=a)this.loadSequence(e,s,a);else{a=this.atlas.findRegion(s);if(!a)throw new Error("Region not found in atlas: "+s+" (region attachment: "+e+")");r.region=a}return r}newMeshAttachment(t,e,s,a){var r=new m(e,s);if(null!=a)this.loadSequence(e,s,a);else{a=this.atlas.findRegion(s);if(!a)throw new Error("Region not found in atlas: "+s+" (mesh attachment: "+e+")");r.region=a}return r}newBoundingBoxAttachment(t,e){return new St(e)}newPathAttachment(t,e){return new l(e)}newPointAttachment(t,e){return new _t(e)}newClippingAttachment(t,e){return new It(e)}}),Vt=class{constructor(t,e,s){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Lt.Normal,this.skinRequired=!1,this.color=new fe,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=s}},Lt=(t=>(t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection",t))(Lt||{}),Nt=class{constructor(t,e,s){if(this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,i,n,o,h,l,c){this.ax=t,this.ay=i,this.arotation=n,this.ascaleX=o,this.ascaleY=h,this.ashearX=l,this.ashearY=c;var e,s,a,d=this.parent;if(d){let e=d.a,s=d.b,a=d.c,r=d.d;switch(this.worldX=e*t+s*i+d.worldX,this.worldY=a*t+r*i+d.worldY,this.data.transformMode){case 0:var u=n+90+c,m=W.cosDeg(n+l)*o,f=W.cosDeg(u)*h,p=W.sinDeg(n+l)*o,u=W.sinDeg(u)*h;return this.a=e*m+s*p,this.b=e*f+s*u,this.c=a*m+r*p,void(this.d=a*f+r*u);case 1:m=n+90+c;this.a=W.cosDeg(n+l)*o,this.b=W.cosDeg(m)*h,this.c=W.sinDeg(n+l)*o,this.d=W.sinDeg(m)*h;break;case 2:{p=e*e+a*a;let t=0;f=n+l-(t=1e-4<p?(p=Math.abs(e*r-s*a)/p,e/=this.skeleton.scaleX,a/=this.skeleton.scaleY,s=a*p,r=e*p,Math.atan2(a,e)*W.radDeg):(e=0,a=0,90-Math.atan2(r,s)*W.radDeg)),u=n+c-t+90,m=W.cosDeg(f)*o,p=W.cosDeg(u)*h,f=W.sinDeg(f)*o,u=W.sinDeg(u)*h;this.a=e*m-s*f,this.b=e*p-s*u,this.c=a*m+r*f,this.d=a*p+r*u;break}case 3:case 4:{m=W.cosDeg(n),f=W.sinDeg(n),p=(e*m+s*f)/this.skeleton.scaleX,u=(a*m+r*f)/this.skeleton.scaleY;let t=Math.sqrt(p*p+u*u);p*=t=1e-5<t?1/t:t,u*=t,t=Math.sqrt(p*p+u*u),3==this.data.transformMode&&e*r-s*a<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(t=-t);var m=Math.PI/2+Math.atan2(u,p),f=Math.cos(m)*t,m=Math.sin(m)*t,g=W.cosDeg(l)*o,v=W.cosDeg(90+c)*h,x=W.sinDeg(l)*o,w=W.sinDeg(90+c)*h;this.a=p*g+f*x,this.b=p*v+f*w,this.c=u*g+m*x,this.d=u*v+m*w;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}else d=n+90+c,s=(e=this.skeleton).scaleX,a=e.scaleY,this.a=W.cosDeg(n+l)*o*s,this.b=W.cosDeg(d)*h*s,this.c=W.sinDeg(n+l)*o*a,this.d=W.sinDeg(d)*h*a,this.worldX=t*s+e.x,this.worldY=i*a+e.y}setToSetupPose(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.c,this.a)*W.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*W.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}updateAppliedTransform(){var t,e,s,a,r,i,n=this.parent;n?(a=n.a,s=n.b,i=n.c,e=n.d,t=this.worldX-n.worldX,n=this.worldY-n.worldY,this.ax=t*e*(r=1/(a*e-s*i))-n*s*r,this.ay=n*a*r-t*i*r,e=(n=r*e)*this.a-(t=r*s)*this.c,s=n*this.b-t*this.d,a=(n=r*a)*this.c-(t=r*i)*this.a,r=n*this.d-t*this.b,this.ashearX=0,this.ascaleX=Math.sqrt(e*e+a*a),1e-4<this.ascaleX?(this.ascaleY=(i=e*r-s*a)/this.ascaleX,this.ashearY=Math.atan2(e*s+a*r,i)*W.radDeg,this.arotation=Math.atan2(a,e)*W.radDeg):(this.ascaleX=0,this.ascaleY=Math.sqrt(s*s+r*r),this.ashearY=0,this.arotation=90-Math.atan2(r,s)*W.radDeg)):(this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*W.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*W.radDeg)}worldToLocal(t){var e=1/(this.a*this.d-this.b*this.c),s=t.x-this.worldX,a=t.y-this.worldY;return t.x=s*this.d*e-a*this.b*e,t.y=a*this.a*e-s*this.c*e,t}localToWorld(t){var e=t.x,s=t.y;return t.x=e*this.a+s*this.b+this.worldX,t.y=e*this.c+s*this.d+this.worldY,t}worldToLocalRotation(t){var e=W.sinDeg(t),t=W.cosDeg(t);return Math.atan2(this.a*e-this.c*t,this.d*t-this.b*e)*W.radDeg+this.rotation-this.shearX}localToWorldRotation(t){t-=this.rotation-this.shearX;var e=W.sinDeg(t),t=W.cosDeg(t);return Math.atan2(t*this.c+e*this.d,t*this.a+e*this.b)*W.radDeg}rotateWorld(t){var e=this.a,s=this.b,a=this.c,r=this.d,i=W.cosDeg(t),t=W.sinDeg(t);this.a=i*e-t*a,this.b=i*s-t*r,this.c=t*e+i*a,this.d=t*s+i*r}},qt=class{constructor(t,e,s){this.name=t,this.order=e,this.skinRequired=s}},Ot=class{constructor(t,e="",s=new Ut){this.pathPrefix="",this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.textureLoader=t,this.pathPrefix=e,this.downloader=s}start(t){return this.toLoad++,this.pathPrefix+t}success(t,e,s){this.toLoad--,this.loaded++,this.assets[e]=s,t&&t(e,s)}error(t,e,s){this.toLoad--,this.loaded++,this.errors[e]=s,t&&t(e,s)}loadAll(){return new Promise((t,e)=>{let s=()=>{this.isLoadingComplete()?this.hasErrors()?e(this.errors):t(this):requestAnimationFrame(s)};requestAnimationFrame(s)})}setRawDataURI(t,e){this.downloader.rawDataUris[this.pathPrefix+t]=e}loadBinary(s,e=()=>{},a=()=>{}){s=this.start(s),this.downloader.downloadBinary(s,t=>{this.success(e,s,t)},(t,e)=>{this.error(a,s,`Couldn't load binary ${s}: status ${t}, `+e)})}loadText(s,e=()=>{},a=()=>{}){s=this.start(s),this.downloader.downloadText(s,t=>{this.success(e,s,t)},(t,e)=>{this.error(a,s,`Couldn't load text ${s}: status ${t}, `+e)})}loadJson(s,e=()=>{},a=()=>{}){s=this.start(s),this.downloader.downloadJson(s,t=>{this.success(e,s,t)},(t,e)=>{this.error(a,s,`Couldn't load JSON ${s}: status ${t}, `+e)})}loadTexture(e,s=()=>{},a=()=>{}){if(e=this.start(e),!!("undefined"==typeof window||"undefined"==typeof navigator||!window.document))fetch(e,{mode:"cors"}).then(t=>t.ok?t.blob():(this.error(a,e,"Couldn't load image: "+e),null)).then(t=>t?createImageBitmap(t,{premultiplyAlpha:"none",colorSpaceConversion:"none"}):null).then(t=>{t&&this.success(s,e,this.textureLoader(t))});else{let t=new Image;t.crossOrigin="anonymous",t.onload=()=>{this.success(s,e,this.textureLoader(t))},t.onerror=()=>{this.error(a,e,"Couldn't load image: "+e)},this.downloader.rawDataUris[e]&&(e=this.downloader.rawDataUris[e]),t.src=e}}loadTextureAtlas(n,o=()=>{},h=()=>{},e){var t=n.lastIndexOf("/");let l=0<=t?n.substring(0,t+1):"";n=this.start(n),this.downloader.downloadText(n,t=>{try{let a=new Et(t),r=a.pages.length,i=!1;for(let s of a.pages)this.loadTexture(e?e[s.name]:l+s.name,(t,e)=>{i||(s.setTexture(e),0==--r&&this.success(o,n,a))},(t,e)=>{i||this.error(h,n,`Couldn't load texture atlas ${n} page image: `+t),i=!0})}catch(t){this.error(h,n,`Couldn't parse texture atlas ${n}: `+t.message)}},(t,e)=>{this.error(h,n,`Couldn't load texture atlas ${n}: status ${t}, `+e)})}get(t){return this.assets[this.pathPrefix+t]}require(t){t=this.pathPrefix+t;var e=this.assets[t];if(e)return e;e=this.errors[t];throw Error("Asset not found: "+t+(e?"\n"+e:""))}remove(t){t=this.pathPrefix+t;var e=this.assets[t];return e.dispose&&e.dispose(),delete this.assets[t],e}removeAll(){for(var t in this.assets){t=this.assets[t];t.dispose&&t.dispose()}this.assets={}}isLoadingComplete(){return 0==this.toLoad}getToLoad(){return this.toLoad}getLoaded(){return this.loaded}dispose(){this.removeAll()}hasErrors(){return 0<Object.keys(this.errors).length}getErrors(){return this.errors}},Ut=class{constructor(){this.callbacks={},this.rawDataUris={}}dataUriToString(t){var e;if(t.startsWith("data:"))return-1!=(e=t.indexOf("base64,"))?(e+="base64,".length,atob(t.substr(e))):t.substr(t.indexOf(",")+1);throw new Error("Not a data URI.")}base64ToUint8Array(t){for(var e=window.atob(t),s=e.length,a=new Uint8Array(s),r=0;r<s;r++)a[r]=e.charCodeAt(r);return a}dataUriToUint8Array(t){if(!t.startsWith("data:"))throw new Error("Not a data URI.");var e=t.indexOf("base64,");if(-1==e)throw new Error("Not a binary data URI.");return this.base64ToUint8Array(t.substr(e+="base64,".length))}downloadText(e,s,t){if(!this.start(e,s,t))if(this.rawDataUris[e])try{var a=this.rawDataUris[e];this.finish(e,200,this.dataUriToString(a))}catch(t){this.finish(e,400,JSON.stringify(t))}else{let t=new XMLHttpRequest;t.overrideMimeType("text/html"),t.open("GET",e,!0);s=()=>{this.finish(e,t.status,t.responseText)};t.onload=s,t.onerror=s,t.send()}}downloadJson(t,e,s){this.downloadText(t,t=>{e(JSON.parse(t))},s)}downloadBinary(s,t,e){if(!this.start(s,t,e))if(this.rawDataUris[s])try{var a=this.rawDataUris[s];this.finish(s,200,this.dataUriToUint8Array(a))}catch(t){this.finish(s,400,JSON.stringify(t))}else{let t=new XMLHttpRequest,e=(t.open("GET",s,!0),t.responseType="arraybuffer",()=>{this.finish(s,t.status,t.response)});t.onload=()=>{200==t.status||0==t.status?this.finish(s,200,new Uint8Array(t.response)):e()},t.onerror=e,t.send()}}start(t,e,s){let a=this.callbacks[t];try{if(a)return!0;this.callbacks[t]=a=[]}finally{a.push(e,s)}}finish(t,e,s){var a=this.callbacks[t],r=(delete this.callbacks[t],200==e||0==e?[s]:[e,s]);for(let t=r.length-1,e=a.length;t<e;t+=2)a[t].apply(null,r)}},$e=class{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}},Wt=class{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}},zt=class{constructor(e,s){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!e)throw new Error("data cannot be null.");if(!s)throw new Error("skeleton cannot be null.");this.data=e,this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch,this.bones=new Array;for(let t=0;t<e.bones.length;t++){var a=s.findBone(e.bones[t].name);if(!a)throw new Error("Couldn't find bone "+e.bones[t].name);this.bones.push(a)}var t=s.findBone(e.target.name);if(!t)throw new Error("Couldn't find bone "+e.target.name);this.target=t}isActive(){return this.active}update(){if(0!=this.mix){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}}apply1(t,e,s,a,r,i,n){var o=t.parent;if(!o)throw new Error("IK bone must have parent.");let h=o.a,l=o.b,c=o.c,d=o.d,u=-t.ashearX-t.arotation,m=0,f=0;switch(t.data.transformMode){case 1:m=e-t.worldX,f=s-t.worldY;break;case 2:var p=Math.abs(h*d-l*c)/Math.max(1e-4,h*h+c*c),g=h/t.skeleton.scaleX,v=c/t.skeleton.scaleY;l=-v*p*t.skeleton.scaleX,d=g*p*t.skeleton.scaleY,u+=Math.atan2(v,g)*W.radDeg;default:p=e-o.worldX,v=s-o.worldY,g=h*d-l*c;f=Math.abs(g)<=1e-4?m=0:(m=(p*d-v*l)/g-t.ax,(v*h-p*c)/g-t.ay)}u+=Math.atan2(f,m)*W.radDeg,t.ascaleX<0&&(u+=180),180<u?u-=360:u<-180&&(u+=360);let x=t.ascaleX,w=t.ascaleY;if(a||r){switch(t.data.transformMode){case 3:case 4:m=e-t.worldX,f=s-t.worldY}var b=t.data.length*x,y=Math.sqrt(m*m+f*f);(a&&y<b||r&&b<y&&1e-4<b)&&(a=(y/b-1)*n+1,x*=a,i)&&(w*=a)}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+u*n,x,w,t.ashearX,t.ashearY)}apply2(t,e,s,a,d,r,V,i,n){let o=t.ax,u=t.ay,m=t.ascaleX,f=t.ascaleY,L=m,N=f,p=e.ascaleX,g=0,q=0,v=0,x=(v=m<0?(m=-m,g=180,-1):(g=0,1),f<0&&(f=-f,v=-v),q=p<0?(p=-p,180):0,e.ax),w=0,h=0,l=0,b=t.a,y=t.b,A=t.c,k=t.d;var O=Math.abs(m-f)<=1e-4,S=(l=!O||r?(w=0,h=b*x+t.worldX,A*x+t.worldY):(w=e.ay,h=b*x+y*w+t.worldX,A*x+k*w+t.worldY),t.parent);if(!S)throw new Error("IK parent must itself have a parent.");b=S.a,y=S.b,A=S.c,k=S.d;let I=b*k-y*A,C=h-S.worldX,T=l-S.worldY;I=Math.abs(I)<=1e-4?0:1/I;var Y=(C*k-T*y)*I-o,M=(T*b-C*A)*I-u;let F=Math.sqrt(Y*Y+M*M),E=e.data.length*p,X,R;if(F<1e-4)this.apply1(t,s,a,!1,r,!1,n),e.updateWorldTransformWith(x,w,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);else{let h=((C=s-S.worldX)*k-(T=a-S.worldY)*y)*I-o,l=(T*b-C*A)*I-u,c=h*h+l*l;0!=i&&(i*=m*(p+1)*.5,0<(M=(Y=Math.sqrt(c))-F-E*m+i))&&(s=(M-i*(1-(s=Math.min(1,M/(2*i))-1)*s))/Y,h-=s*h,l-=s*l,c=h*h+l*l);t:if(O){E*=m;let t=(c-F*F-E*E)/(2*F*E);t<-1?(t=-1,R=Math.PI*d):1<t?(t=1,R=0,r&&(b=(Math.sqrt(c)/(F+E)-1)*n+1,L*=b,V)&&(N*=b)):R=Math.acos(t)*d,b=F+E*t,y=E*Math.sin(R),X=Math.atan2(l*b-h*y,h*b+l*y)}else{b=m*E,y=f*E;var B=b*b,_=y*y,U=Math.atan2(l,h),P=-2*_*F,D=_-B;if(0<=(k=P*P-4*D*(A=_*F*F+B*c-B*_))){let t=Math.sqrt(k);P=(t=.5*-(P+(t=P<0?-t:t)))/D,D=A/t,P=Math.abs(P)<Math.abs(D)?P:D;if(P*P<=c){T=Math.sqrt(c-P*P)*d,X=U-Math.atan2(T,P),R=Math.atan2(T/f,(P-F)/m);break t}}let t=W.PI,e=F-b,s=e*e,a=0,r=0,i=F+b,n=i*i,o=0;-1<=(A=-b*F/(B-_))&&A<=1&&(A=Math.acos(A),(k=(C=b*Math.cos(A)+F)*C+(T=y*Math.sin(A))*T)<s&&(t=A,s=k,e=C,a=T),k>n)&&(r=A,n=k,i=C,o=T),R=c<=.5*(s+n)?(X=U-Math.atan2(a*d,e),t*d):(X=U-Math.atan2(o*d,i),r*d)}a=Math.atan2(w,x)*v,S=t.arotation;180<(X=(X-a)*W.radDeg+g-S)?X-=360:X<-180&&(X+=360),t.updateWorldTransformWith(o,u,S+X*n,L,N,0,0),S=e.arotation,180<(R=((R+a)*W.radDeg-e.ashearX)*v+q-S)?R-=360:R<-180&&(R+=360),e.updateWorldTransformWith(x,w,S+R*n,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}},$t=class extends qt{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}},jt=class extends qt{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=Ht.Fixed,this.spacingMode=te.Fixed,this.rotateMode=ee.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}},Ht=(t=>(t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent",t))(Ht||{}),te=(t=>(t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent",t[t.Proportional=3]="Proportional",t))(te||{}),ee=(t=>(t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale",t))(ee||{}),O=class{constructor(s,a){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!s)throw new Error("data cannot be null.");if(!a)throw new Error("skeleton cannot be null.");this.data=s,this.bones=new Array;for(let t=0,e=s.bones.length;t<e;t++){var r=a.findBone(s.bones[t].name);if(!r)throw new Error(`Couldn't find bone ${s.bones[t].name}.`);this.bones.push(r)}var t=a.findSlot(s.target.name);if(!t)throw new Error("Couldn't find target bone "+s.target.name);this.target=t,this.position=s.position,this.spacing=s.spacing,this.mixRotate=s.mixRotate,this.mixX=s.mixX,this.mixY=s.mixY}isActive(){return this.active}update(){var t=this.target.getAttachment();if(t instanceof l){var m=this.mixRotate,e=this.mixX,s=this.mixY;if(0!=m||0!=e||0!=s){var a=this.data,f=0==a.rotateMode,r=2==a.rotateMode,i=this.bones,n=i.length,o=f?n:n+1,p=pe.setArraySize(this.spaces,o),g=r?this.lengths=pe.setArraySize(this.lengths,n):[],h=this.spacing;switch(a.spacingMode){case 2:if(r)for(let t=0,e=o-1;t<e;t++){var v,x=i[t],w=x.data.length;w<O.epsilon?g[t]=0:(v=w*x.a,w=w*x.c,g[t]=Math.sqrt(v*v+w*w))}pe.arrayFill(p,1,o,h);break;case 3:let s=0;for(let t=0,e=o-1;t<e;){var b,y=i[t],A=y.data.length;A<O.epsilon?(r&&(g[t]=0),p[++t]=h):(b=A*y.a,A=A*y.c,y=Math.sqrt(b*b+A*A),r&&(g[t]=y),p[++t]=y,s+=y)}if(0<s){s=o/s*h;for(let t=1;t<o;t++)p[t]*=s}break;default:var k=0==a.spacingMode;for(let t=0,e=o-1;t<e;){var S,I=i[t],C=I.data.length;C<O.epsilon?(r&&(g[t]=0),p[++t]=h):(S=C*I.a,I=C*I.c,S=Math.sqrt(S*S+I*I),r&&(g[t]=S),p[++t]=(k?C+h:h)*S/C)}}var T=this.computeWorldPositions(t,o,f);let l=T[0],c=T[1],d=a.offsetRotation,u=!1;0==d?u=1==a.rotateMode:(u=!1,t=this.target.bone,d*=0<t.a*t.d-t.b*t.c?W.degRad:-W.degRad);for(let o=0,h=3;o<n;o++,h+=3){var Y,M=i[o],F=(M.worldX+=(l-M.worldX)*e,M.worldY+=(c-M.worldY)*s,T[h]),E=T[h+1],X=F-l,R=E-c;if(r&&0!=(Y=g[o])&&(Y=(Math.sqrt(X*X+R*R)/Y-1)*m+1,M.a*=Y,M.c*=Y),l=F,c=E,0<m){let t=M.a,e=M.b,s=M.c,a=M.d,r=0,i=0,n=0;r=f?T[h-1]:0==p[o+1]?T[h+2]:Math.atan2(R,X),r-=Math.atan2(s,t),u?(i=Math.cos(r),n=Math.sin(r),Y=M.data.length,l+=(Y*(i*t-n*s)-X)*m,c+=(Y*(n*t+i*s)-R)*m):r+=d,r>W.PI?r-=W.PI2:r<-W.PI&&(r+=W.PI2),r*=m,i=Math.cos(r),n=Math.sin(r),M.a=i*t-n*s,M.b=i*e-n*a,M.c=n*t+i*s,M.d=n*e+i*a}M.updateAppliedTransform()}}}}computeWorldPositions(S,t,I){var C=this.target;let T=this.position,Y=this.spaces,M=pe.setArraySize(this.positions,3*t+2),F=this.world;var E=S.closed;let X=S.worldVerticesLength,R=X/6,B=O.NONE;if(S.constantSpeed){E?(X+=2,F=pe.setArraySize(this.world,X),S.computeWorldVertices(C,2,X-4,F,0,2),S.computeWorldVertices(C,0,2,F,X-4,2),F[X-2]=F[0],F[X-1]=F[1]):(R--,X-=4,F=pe.setArraySize(this.world,X),S.computeWorldVertices(C,2,X,F,0,2));var _=pe.setArraySize(this.curves,R);let i=0,n=F[0],o=F[1],h=0,l=0,c=0,d=0,u=0,m=0,f=0,p=0,g=0,v=0,x=0,w=0,b=0,y=0;for(let t=0,e=2;t<R;t++,e+=6)h=F[e],l=F[e+1],c=F[e+2],d=F[e+3],u=F[e+4],m=F[e+5],f=.1875*(n-2*h+c),p=.1875*(o-2*l+d),g=.09375*(3*(h-c)-n+u),v=.09375*(3*(l-d)-o+m),x=2*f+g,w=2*p+v,b=.75*(h-n)+f+.16666667*g,y=.75*(l-o)+p+.16666667*v,i+=Math.sqrt(b*b+y*y),b+=x,y+=w,x+=g,w+=v,i+=Math.sqrt(b*b+y*y),b+=x,y+=w,i+=Math.sqrt(b*b+y*y),b+=x+g,y+=w+v,i+=Math.sqrt(b*b+y*y),_[t]=i,n=u,o=m;1==this.data.positionMode&&(T*=i);let A;switch(this.data.spacingMode){case 2:A=i;break;case 3:A=i/t;break;default:A=1}var P=this.segments;let k=0;for(let e=0,s=0,a=0,r=0;e<t;e++,s+=3){var D=Y[e]*A;let t=T+=D;if(E)(t%=i)<0&&(t+=i),a=0;else{if(t<0){this.addBeforePosition(t,F,0,M,s);continue}if(t>i){this.addAfterPosition(t-i,F,X-4,M,s);continue}}for(;;a++){var V,L=_[a];if(!(t>L)){0==a?t/=L:(V=_[a-1],t=(t-V)/(L-V));break}}if(a!=B){let t=6*(B=a);for(n=F[t],o=F[t+1],h=F[t+2],l=F[t+3],c=F[t+4],d=F[t+5],u=F[t+6],m=F[t+7],f=.03*(n-2*h+c),p=.03*(o-2*l+d),g=.006*(3*(h-c)-n+u),v=.006*(3*(l-d)-o+m),x=2*f+g,w=2*p+v,b=.3*(h-n)+f+.16666667*g,y=.3*(l-o)+p+.16666667*v,k=Math.sqrt(b*b+y*y),P[0]=k,t=1;t<8;t++)b+=x,y+=w,x+=g,w+=v,k+=Math.sqrt(b*b+y*y),P[t]=k;b+=x,y+=w,k+=Math.sqrt(b*b+y*y),P[8]=k,b+=x+g,y+=w+v,k+=Math.sqrt(b*b+y*y),P[9]=k,r=0}for(t*=k;;r++){var N,q=P[r];if(!(t>q)){0==r?t/=q:(N=P[r-1],t=r+(t-N)/(q-N));break}}this.addCurvePosition(.1*t,n,o,h,l,c,d,u,m,M,s,I||0<e&&0==D)}}else{var i=S.lengths,n=i[R-=E?1:2];1==this.data.positionMode&&(T*=n);let r;switch(this.data.spacingMode){case 2:r=n;break;case 3:r=n/t;break;default:r=1}F=pe.setArraySize(this.world,8);for(let e=0,s=0,a=0;e<t;e++,s+=3){var o=Y[e]*r;let t=T+=o;if(E)(t%=n)<0&&(t+=n),a=0;else{if(t<0){B!=O.BEFORE&&(B=O.BEFORE,S.computeWorldVertices(C,2,4,F,0,2)),this.addBeforePosition(t,F,0,M,s);continue}if(t>n){B!=O.AFTER&&(B=O.AFTER,S.computeWorldVertices(C,X-6,4,F,0,2)),this.addAfterPosition(t-n,F,0,M,s);continue}}for(;;a++){var h,l=i[a];if(!(t>l)){0==a?t/=l:(h=i[a-1],t=(t-h)/(l-h));break}}a!=B&&(B=a,E&&a==R?(S.computeWorldVertices(C,X-4,4,F,0,2),S.computeWorldVertices(C,0,4,F,4,2)):S.computeWorldVertices(C,6*a+2,8,F,0,2)),this.addCurvePosition(t,F[0],F[1],F[2],F[3],F[4],F[5],F[6],F[7],M,s,I||0<e&&0==o)}}return M}addBeforePosition(t,e,s,a,r){var i=e[s],n=e[s+1],o=e[s+2]-i,e=e[s+3]-n,s=Math.atan2(e,o);a[r]=i+t*Math.cos(s),a[r+1]=n+t*Math.sin(s),a[r+2]=s}addAfterPosition(t,e,s,a,r){var i=e[s+2],n=e[s+3],o=i-e[s],e=n-e[s+1],s=Math.atan2(e,o);a[r]=i+t*Math.cos(s),a[r+1]=n+t*Math.sin(s),a[r+2]=s}addCurvePosition(t,e,s,a,r,i,n,o,h,l,c,d){var u,m,f,p,g,v,x;0==t||isNaN(t)?(l[c]=e,l[c+1]=s,l[c+2]=Math.atan2(r-s,a-e)):(x=s*(v=(m=(f=1-t)*f)*f)+r*(p=f*(g=3*(f=f*t)))+n*(g=g*t)+h*(u=(h=t*t)*t),l[c]=v=e*v+a*p+i*g+o*u,l[c+1]=x,d&&(l[c+2]=t<.001?Math.atan2(r-s,a-e):Math.atan2(x-(s*m+r*f*2+n*h),v-(e*m+a*f*2+i*h))))}},c=O,se=(c.NONE=-1,c.BEFORE=-2,c.AFTER=-3,c.epsilon=1e-5,class{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new fe,this.darkColor=t.darkColor?new fe:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(t instanceof D&&this.attachment instanceof D&&t.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}),ae=class{constructor(e,s){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new i,this.active=!1,!e)throw new Error("data cannot be null.");if(!s)throw new Error("skeleton cannot be null.");this.data=e,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY,this.mixScaleX=e.mixScaleX,this.mixScaleY=e.mixScaleY,this.mixShearY=e.mixShearY,this.bones=new Array;for(let t=0;t<e.bones.length;t++){var a=s.findBone(e.bones[t].name);if(!a)throw new Error(`Couldn't find bone ${e.bones[t].name}.`);this.bones.push(a)}var t=s.findBone(e.target.name);if(!t)throw new Error(`Couldn't find target bone ${e.target.name}.`);this.target=t}isActive(){return this.active}update(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleY&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){var s=this.mixRotate,a=this.mixX,r=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,h=0!=a||0!=r,l=this.target,c=l.a,d=l.b,u=l.c,m=l.d,t=0<c*m-d*u?W.degRad:-W.degRad,f=this.data.offsetRotation*t,p=this.data.offsetShearY*t,g=this.bones;for(let t=0,e=g.length;t<e;t++){var v=g[t];if(0!=s){var x=v.a,w=v.b,b=v.c,y=v.d;let t=Math.atan2(u,c)-Math.atan2(b,x)+f;t>W.PI?t-=W.PI2:t<-W.PI&&(t+=W.PI2),t*=s;var A=Math.cos(t),k=Math.sin(t);v.a=A*x-k*b,v.b=A*w-k*y,v.c=k*x+A*b,v.d=k*w+A*y}if(h&&(x=this.temp,l.localToWorld(x.set(this.data.offsetX,this.data.offsetY)),v.worldX+=(x.x-v.worldX)*a,v.worldY+=(x.y-v.worldY)*r),0!=i){let t=Math.sqrt(v.a*v.a+v.c*v.c);0!=t&&(t=(t+(Math.sqrt(c*c+u*u)-t+this.data.offsetScaleX)*i)/t),v.a*=t,v.c*=t}if(0!=n){let t=Math.sqrt(v.b*v.b+v.d*v.d);0!=t&&(t=(t+(Math.sqrt(d*d+m*m)-t+this.data.offsetScaleY)*n)/t),v.b*=t,v.d*=t}if(0<o){b=v.b,k=v.d,w=Math.atan2(k,b);let t=Math.atan2(m,d)-Math.atan2(u,c)-(w-Math.atan2(v.c,v.a));t>W.PI?t-=W.PI2:t<-W.PI&&(t+=W.PI2),t=w+(t+p)*o;A=Math.sqrt(b*b+k*k);v.b=Math.cos(t)*A,v.d=Math.sin(t)*A}v.updateAppliedTransform()}}applyRelativeWorld(){var s=this.mixRotate,a=this.mixX,r=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,h=0!=a||0!=r,l=this.target,c=l.a,d=l.b,u=l.c,m=l.d,t=0<c*m-d*u?W.degRad:-W.degRad,f=this.data.offsetRotation*t,p=this.data.offsetShearY*t,g=this.bones;for(let t=0,e=g.length;t<e;t++){var v=g[t];if(0!=s){var x=v.a,w=v.b,b=v.c,y=v.d;let t=Math.atan2(u,c)+f;t>W.PI?t-=W.PI2:t<-W.PI&&(t+=W.PI2),t*=s;var A=Math.cos(t),k=Math.sin(t);v.a=A*x-k*b,v.b=A*w-k*y,v.c=k*x+A*b,v.d=k*w+A*y}if(h&&(x=this.temp,l.localToWorld(x.set(this.data.offsetX,this.data.offsetY)),v.worldX+=x.x*a,v.worldY+=x.y*r),0!=i&&(b=(Math.sqrt(c*c+u*u)-1+this.data.offsetScaleX)*i+1,v.a*=b,v.c*=b),0!=n&&(k=(Math.sqrt(d*d+m*m)-1+this.data.offsetScaleY)*n+1,v.b*=k,v.d*=k),0<o){let t=Math.atan2(m,d)-Math.atan2(u,c);t>W.PI?t-=W.PI2:t<-W.PI&&(t+=W.PI2);w=v.b,A=v.d,y=(t=Math.atan2(A,w)+(t-W.PI/2+p)*o,Math.sqrt(w*w+A*A));v.b=Math.cos(t)*y,v.d=Math.sin(t)*y}v.updateAppliedTransform()}}applyAbsoluteLocal(){var i=this.mixRotate,n=this.mixX,o=this.mixY,h=this.mixScaleX,l=this.mixScaleY,c=this.mixShearY,d=this.target,u=this.bones;for(let r=0,t=u.length;r<t;r++){var m=u[r];let t=m.arotation;0!=i&&(p=d.arotation-t+this.data.offsetRotation,p-=360*(16384-(16384.499999999996-p/360|0)),t+=p*i);var f,p=m.ax,g=m.ay;p+=(d.ax-p+this.data.offsetX)*n,g+=(d.ay-g+this.data.offsetY)*o;let e=m.ascaleX,s=m.ascaleY,a=(0!=h&&0!=e&&(e=(e+(d.ascaleX-e+this.data.offsetScaleX)*h)/e),0!=l&&0!=s&&(s=(s+(d.ascaleY-s+this.data.offsetScaleY)*l)/s),m.ashearY);0!=c&&(f=d.ashearY-a+this.data.offsetShearY,f-=360*(16384-(16384.499999999996-f/360|0)),a+=f*c),m.updateWorldTransformWith(p,g,t,e,s,m.ashearX,a)}}applyRelativeLocal(){var s=this.mixRotate,a=this.mixX,r=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,h=this.target,l=this.bones;for(let t=0,e=l.length;t<e;t++){var c=l[t],d=c.arotation+(h.arotation+this.data.offsetRotation)*s,u=c.ax+(h.ax+this.data.offsetX)*a,m=c.ay+(h.ay+this.data.offsetY)*r,f=c.ascaleX*((h.ascaleX-1+this.data.offsetScaleX)*i+1),p=c.ascaleY*((h.ascaleY-1+this.data.offsetScaleY)*n+1),g=c.ashearY+(h.ashearY+this.data.offsetShearY)*o;c.updateWorldTransformWith(u,m,d,f,p,c.ashearX,g)}}},re=class{constructor(s){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this._scaleY=1,this.x=0,this.y=0,!s)throw new Error("data cannot be null.");this.data=s,this.bones=new Array;for(let e=0;e<s.bones.length;e++){var a,r=s.bones[e];let t;r.parent?(a=this.bones[r.parent.index],t=new Nt(r,this,a),a.children.push(t)):t=new Nt(r,this,null),this.bones.push(t)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<s.slots.length;t++){var e=s.slots[t],i=this.bones[e.boneData.index],e=new se(e,i);this.slots.push(e),this.drawOrder.push(e)}this.ikConstraints=new Array;for(let t=0;t<s.ikConstraints.length;t++){var n=s.ikConstraints[t];this.ikConstraints.push(new zt(n,this))}this.transformConstraints=new Array;for(let t=0;t<s.transformConstraints.length;t++){var o=s.transformConstraints[t];this.transformConstraints.push(new ae(o,this))}this.pathConstraints=new Array;for(let t=0;t<s.pathConstraints.length;t++){var h=s.pathConstraints[t];this.pathConstraints.push(new c(h,this))}this.color=new fe(1,1,1,1),this.updateCache()}get scaleY(){return re.yDown?-this._scaleY:this._scaleY}set scaleY(t){this._scaleY=t}updateCache(){this._updateCache.length=0;var s=this.bones;for(let t=0,e=s.length;t<e;t++){var a=s[t];a.sorted=a.data.skinRequired,a.active=!a.sorted}if(this.skin){var r=this.skin.bones;for(let e=0,t=this.skin.bones.length;e<t;e++){let t=this.bones[r[e].index];for(;t.sorted=!1,t.active=!0,t=t.parent;);}}var i=this.ikConstraints,n=this.transformConstraints,o=this.pathConstraints,h=i.length,l=n.length,c=o.length,t=h+l+c;t:for(let e=0;e<t;e++){for(let t=0;t<h;t++){var d=i[t];if(d.data.order==e){this.sortIkConstraint(d);continue t}}for(let t=0;t<l;t++){var u=n[t];if(u.data.order==e){this.sortTransformConstraint(u);continue t}}for(let t=0;t<c;t++){var m=o[t];if(m.data.order==e){this.sortPathConstraint(m);continue t}}}for(let t=0,e=s.length;t<e;t++)this.sortBone(s[t])}sortIkConstraint(t){var e,s;t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&pe.contains(this.skin.constraints,t.data,!0)),t.active&&(s=t.target,this.sortBone(s),e=(s=t.bones)[0],this.sortBone(e),1==s.length?(this._updateCache.push(t),this.sortReset(e.children)):(s=s[s.length-1],this.sortBone(s),this._updateCache.push(t),this.sortReset(e.children),s.sorted=!0))}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&pe.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target,s=e.data.index,a=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,s,a),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,a);for(let t=0,e=this.data.skins.length;t<e;t++)this.sortPathConstraintAttachment(this.data.skins[t],s,a);var e=e.getAttachment(),r=(e instanceof l&&this.sortPathConstraintAttachmentWith(e,a),t.bones),i=r.length;for(let t=0;t<i;t++)this.sortBone(r[t]);this._updateCache.push(t);for(let t=0;t<i;t++)this.sortReset(r[t].children);for(let t=0;t<i;t++)r[t].sorted=!0}}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&pe.contains(this.skin.constraints,t.data,!0)),t.active){this.sortBone(t.target);var e=t.bones,s=e.length;if(t.data.local)for(let t=0;t<s;t++){var a=e[t];this.sortBone(a.parent),this.sortBone(a)}else for(let t=0;t<s;t++)this.sortBone(e[t]);this._updateCache.push(t);for(let t=0;t<s;t++)this.sortReset(e[t].children);for(let t=0;t<s;t++)e[t].sorted=!0}}sortPathConstraintAttachment(t,e,s){var a=t.attachments[e];if(a)for(var r in a)this.sortPathConstraintAttachmentWith(a[r],s)}sortPathConstraintAttachmentWith(t,e){if(t instanceof l){var s=t.bones;if(s){var a=this.bones;for(let t=0,e=s.length;t<e;){var r=s[t++];for(r+=t;t<r;)this.sortBone(a[s[t++]])}}else this.sortBone(e)}}sortBone(t){var e;t&&!t.sorted&&((e=t.parent)&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t))}sortReset(s){for(let t=0,e=s.length;t<e;t++){var a=s[t];a.active&&(a.sorted&&this.sortReset(a.children),a.sorted=!1)}}updateWorldTransform(){var s=this.bones;for(let t=0,e=s.length;t<e;t++){var a=s[t];a.ax=a.x,a.ay=a.y,a.arotation=a.rotation,a.ascaleX=a.scaleX,a.ascaleY=a.scaleY,a.ashearX=a.shearX,a.ashearY=a.shearY}var r=this._updateCache;for(let t=0,e=r.length;t<e;t++)r[t].update()}updateWorldTransformWith(t){var s=this.getRootBone();if(!s)throw new Error("Root bone must not be null.");var e=t.a,a=t.b,r=t.c,i=t.d,t=(s.worldX=e*this.x+a*this.y+t.worldX,s.worldY=r*this.x+i*this.y+t.worldY,s.rotation+90+s.shearY),n=W.cosDeg(s.rotation+s.shearX)*s.scaleX,o=W.cosDeg(t)*s.scaleY,h=W.sinDeg(s.rotation+s.shearX)*s.scaleX,t=W.sinDeg(t)*s.scaleY,l=(s.a=(e*n+a*h)*this.scaleX,s.b=(e*o+a*t)*this.scaleX,s.c=(r*n+i*h)*this.scaleY,s.d=(r*o+i*t)*this.scaleY,this._updateCache);for(let t=0,e=l.length;t<e;t++){var c=l[t];c!=s&&c.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){var s=this.bones;for(let t=0,e=s.length;t<e;t++)s[t].setToSetupPose();var a=this.ikConstraints;for(let t=0,e=a.length;t<e;t++){var r=a[t];r.mix=r.data.mix,r.softness=r.data.softness,r.bendDirection=r.data.bendDirection,r.compress=r.data.compress,r.stretch=r.data.stretch}var i=this.transformConstraints;for(let t=0,e=i.length;t<e;t++){var n=i[t],o=n.data;n.mixRotate=o.mixRotate,n.mixX=o.mixX,n.mixY=o.mixY,n.mixScaleX=o.mixScaleX,n.mixScaleY=o.mixScaleY,n.mixShearY=o.mixShearY}var h=this.pathConstraints;for(let t=0,e=h.length;t<e;t++){var l=h[t],c=l.data;l.position=c.position,l.spacing=c.spacing,l.mixRotate=c.mixRotate,l.mixX=c.mixX,l.mixY=c.mixY}}setSlotsToSetupPose(){var s=this.slots;pe.arrayCopy(s,0,this.drawOrder,0,s.length);for(let t=0,e=s.length;t<e;t++)s[t].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(s){if(!s)throw new Error("boneName cannot be null.");var a=this.bones;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.data.name==s)return r}return null}findSlot(s){if(!s)throw new Error("slotName cannot be null.");var a=this.slots;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.data.name==s)return r}return null}setSkinByName(t){var e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)}setSkin(s){if(s!=this.skin){if(s)if(this.skin)s.attachAll(this,this.skin);else{var a=this.slots;for(let t=0,e=a.length;t<e;t++){var r=a[t],i=r.data.attachmentName;i&&(i=s.getAttachment(t,i))&&r.setAttachment(i)}}this.skin=s,this.updateCache()}}getAttachmentByName(t,e){var s=this.data.findSlot(t);if(s)return this.getAttachment(s.index,e);throw new Error("Can't find slot with name "+t)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){var s=this.skin.getAttachment(t,e);if(s)return s}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(s,a){if(!s)throw new Error("slotName cannot be null.");var r=this.slots;for(let e=0,t=r.length;e<t;e++){var i=r[e];if(i.data.name==s){let t=null;if(a&&!(t=this.getAttachment(e,a)))throw new Error("Attachment not found: "+a+", for slot: "+s);return void i.setAttachment(t)}}throw new Error("Slot not found: "+s)}findIkConstraint(s){if(!s)throw new Error("constraintName cannot be null.");var a=this.ikConstraints;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.data.name==s)return r}return null}findTransformConstraint(s){if(!s)throw new Error("constraintName cannot be null.");var a=this.transformConstraints;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.data.name==s)return r}return null}findPathConstraint(s){if(!s)throw new Error("constraintName cannot be null.");var a=this.pathConstraints;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.data.name==s)return r}return null}getBoundsRect(){var t=new i,e=new i;return this.getBounds(t,e),{x:t.x,y:t.y,width:e.x,height:e.y}}getBounds(t,e,a=new Array(2)){if(!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");var s=this.drawOrder;let r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let t=0,e=s.length;t<e;t++){var h=s[t];if(h.bone.active){let t=0,s=null;var l=h.getAttachment();if(l instanceof f?(t=8,s=pe.setArraySize(a,t,0),l.computeWorldVertices(h,s,0,2)):l instanceof m&&(l=l,t=l.worldVerticesLength,s=pe.setArraySize(a,t,0),l.computeWorldVertices(h,0,t,s,0,2)),s)for(let t=0,e=s.length;t<e;t+=2){var c=s[t],d=s[t+1];r=Math.min(r,c),i=Math.min(i,d),n=Math.max(n,c),o=Math.max(o,d)}}}t.set(r,i),e.set(n-r,o-i)}},ie=re,ne=(ie.yDown=!1,class{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(s){if(!s)throw new Error("boneName cannot be null.");var a=this.bones;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.name==s)return r}return null}findSlot(s){if(!s)throw new Error("slotName cannot be null.");var a=this.slots;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.name==s)return r}return null}findSkin(s){if(!s)throw new Error("skinName cannot be null.");var a=this.skins;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.name==s)return r}return null}findEvent(s){if(!s)throw new Error("eventDataName cannot be null.");var a=this.events;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.name==s)return r}return null}findAnimation(s){if(!s)throw new Error("animationName cannot be null.");var a=this.animations;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.name==s)return r}return null}findIkConstraint(s){if(!s)throw new Error("constraintName cannot be null.");var a=this.ikConstraints;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.name==s)return r}return null}findTransformConstraint(s){if(!s)throw new Error("constraintName cannot be null.");var a=this.transformConstraints;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.name==s)return r}return null}findPathConstraint(s){if(!s)throw new Error("constraintName cannot be null.");var a=this.pathConstraints;for(let t=0,e=a.length;t<e;t++){var r=a[t];if(r.name==s)return r}return null}}),oe=class{constructor(t=0,e,s){this.slotIndex=t,this.name=e,this.attachment=s}},he=class{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,s){if(!s)throw new Error("attachment cannot be null.");var a=this.attachments;t>=a.length&&(a.length=t+1),a[t]||(a[t]={}),a[t][e]=s}addSkin(s){for(let t=0;t<s.bones.length;t++){var a=s.bones[t];let e=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==a){e=!0;break}e||this.bones.push(a)}for(let t=0;t<s.constraints.length;t++){var r=s.constraints[t];let e=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==r){e=!0;break}e||this.constraints.push(r)}var e=s.getAttachments();for(let t=0;t<e.length;t++){var i=e[t];this.setAttachment(i.slotIndex,i.name,i.attachment)}}copySkin(s){for(let t=0;t<s.bones.length;t++){var a=s.bones[t];let e=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==a){e=!0;break}e||this.bones.push(a)}for(let t=0;t<s.constraints.length;t++){var r=s.constraints[t];let e=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==r){e=!0;break}e||this.constraints.push(r)}var e=s.getAttachments();for(let t=0;t<e.length;t++){var i=e[t];i.attachment&&(i.attachment instanceof m?i.attachment=i.attachment.newLinkedMesh():i.attachment=i.attachment.copy(),this.setAttachment(i.slotIndex,i.name,i.attachment))}}getAttachment(t,e){t=this.attachments[t];return t?t[e]:null}removeAttachment(t,e){t=this.attachments[t];t&&delete t[e]}getAttachments(){for(var t=new Array,e=0;e<this.attachments.length;e++){var s=this.attachments[e];if(s)for(var a in s){var r=s[a];r&&t.push(new oe(e,a,r))}}return t}getAttachmentsForSlot(t,e){var s=this.attachments[t];if(s)for(var a in s){var r=s[a];r&&e.push(new oe(t,a,r))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(e,s){let a=0;for(let t=0;t<e.slots.length;t++){var r=e.slots[t],i=r.getAttachment();if(i&&a<s.attachments.length){var n,o=s.attachments[a];for(n in o)if(i==o[n]){var h=this.getAttachment(a,n);h&&r.setAttachment(h);break}}a++}}},le=class{constructor(t,e,s){if(this.index=0,this.color=new fe(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=ce.Normal,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!s)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=s}},ce=(t=>(t[t.Normal=0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen",t))(ce||{}),de=class extends qt{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}},ue=class{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){var s=this.scale,a=new ne,r=(a.name="",new me(t)),t=r.readInt32(),e=r.readInt32(),i=(a.hash=0==e&&0==t?null:e.toString(16)+t.toString(16),a.version=r.readString(),a.x=r.readFloat(),a.y=r.readFloat(),a.width=r.readFloat(),a.height=r.readFloat(),r.readBoolean());i&&(a.fps=r.readFloat(),a.imagesPath=r.readString(),a.audioPath=r.readString());let n=0;n=r.readInt(!0);for(let t=0;t<n;t++){var o=r.readString();if(!o)throw new Error("String in string table must not be null.");r.strings.push(o)}n=r.readInt(!0);for(let t=0;t<n;t++){var h=r.readString();if(!h)throw new Error("Bone name must not be null.");var l=0==t?null:a.bones[r.readInt(!0)],h=new Vt(t,h,l);h.rotation=r.readFloat(),h.x=r.readFloat()*s,h.y=r.readFloat()*s,h.scaleX=r.readFloat(),h.scaleY=r.readFloat(),h.shearX=r.readFloat(),h.shearY=r.readFloat(),h.length=r.readFloat()*s,h.transformMode=r.readInt(!0),h.skinRequired=r.readBoolean(),i&&fe.rgba8888ToColor(h.color,r.readInt32()),a.bones.push(h)}n=r.readInt(!0);for(let t=0;t<n;t++){var c=r.readString();if(!c)throw new Error("Slot name must not be null.");var d=a.bones[r.readInt(!0)],c=new le(t,c,d),d=(fe.rgba8888ToColor(c.color,r.readInt32()),r.readInt32());-1!=d&&fe.rgb888ToColor(c.darkColor=new fe,d),c.attachmentName=r.readStringRef(),c.blendMode=r.readInt(!0),a.slots.push(c)}n=r.readInt(!0);for(let t=0,e;t<n;t++){var u=r.readString();if(!u)throw new Error("IK constraint data name must not be null.");var m=new $t(u);m.order=r.readInt(!0),m.skinRequired=r.readBoolean(),e=r.readInt(!0);for(let t=0;t<e;t++)m.bones.push(a.bones[r.readInt(!0)]);m.target=a.bones[r.readInt(!0)],m.mix=r.readFloat(),m.softness=r.readFloat()*s,m.bendDirection=r.readByte(),m.compress=r.readBoolean(),m.stretch=r.readBoolean(),m.uniform=r.readBoolean(),a.ikConstraints.push(m)}n=r.readInt(!0);for(let t=0,e;t<n;t++){var f=r.readString();if(!f)throw new Error("Transform constraint data name must not be null.");var p=new de(f);p.order=r.readInt(!0),p.skinRequired=r.readBoolean(),e=r.readInt(!0);for(let t=0;t<e;t++)p.bones.push(a.bones[r.readInt(!0)]);p.target=a.bones[r.readInt(!0)],p.local=r.readBoolean(),p.relative=r.readBoolean(),p.offsetRotation=r.readFloat(),p.offsetX=r.readFloat()*s,p.offsetY=r.readFloat()*s,p.offsetScaleX=r.readFloat(),p.offsetScaleY=r.readFloat(),p.offsetShearY=r.readFloat(),p.mixRotate=r.readFloat(),p.mixX=r.readFloat(),p.mixY=r.readFloat(),p.mixScaleX=r.readFloat(),p.mixScaleY=r.readFloat(),p.mixShearY=r.readFloat(),a.transformConstraints.push(p)}n=r.readInt(!0);for(let t=0,e;t<n;t++){var g=r.readString();if(!g)throw new Error("Path constraint data name must not be null.");var v=new jt(g);v.order=r.readInt(!0),v.skinRequired=r.readBoolean(),e=r.readInt(!0);for(let t=0;t<e;t++)v.bones.push(a.bones[r.readInt(!0)]);v.target=a.slots[r.readInt(!0)],v.positionMode=r.readInt(!0),v.spacingMode=r.readInt(!0),v.rotateMode=r.readInt(!0),v.offsetRotation=r.readFloat(),v.position=r.readFloat(),0==v.positionMode&&(v.position*=s),v.spacing=r.readFloat(),0!=v.spacingMode&&1!=v.spacingMode||(v.spacing*=s),v.mixRotate=r.readFloat(),v.mixX=r.readFloat(),v.mixY=r.readFloat(),a.pathConstraints.push(v)}e=this.readSkin(r,a,!0,i);e&&(a.defaultSkin=e,a.skins.push(e));{let t=a.skins.length;for(pe.setArraySize(a.skins,n=t+r.readInt(!0));t<n;t++){var x=this.readSkin(r,a,!1,i);if(!x)throw new Error("readSkin() should not have returned null.");a.skins[t]=x}}n=this.linkedMeshes.length;for(let t=0;t<n;t++){var w=this.linkedMeshes[t],b=w.skin?a.findSkin(w.skin):a.defaultSkin;if(!b)throw new Error("Not skin found for linked mesh.");if(!w.parent)throw new Error("Linked mesh parent must not be null");b=b.getAttachment(w.slotIndex,w.parent);if(!b)throw new Error("Parent mesh not found: "+w.parent);w.mesh.timelineAttachment=w.inheritTimeline?b:w.mesh,w.mesh.setParentMesh(b),null!=w.mesh.region&&w.mesh.updateRegion()}this.linkedMeshes.length=0,n=r.readInt(!0);for(let t=0;t<n;t++){var y=r.readStringRef();if(!y)throw new Error;y=new Wt(y);y.intValue=r.readInt(!1),y.floatValue=r.readFloat(),y.stringValue=r.readString(),y.audioPath=r.readString(),y.audioPath&&(y.volume=r.readFloat(),y.balance=r.readFloat()),a.events.push(y)}n=r.readInt(!0);for(let t=0;t<n;t++){var A=r.readString();if(!A)throw new Error("Animatio name must not be null.");a.animations.push(this.readAnimation(r,A,a))}return a}readSkin(s,a,t,r){let i=null,e=0;if(t){if(0==(e=s.readInt(!0)))return null;i=new he("default")}else{t=s.readStringRef();if(!t)throw new Error("Skin name must not be null.");(i=new he(t)).bones.length=s.readInt(!0);for(let t=0,e=i.bones.length;t<e;t++)i.bones[t]=a.bones[s.readInt(!0)];for(let t=0,e=s.readInt(!0);t<e;t++)i.constraints.push(a.ikConstraints[s.readInt(!0)]);for(let t=0,e=s.readInt(!0);t<e;t++)i.constraints.push(a.transformConstraints[s.readInt(!0)]);for(let t=0,e=s.readInt(!0);t<e;t++)i.constraints.push(a.pathConstraints[s.readInt(!0)]);e=s.readInt(!0)}for(let t=0;t<e;t++){var n=s.readInt(!0);for(let t=0,e=s.readInt(!0);t<e;t++){var o=s.readStringRef();if(!o)throw new Error("Attachment name must not be null");var h=this.readAttachment(s,a,i,n,o,r);h&&i.setAttachment(n,o,h)}}return i}readAttachment(r,t,i,a,e,n){var o=this.scale;let h=r.readStringRef();switch(h=h||e,r.readByte()){case w.Region:{let t=r.readStringRef();var l=r.readFloat(),c=r.readFloat(),d=r.readFloat(),u=r.readFloat(),m=r.readFloat(),f=r.readFloat(),p=r.readFloat(),g=r.readInt32(),v=this.readSequence(r),x=(t=t||h,this.attachmentLoader.newRegionAttachment(i,h,t,v));return x?(x.path=t,x.x=c*o,x.y=d*o,x.scaleX=u,x.scaleY=m,x.rotation=l,x.width=f*o,x.height=p*o,fe.rgba8888ToColor(x.color,g),null==(x.sequence=v)&&x.updateRegion(),x):null}case w.BoundingBox:c=r.readInt(!0),d=this.readVertices(r,c),u=n?r.readInt32():0,m=this.attachmentLoader.newBoundingBoxAttachment(i,h);return m?(m.worldVerticesLength=c<<1,m.vertices=d.vertices,m.bones=d.bones,n&&fe.rgba8888ToColor(m.color,u),m):null;case w.Mesh:{let t=r.readStringRef();l=r.readInt32(),f=r.readInt(!0),p=this.readFloatArray(r,f<<1,1),g=this.readShortArray(r),v=this.readVertices(r,f),x=r.readInt(!0),c=this.readSequence(r);let e=[],s=0,a=0;n&&(e=this.readShortArray(r),s=r.readFloat(),a=r.readFloat()),t=t||h;d=this.attachmentLoader.newMeshAttachment(i,h,t,c);return d?(d.path=t,fe.rgba8888ToColor(d.color,l),d.bones=v.bones,d.vertices=v.vertices,d.worldVerticesLength=f<<1,d.triangles=g,d.regionUVs=p,null==c&&d.updateRegion(),d.hullLength=x<<1,d.sequence=c,n&&(d.edges=e,d.width=s*o,d.height=a*o),d):null}case w.LinkedMesh:{let t=r.readStringRef();u=r.readInt32(),m=r.readStringRef(),l=r.readStringRef(),v=r.readBoolean(),f=this.readSequence(r);let e=0,s=0;n&&(e=r.readFloat(),s=r.readFloat()),t=t||h;g=this.attachmentLoader.newMeshAttachment(i,h,t,f);return g?(g.path=t,fe.rgba8888ToColor(g.color,u),g.sequence=f,n&&(g.width=e*o,g.height=s*o),this.linkedMeshes.push(new je(g,m,a,l,v)),g):null}case w.Path:var p=r.readBoolean(),x=r.readBoolean(),c=r.readInt(!0),d=this.readVertices(r,c),s=pe.newArray(c/3,0);for(let t=0,e=s.length;t<e;t++)s[t]=r.readFloat()*o;u=n?r.readInt32():0,f=this.attachmentLoader.newPathAttachment(i,h);return f?(f.closed=p,f.constantSpeed=x,f.worldVerticesLength=c<<1,f.vertices=d.vertices,f.bones=d.bones,f.lengths=s,n&&fe.rgba8888ToColor(f.color,u),f):null;case w.Point:m=r.readFloat(),l=r.readFloat(),v=r.readFloat(),g=n?r.readInt32():0,p=this.attachmentLoader.newPointAttachment(i,h);return p?(p.x=l*o,p.y=v*o,p.rotation=m,n&&fe.rgba8888ToColor(p.color,g),p):null;case w.Clipping:x=r.readInt(!0),c=r.readInt(!0),d=this.readVertices(r,c),u=n?r.readInt32():0,f=this.attachmentLoader.newClippingAttachment(i,h);return f?(f.endSlot=t.slots[x],f.worldVerticesLength=c<<1,f.vertices=d.vertices,f.bones=d.bones,n&&fe.rgba8888ToColor(f.color,u),f):null}return null}readSequence(t){var e;return t.readBoolean()?((e=new B(t.readInt(!0))).start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e):null}readVertices(e,s){var a=this.scale,t=s<<1,r=new He;if(e.readBoolean()){var i=new Array,n=new Array;for(let t=0;t<s;t++){var o=e.readInt(!0);n.push(o);for(let t=0;t<o;t++)n.push(e.readInt(!0)),i.push(e.readFloat()*a),i.push(e.readFloat()*a),i.push(e.readFloat())}r.vertices=pe.toFloatArray(i),r.bones=n}else r.vertices=this.readFloatArray(e,t,a);return r}readFloatArray(e,s,a){var r=new Array(s);if(1==a)for(let t=0;t<s;t++)r[t]=e.readFloat();else for(let t=0;t<s;t++)r[t]=e.readFloat()*a;return r}readShortArray(e){var s=e.readInt(!0),a=new Array(s);for(let t=0;t<s;t++)a[t]=e.readShort();return a}readAnimation(c,t,s){c.readInt(!0);var d=new Array,o=this.scale;new fe,new fe;for(let t=0,e=c.readInt(!0);t<e;t++){var u=c.readInt(!0);for(let t=0,e=c.readInt(!0);t<e;t++){var D=c.readByte(),m=c.readInt(!0),f=m-1;switch(D){case os:var V=new xe(m,u);for(let t=0;t<m;t++)V.setFrame(t,c.readFloat(),c.readStringRef());d.push(V);break;case hs:{var L=c.readInt(!0),h=new _e(m,L,u);let s=c.readFloat(),a=c.readUnsignedByte()/255,r=c.readUnsignedByte()/255,i=c.readUnsignedByte()/255,n=c.readUnsignedByte()/255;for(let t=0,e=0;h.setFrame(t,s,a,r,i,n),t!=f;t++){var l=c.readFloat(),N=c.readUnsignedByte()/255,q=c.readUnsignedByte()/255,O=c.readUnsignedByte()/255,U=c.readUnsignedByte()/255;switch(c.readByte()){case Kt:h.setStepped(t);break;case Qt:Jt(c,h,e++,t,0,s,l,a,N,1),Jt(c,h,e++,t,1,s,l,r,q,1),Jt(c,h,e++,t,2,s,l,i,O,1),Jt(c,h,e++,t,3,s,l,n,U,1)}s=l,a=N,r=q,i=O,n=U}d.push(h);break}case ls:{var L=c.readInt(!0),n=new Pe(m,L,u);let s=c.readFloat(),a=c.readUnsignedByte()/255,r=c.readUnsignedByte()/255,i=c.readUnsignedByte()/255;for(let t=0,e=0;n.setFrame(t,s,a,r,i),t!=f;t++){var p=c.readFloat(),W=c.readUnsignedByte()/255,z=c.readUnsignedByte()/255,$=c.readUnsignedByte()/255;switch(c.readByte()){case Kt:n.setStepped(t);break;case Qt:Jt(c,n,e++,t,0,s,p,a,W,1),Jt(c,n,e++,t,1,s,p,r,z,1),Jt(c,n,e++,t,2,s,p,i,$,1)}s=p,a=W,r=z,i=$}d.push(n);break}case cs:{var j=c.readInt(!0),g=new Ve(m,j,u);let s=c.readFloat(),a=c.readUnsignedByte()/255,r=c.readUnsignedByte()/255,i=c.readUnsignedByte()/255,n=c.readUnsignedByte()/255,o=c.readUnsignedByte()/255,h=c.readUnsignedByte()/255,l=c.readUnsignedByte()/255;for(let t=0,e=0;g.setFrame(t,s,a,r,i,n,o,h,l),t!=f;t++){var v=c.readFloat(),H=c.readUnsignedByte()/255,G=c.readUnsignedByte()/255,J=c.readUnsignedByte()/255,K=c.readUnsignedByte()/255,Q=c.readUnsignedByte()/255,Z=c.readUnsignedByte()/255,tt=c.readUnsignedByte()/255;switch(c.readByte()){case Kt:g.setStepped(t);break;case Qt:Jt(c,g,e++,t,0,s,v,a,H,1),Jt(c,g,e++,t,1,s,v,r,G,1),Jt(c,g,e++,t,2,s,v,i,J,1),Jt(c,g,e++,t,3,s,v,n,K,1),Jt(c,g,e++,t,4,s,v,o,Q,1),Jt(c,g,e++,t,5,s,v,h,Z,1),Jt(c,g,e++,t,6,s,v,l,tt,1)}s=v,a=H,r=G,i=J,n=K,o=Q,h=Z,l=tt}d.push(g);break}case ds:{var j=c.readInt(!0),x=new Le(m,j,u);let s=c.readFloat(),a=c.readUnsignedByte()/255,r=c.readUnsignedByte()/255,i=c.readUnsignedByte()/255,n=c.readUnsignedByte()/255,o=c.readUnsignedByte()/255,h=c.readUnsignedByte()/255;for(let t=0,e=0;x.setFrame(t,s,a,r,i,n,o,h),t!=f;t++){var w=c.readFloat(),et=c.readUnsignedByte()/255,st=c.readUnsignedByte()/255,at=c.readUnsignedByte()/255,rt=c.readUnsignedByte()/255,it=c.readUnsignedByte()/255,nt=c.readUnsignedByte()/255;switch(c.readByte()){case Kt:x.setStepped(t);break;case Qt:Jt(c,x,e++,t,0,s,w,a,et,1),Jt(c,x,e++,t,1,s,w,r,st,1),Jt(c,x,e++,t,2,s,w,i,at,1),Jt(c,x,e++,t,3,s,w,n,rt,1),Jt(c,x,e++,t,4,s,w,o,it,1),Jt(c,x,e++,t,5,s,w,h,nt,1)}s=w,a=et,r=st,i=at,n=rt,o=it,h=nt}d.push(x);break}case us:{var r=new De(m,c.readInt(!0),u);let s=c.readFloat(),a=c.readUnsignedByte()/255;for(let t=0,e=0;r.setFrame(t,s,a),t!=f;t++){var ot=c.readFloat(),ht=c.readUnsignedByte()/255;switch(c.readByte()){case Kt:r.setStepped(t);break;case Qt:Jt(c,r,e++,t,0,s,ot,a,ht,1)}s=ot,a=ht}d.push(r)}}}}for(let t=0,e=c.readInt(!0);t<e;t++){var a=c.readInt(!0);for(let t=0,e=c.readInt(!0);t<e;t++){var lt=c.readByte(),i=c.readInt(!0),b=c.readInt(!0);switch(lt){case Ke:d.push(Gt(c,new ve(i,b,a),1));break;case Qe:d.push(Ge(c,new Ce(i,b,a),o));break;case Ze:d.push(Gt(c,new Te(i,b,a),o));break;case ts:d.push(Gt(c,new Ye(i,b,a),o));break;case es:d.push(Ge(c,new Me(i,b,a),1));break;case ss:d.push(Gt(c,new Fe(i,b,a),1));break;case as:d.push(Gt(c,new Ee(i,b,a),1));break;case rs:d.push(Ge(c,new Xe(i,b,a),1));break;case is:d.push(Gt(c,new Re(i,b,a),1));break;case ns:d.push(Gt(c,new Be(i,b,a),1))}}}for(let t=0,e=c.readInt(!0);t<e;t++){var ct=c.readInt(!0),dt=c.readInt(!0),ut=dt-1,y=new qe(dt,c.readInt(!0),ct);let s=c.readFloat(),a=c.readFloat(),r=c.readFloat()*o;for(let t=0,e=0;y.setFrame(t,s,a,r,c.readByte(),c.readBoolean(),c.readBoolean()),t!=ut;t++){var A=c.readFloat(),mt=c.readFloat(),ft=c.readFloat()*o;switch(c.readByte()){case Kt:y.setStepped(t);break;case Qt:Jt(c,y,e++,t,0,s,A,a,mt,1),Jt(c,y,e++,t,1,s,A,r,ft,o)}s=A,a=mt,r=ft}d.push(y)}for(let t=0,e=c.readInt(!0);t<e;t++){var pt=c.readInt(!0),gt=c.readInt(!0),vt=gt-1,k=new Oe(gt,c.readInt(!0),pt);let s=c.readFloat(),a=c.readFloat(),r=c.readFloat(),i=c.readFloat(),n=c.readFloat(),o=c.readFloat(),h=c.readFloat();for(let t=0,e=0;k.setFrame(t,s,a,r,i,n,o,h),t!=vt;t++){var S=c.readFloat(),xt=c.readFloat(),wt=c.readFloat(),bt=c.readFloat(),yt=c.readFloat(),At=c.readFloat(),kt=c.readFloat();switch(c.readByte()){case Kt:k.setStepped(t);break;case Qt:Jt(c,k,e++,t,0,s,S,a,xt,1),Jt(c,k,e++,t,1,s,S,r,wt,1),Jt(c,k,e++,t,2,s,S,i,bt,1),Jt(c,k,e++,t,3,s,S,n,yt,1),Jt(c,k,e++,t,4,s,S,o,At,1),Jt(c,k,e++,t,5,s,S,h,kt,1)}s=S,a=xt,r=wt,i=bt,n=yt,o=At,h=kt}d.push(k)}for(let t=0,e=c.readInt(!0);t<e;t++){var I=c.readInt(!0),C=s.pathConstraints[I];for(let t=0,e=c.readInt(!0);t<e;t++)switch(c.readByte()){case ps:d.push(Gt(c,new Ue(c.readInt(!0),c.readInt(!0),I),0==C.positionMode?o:1));break;case gs:d.push(Gt(c,new We(c.readInt(!0),c.readInt(!0),I),0==C.spacingMode||1==C.spacingMode?o:1));break;case vs:var T=new ze(c.readInt(!0),c.readInt(!0),I);let a=c.readFloat(),r=c.readFloat(),i=c.readFloat(),n=c.readFloat();for(let t=0,e=0,s=T.getFrameCount()-1;T.setFrame(t,a,r,i,n),t!=s;t++){var Y=c.readFloat(),St=c.readFloat(),It=c.readFloat(),Ct=c.readFloat();switch(c.readByte()){case Kt:T.setStepped(t);break;case Qt:Jt(c,T,e++,t,0,a,Y,r,St,1),Jt(c,T,e++,t,1,a,Y,i,It,1),Jt(c,T,e++,t,2,a,Y,n,Ct,1)}a=Y,r=St,i=It,n=Ct}d.push(T)}}for(let t=0,e=c.readInt(!0);t<e;t++){var Tt=s.skins[c.readInt(!0)];for(let t=0,e=c.readInt(!0);t<e;t++){var M=c.readInt(!0);for(let t=0,e=c.readInt(!0);t<e;t++){var F=c.readStringRef();if(!F)throw new Error("attachmentName must not be null.");var Yt=Tt.getAttachment(M,F),F=c.readByte(),E=c.readInt(!0),Mt=E-1;switch(F){case ms:{var Ft=Yt,Et=Ft.bones,X=Ft.vertices,Xt=Et?X.length/3*2:X.length,Rt=c.readInt(!0),R=new Ne(E,Rt,M,Ft);let a=c.readFloat();for(let t=0,e=0;;t++){let s;var B=c.readInt(!0);if(0==B)s=Et?pe.newFloatArray(Xt):X;else{s=pe.newFloatArray(Xt);var Bt=c.readInt(!0);if(B+=Bt,1==o)for(let t=Bt;t<B;t++)s[t]=c.readFloat();else for(let t=Bt;t<B;t++)s[t]=c.readFloat()*o;if(!Et)for(let t=0,e=s.length;t<e;t++)s[t]+=X[t]}if(R.setFrame(t,a,s),t==Mt)break;var _t=c.readFloat();switch(c.readByte()){case Kt:R.setStepped(t);break;case Qt:Jt(c,R,e++,t,0,a,_t,0,1,1)}a=_t}d.push(R);break}case fs:var Pt=new ye(E,M,Yt);for(let t=0;t<E;t++){var Dt=c.readFloat(),Vt=c.readInt32();Pt.setFrame(t,Dt,Zt[15&Vt],Vt>>4,c.readFloat())}d.push(Pt)}}}}var Lt=c.readInt(!0);if(0<Lt){var Nt=new be(Lt),_=s.slots.length;for(let t=0;t<Lt;t++){var qt=c.readFloat(),Ot=c.readInt(!0),P=pe.newArray(_,0);for(let t=_-1;0<=t;t--)P[t]=-1;var Ut=pe.newArray(_-Ot,0);let e=0,s=0;for(let t=0;t<Ot;t++){for(var Wt=c.readInt(!0);e!=Wt;)Ut[s++]=e++;P[e+c.readInt(!0)]=e++}for(;e<_;)Ut[s++]=e++;for(let t=_-1;0<=t;t--)-1==P[t]&&(P[t]=Ut[--s]);Nt.setFrame(t,qt,P)}d.push(Nt)}var zt=c.readInt(!0);if(0<zt){var $t=new we(zt);for(let t=0;t<zt;t++){var e=c.readFloat(),jt=s.events[c.readInt(!0)],e=new $e(e,jt);e.intValue=c.readInt(!1),e.floatValue=c.readFloat(),e.stringValue=c.readBoolean()?c.readString():jt.stringValue,e.data.audioPath&&(e.volume=c.readFloat(),e.balance=c.readFloat()),$t.setFrame(t,e)}d.push($t)}let Ht=0;for(let t=0,e=d.length;t<e;t++)Ht=Math.max(Ht,d[t].getDuration());return new ge(t,d,Ht)}},me=class{constructor(t,e=new Array,s=0,a=new DataView(t.buffer)){this.strings=e,this.index=s,this.buffer=a}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){var t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){var t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){var e=this.readByte();let s=127&e;return 0!=(128&e)&&(e=this.readByte(),s|=(127&e)<<7,0!=(128&e))&&(e=this.readByte(),s|=(127&e)<<14,0!=(128&e))&&(e=this.readByte(),s|=(127&e)<<21,0!=(128&e))&&(e=this.readByte(),s|=(127&e)<<28),t?s:s>>>1^-(1&s)}readStringRef(){var t=this.readInt(!0);return 0==t?null:this.strings[t-1]}readString(){var e=this.readInt(!0);switch(e){case 0:return null;case 1:return""}e--;let s="";for(let t=0;t<e;){var a=this.readUnsignedByte();switch(a>>4){case 12:case 13:s+=String.fromCharCode((31&a)<<6|63&this.readByte()),t+=2;break;case 14:s+=String.fromCharCode((15&a)<<12|(63&this.readByte())<<6|63&this.readByte()),t+=3;break;default:s+=String.fromCharCode(a),t++}}return s}readFloat(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return 0!=this.readByte()}},je=class{constructor(t,e,s,a,r){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=a,this.inheritTimeline=r}},He=class{constructor(t=null,e=null){this.bones=t,this.vertices=e}},w=(t=>(t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping",t))(w||{});function Gt(a,r,i){let n=a.readFloat(),o=a.readFloat()*i;for(let t=0,e=0,s=r.getFrameCount()-1;r.setFrame(t,n,o),t!=s;t++){var h=a.readFloat(),l=a.readFloat()*i;switch(a.readByte()){case Kt:r.setStepped(t);break;case Qt:Jt(a,r,e++,t,0,n,h,o,l,i)}n=h,o=l}return r}function Ge(a,r,i){let n=a.readFloat(),o=a.readFloat()*i,h=a.readFloat()*i;for(let t=0,e=0,s=r.getFrameCount()-1;r.setFrame(t,n,o,h),t!=s;t++){var l=a.readFloat(),c=a.readFloat()*i,d=a.readFloat()*i;switch(a.readByte()){case Kt:r.setStepped(t);break;case Qt:Jt(a,r,e++,t,0,n,l,o,c,i),Jt(a,r,e++,t,1,n,l,h,d,i)}n=l,o=c,h=d}return r}function Jt(t,e,s,a,r,i,n,o,h,l){e.setBezier(s,a,r,i,o,t.readFloat(),t.readFloat()*l,t.readFloat(),t.readFloat()*l,n,h)}var Je,Ke=0,Qe=1,Ze=2,ts=3,es=4,ss=5,as=6,rs=7,is=8,ns=9,os=0,hs=1,ls=2,cs=3,ds=4,us=5,ms=0,fs=1,ps=0,gs=1,vs=2,Kt=1,Qt=2,xs=class{constructor(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new r(()=>pe.newFloatArray(16))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");var s=this.boundingBoxes,a=this.polygons,r=this.polygonPool,i=t.slots,n=i.length;s.length=0,r.freeAll(a);for(let t=a.length=0;t<n;t++){var o=i[t];if(o.bone.active){var h=o.getAttachment();if(h instanceof St){s.push(h);let t=r.obtain();t.length!=h.worldVerticesLength&&(t=pe.newFloatArray(h.worldVerticesLength)),a.push(t),h.computeWorldVertices(o,0,h.worldVerticesLength,t,0,2)}}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;var n=this.polygons;for(let t=0,e=n.length;t<e;t++){var o=n[t],h=o;for(let t=0,e=o.length;t<e;t+=2){var l=h[t],c=h[t+1];s=Math.min(s,l),a=Math.min(a,c),r=Math.max(r,l),i=Math.max(i,c)}}this.minX=s,this.minY=a,this.maxX=r,this.maxY=i}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,s,a){var r=this.minX,i=this.minY,n=this.maxX,o=this.maxY;return!(t<=r&&s<=r||e<=i&&a<=i||n<=t&&n<=s||o<=e&&o<=a)&&(i<(s=(a=(a-e)/(s-t))*(r-t)+e)&&s<o||i<(s=a*(n-t)+e)&&s<o||r<(s=(i-e)/a+t)&&s<n||r<(s=(o-e)/a+t)&&s<n)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(s,a){var r=this.polygons;for(let t=0,e=r.length;t<e;t++)if(this.containsPointPolygon(r[t],s,a))return this.boundingBoxes[t];return null}containsPointPolygon(t,e,s){var a=t,r=t.length;let i=r-2,n=!1;for(let t=0;t<r;t+=2){var o,h=a[t+1],l=a[i+1];(h<s&&s<=l||l<s&&s<=h)&&(o=a[t])+(s-h)/(l-h)*(a[i]-o)<e&&(n=!n),i=t}return n}intersectsSegment(s,a,r,i){var n=this.polygons;for(let t=0,e=n.length;t<e;t++)if(this.intersectsSegmentPolygon(n[t],s,a,r,i))return this.boundingBoxes[t];return null}intersectsSegmentPolygon(t,e,s,a,r){var i=t,n=t.length,o=e-a,h=s-r,l=e*r-s*a;let c=i[n-2],d=i[n-1];for(let t=0;t<n;t+=2){var u=i[t],m=i[t+1],f=c*m-d*u,p=c-u,g=d-m,v=o*g-h*p,p=(l*p-o*f)/v;if((p>=c&&p<=u||u<=p&&p<=c)&&(e<=p&&p<=a||a<=p&&p<=e)){p=(l*g-h*f)/v;if((p>=d&&p<=m||m<=p&&p<=d)&&(s<=p&&p<=r||r<=p&&p<=s))return!0}c=u,d=m}return!1}getPolygon(t){if(t)return-1==(t=this.boundingBoxes.indexOf(t))?null:this.polygons[t];throw new Error("boundingBox cannot be null.")}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}},P=class{constructor(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new r(()=>new Array),this.polygonIndicesPool=new r(()=>new Array)}triangulate(t){var a=t;let r=t.length>>1;var i=this.indicesArray;for(let t=i.length=0;t<r;t++)i[t]=t;var n=this.isConcaveArray;for(let t=n.length=0,e=r;t<e;++t)n[t]=P.isConcave(t,r,a,i);var o=this.triangles;for(o.length=0;3<r;){let e=r-1,t=0,s=1;for(;;){t:if(!n[t]){var h=i[e]<<1,l=i[t]<<1,c=i[s]<<1,d=a[h],u=a[1+h],m=a[l],f=a[1+l],p=a[c],g=a[1+c];for(let t=(s+1)%r;t!=e;t=(t+1)%r)if(n[t]){var v=i[t]<<1,x=a[v],v=a[1+v];if(P.positiveArea(p,g,d,u,x,v)&&P.positiveArea(d,u,m,f,x,v)&&P.positiveArea(m,f,p,g,x,v))break t}break}if(0==s){for(;n[t]&&0<--t;);break}e=t,s=((t=s)+1)%r}o.push(i[(r+t-1)%r]),o.push(i[t]),o.push(i[(t+1)%r]),i.splice(t,1),n.splice(t,1);var w=(--r+t-1)%r,b=t==r?0:t;n[w]=P.isConcave(w,r,a,i),n[b]=P.isConcave(b,r,a,i)}return 3==r&&(o.push(i[2]),o.push(i[0]),o.push(i[1])),o}decompose(t,s){var a=t,o=this.convexPolygons,h=(this.polygonPool.freeAll(o),o.length=0,this.convexPolygonsIndices);this.polygonIndicesPool.freeAll(h),h.length=0;let l=this.polygonIndicesPool.obtain(),c=(l.length=0,this.polygonPool.obtain()),r=-1,i=c.length=0;for(let e=0,t=s.length;e<t;e+=3){var n,d,u=s[e]<<1,m=s[e+1]<<1,f=s[e+2]<<1,p=a[u],g=a[1+u],v=a[m],x=a[1+m],w=a[f],b=a[1+f];let t=!1;r==u&&(n=c.length-4,n=P.winding(c[n],c[1+n],c[2+n],c[3+n],w,b),d=P.winding(w,b,c[0],c[1],c[2],c[3]),n==i)&&d==i&&(c.push(w),c.push(b),l.push(f),t=!0),t||(0<c.length?(o.push(c),h.push(l)):(this.polygonPool.free(c),this.polygonIndicesPool.free(l)),(c=this.polygonPool.obtain()).length=0,c.push(p),c.push(g),c.push(v),c.push(x),c.push(w),c.push(b),(l=this.polygonIndicesPool.obtain()).length=0,l.push(u),l.push(m),l.push(f),i=P.winding(p,g,v,x,w,b),r=u)}0<c.length&&(o.push(c),h.push(l));for(let i=0,n=o.length;i<n;i++)if(0!=(l=h[i]).length){var y=l[0],A=l[l.length-1],k=(c=o[i]).length-4;let e=c[k],s=c[1+k],a=c[2+k],r=c[3+k];var S,I,C,T,Y,M,F,E=c[0],X=c[1],R=c[2],B=c[3],_=P.winding(e,s,a,r,E,X);for(let t=0;t<n;t++)t!=i&&(3==(S=h[t]).length&&(M=S[0],F=S[1],I=S[2],T=(C=o[t])[C.length-2],Y=C[C.length-1],M==y)&&F==A&&(M=P.winding(e,s,a,r,T,Y),F=P.winding(T,Y,E,X,R,B),M==_)&&F==_)&&(C.length=0,S.length=0,c.push(T),c.push(Y),l.push(I),e=a,s=r,a=T,r=Y,t=0)}for(let t=o.length-1;0<=t;t--)0==(c=o[t]).length&&(o.splice(t,1),this.polygonPool.free(c),l=h[t],h.splice(t,1),this.polygonIndicesPool.free(l));return o}static isConcave(t,e,s,a){var r=a[(e+t-1)%e]<<1,i=a[t]<<1,a=a[(t+1)%e]<<1;return!this.positiveArea(s[r],s[1+r],s[i],s[1+i],s[a],s[1+a])}static positiveArea(t,e,s,a,r,i){return 0<=t*(i-a)+s*(e-i)+r*(a-e)}static winding(t,e,s,a,r,i){s-=t,a-=e;return 0<=r*a-i*s+s*e-t*a?1:-1}},ws=class{constructor(){this.triangulator=new P,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array,this.clipAttachment=null,this.clippingPolygons=null}clipStart(t,e){if(this.clipAttachment)return 0;var s=(this.clipAttachment=e).worldVerticesLength,a=pe.setArraySize(this.clippingPolygon,s),e=(e.computeWorldVertices(t,0,s,a,0,2),this.clippingPolygon),r=(ws.makeClockwise(e),this.clippingPolygons=this.triangulator.decompose(e,this.triangulator.triangulate(e)));for(let t=0,e=r.length;t<e;t++){var i=r[t];ws.makeClockwise(i),i.push(i[0]),i.push(i[1])}return r.length}clipEndWithSlot(t){this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(e,t,s,D,a,r,i,n){var o=this.clipOutput,h=this.clippedVertices,l=this.clippedTriangles,c=this.clippingPolygons,V=c.length,d=n?12:8;let u=0;h.length=0;t:for(let t=l.length=0;t<D;t+=3){var m=s[t]<<1,f=e[m],p=e[1+m],g=a[m],v=a[1+m],x=e[m=s[t+1]<<1],w=e[1+m],b=a[m],y=a[1+m],A=e[m=s[t+2]<<1],k=e[1+m],S=a[m],I=a[1+m];for(let t=0;t<V;t++){let e=h.length;if(!this.clip(f,p,x,w,A,k,c[t],o)){var C=pe.setArraySize(h,e+3*d),C=(C[e]=f,C[e+1]=p,C[e+2]=r.r,C[e+3]=r.g,C[e+4]=r.b,C[e+5]=r.a,n?(C[e+6]=g,C[e+7]=v,C[e+8]=i.r,C[e+9]=i.g,C[e+10]=i.b,C[e+11]=i.a,C[e+12]=x,C[e+13]=w,C[e+14]=r.r,C[e+15]=r.g,C[e+16]=r.b,C[e+17]=r.a,C[e+18]=b,C[e+19]=y,C[e+20]=i.r,C[e+21]=i.g,C[e+22]=i.b,C[e+23]=i.a,C[e+24]=A,C[e+25]=k,C[e+26]=r.r,C[e+27]=r.g,C[e+28]=r.b,C[e+29]=r.a,C[e+30]=S,C[e+31]=I,C[e+32]=i.r,C[e+33]=i.g,C[e+34]=i.b,C[e+35]=i.a):(C[e+6]=g,C[e+7]=v,C[e+8]=x,C[e+9]=w,C[e+10]=r.r,C[e+11]=r.g,C[e+12]=r.b,C[e+13]=r.a,C[e+14]=b,C[e+15]=y,C[e+16]=A,C[e+17]=k,C[e+18]=r.r,C[e+19]=r.g,C[e+20]=r.b,C[e+21]=r.a,C[e+22]=S,C[e+23]=I),e=l.length,pe.setArraySize(l,e+3));C[e]=u,C[e+1]=u+1,C[e+2]=u+2,u+=3;continue t}var T=o.length;if(0!=T){var Y=w-k,M=A-x,F=f-A,L=k-p,N=1/(Y*F+M*(p-k)),E=T>>1,q=this.clipOutput,X=pe.setArraySize(h,e+E*d);for(let t=0;t<T;t+=2){var R=q[t],B=q[t+1],R=(X[e]=R,X[e+1]=B,X[e+2]=r.r,X[e+3]=r.g,X[e+4]=r.b,X[e+5]=r.a,R-A),B=B-k,_=(Y*R+M*B)*N,R=(L*R+F*B)*N,B=1-_-R;X[e+6]=g*_+b*R+S*B,X[e+7]=v*_+y*R+I*B,n&&(X[e+8]=i.r,X[e+9]=i.g,X[e+10]=i.b,X[e+11]=i.a),e+=d}e=l.length;var P=pe.setArraySize(l,e+3*(E-2));E--;for(let t=1;t<E;t++)P[e]=u,P[e+1]=u+t,P[e+2]=u+t+1,e+=3;u+=1+E}}}}clip(t,e,s,a,r,i,n,o){var h=o;let l=!1,c;2<=n.length%4?(c=o,o=this.scratch):c=this.scratch,c.length=0,c.push(t),c.push(e),c.push(s),c.push(a),c.push(r),c.push(i),c.push(t),c.push(e),o.length=0;var d=n,u=n.length-4;for(let t=0;;t+=2){var m=d[t],f=d[t+1],p=d[t+2],g=d[t+3],v=m-p,x=f-g,w=c,b=c.length-2,y=o.length;for(let t=0;t<b;t+=2){var A=w[t],k=w[t+1],S=w[t+2],I=w[t+3],C=0<v*(I-g)-x*(S-p);if(0<v*(k-g)-x*(A-p)){if(C){o.push(S),o.push(I);continue}var T=I-k,Y=S-A,M=T*(p-m)-Y*(g-f);1e-6<Math.abs(M)?(o.push(m+(p-m)*(Y=(Y*(f-k)-T*(m-A))/M)),o.push(f+(g-f)*Y)):(o.push(m),o.push(f))}else C&&(Y=(T=I-k)*(p-m)-(M=S-A)*(g-f),1e-6<Math.abs(Y)?(o.push(m+(p-m)*(C=(M*(f-k)-T*(m-A))/Y)),o.push(f+(g-f)*C)):(o.push(m),o.push(f)),o.push(S),o.push(I));l=!0}if(y==o.length)return!(h.length=0);if(o.push(o[0]),o.push(o[1]),t==u)break;y=o;(o=c).length=0,c=y}if(h!=o)for(let t=h.length=0,e=o.length-2;t<e;t++)h[t]=o[t];else h.length=h.length-2;return l}static makeClockwise(a){var r=a,a=a.length;let s=r[a-2]*r[1]-r[0]*r[a-1],i,n,o,h;for(let t=0,e=a-3;t<e;t+=2)i=r[t],n=r[t+1],o=r[t+2],h=r[t+3],s+=i*h-o*n;if(!(s<0))for(let t=0,e=a-2,s=a>>1;t<s;t+=2){var l=r[t],c=r[t+1],d=e-t;r[t]=r[d],r[t+1]=r[1+d],r[d]=l,r[1+d]=c}}},bs=class{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){var s=this.scale,a=new ne,r="string"==typeof t?JSON.parse(t):t,t=r.skeleton;if(t&&(a.hash=t.hash,a.version=t.spine,a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height,a.fps=t.fps,a.imagesPath=t.images),r.bones)for(let e=0;e<r.bones.length;e++){var i=r.bones[e];let t=null;var n=Se(i,"parent",null),n=(n&&(t=a.findBone(n)),new Vt(a.bones.length,i.name,t)),i=(n.length=Se(i,"length",0)*s,n.x=Se(i,"x",0)*s,n.y=Se(i,"y",0)*s,n.rotation=Se(i,"rotation",0),n.scaleX=Se(i,"scaleX",1),n.scaleY=Se(i,"scaleY",1),n.shearX=Se(i,"shearX",0),n.shearY=Se(i,"shearY",0),n.transformMode=pe.enumValue(Lt,Se(i,"transform","Normal")),n.skinRequired=Se(i,"skin",!1),Se(i,"color",null));i&&n.color.setFromString(i),a.bones.push(n)}if(r.slots)for(let t=0;t<r.slots.length;t++){var e=r.slots[t],o=a.findBone(e.bone);if(!o)throw new Error(`Couldn't find bone ${e.bone} for slot `+e.name);var o=new le(a.slots.length,e.name,o),h=Se(e,"color",null),h=(h&&o.color.setFromString(h),Se(e,"dark",null));h&&(o.darkColor=fe.fromString(h)),o.attachmentName=Se(e,"attachment",null),o.blendMode=pe.enumValue(ce,Se(e,"blend","normal")),a.slots.push(o)}if(r.ik)for(let t=0;t<r.ik.length;t++){var l=r.ik[t],c=new $t(l.name);c.order=Se(l,"order",0),c.skinRequired=Se(l,"skin",!1);for(let t=0;t<l.bones.length;t++){var d=a.findBone(l.bones[t]);if(!d)throw new Error(`Couldn't find bone ${l.bones[t]} for IK constraint ${l.name}.`);c.bones.push(d)}var u=a.findBone(l.target);if(!u)throw new Error(`Couldn't find target bone ${l.target} for IK constraint ${l.name}.`);c.target=u,c.mix=Se(l,"mix",1),c.softness=Se(l,"softness",0)*s,c.bendDirection=Se(l,"bendPositive",!0)?1:-1,c.compress=Se(l,"compress",!1),c.stretch=Se(l,"stretch",!1),c.uniform=Se(l,"uniform",!1),a.ikConstraints.push(c)}if(r.transform)for(let t=0;t<r.transform.length;t++){var m=r.transform[t],f=new de(m.name);f.order=Se(m,"order",0),f.skinRequired=Se(m,"skin",!1);for(let t=0;t<m.bones.length;t++){var p=m.bones[t],g=a.findBone(p);if(!g)throw new Error(`Couldn't find bone ${p} for transform constraint ${m.name}.`);f.bones.push(g)}var v=m.target,x=a.findBone(v);if(!x)throw new Error(`Couldn't find target bone ${v} for transform constraint ${m.name}.`);f.target=x,f.local=Se(m,"local",!1),f.relative=Se(m,"relative",!1),f.offsetRotation=Se(m,"rotation",0),f.offsetX=Se(m,"x",0)*s,f.offsetY=Se(m,"y",0)*s,f.offsetScaleX=Se(m,"scaleX",0),f.offsetScaleY=Se(m,"scaleY",0),f.offsetShearY=Se(m,"shearY",0),f.mixRotate=Se(m,"mixRotate",1),f.mixX=Se(m,"mixX",1),f.mixY=Se(m,"mixY",f.mixX),f.mixScaleX=Se(m,"mixScaleX",1),f.mixScaleY=Se(m,"mixScaleY",f.mixScaleX),f.mixShearY=Se(m,"mixShearY",1),a.transformConstraints.push(f)}if(r.path)for(let t=0;t<r.path.length;t++){var w=r.path[t],b=new jt(w.name);b.order=Se(w,"order",0),b.skinRequired=Se(w,"skin",!1);for(let t=0;t<w.bones.length;t++){var y=w.bones[t],A=a.findBone(y);if(!A)throw new Error(`Couldn't find bone ${y} for path constraint ${w.name}.`);b.bones.push(A)}var k=w.target,S=a.findSlot(k);if(!S)throw new Error(`Couldn't find target slot ${k} for path constraint ${w.name}.`);b.target=S,b.positionMode=pe.enumValue(Ht,Se(w,"positionMode","Percent")),b.spacingMode=pe.enumValue(te,Se(w,"spacingMode","Length")),b.rotateMode=pe.enumValue(ee,Se(w,"rotateMode","Tangent")),b.offsetRotation=Se(w,"rotation",0),b.position=Se(w,"position",0),0==b.positionMode&&(b.position*=s),b.spacing=Se(w,"spacing",0),0!=b.spacingMode&&1!=b.spacingMode||(b.spacing*=s),b.mixRotate=Se(w,"mixRotate",1),b.mixX=Se(w,"mixX",1),b.mixY=Se(w,"mixY",b.mixX),a.pathConstraints.push(b)}if(r.skins)for(let t=0;t<r.skins.length;t++){var I,C=r.skins[t],T=new he(C.name);if(C.bones)for(let t=0;t<C.bones.length;t++){var Y=C.bones[t],M=a.findBone(Y);if(!M)throw new Error(`Couldn't find bone ${Y} for skin ${C.name}.`);T.bones.push(M)}if(C.ik)for(let t=0;t<C.ik.length;t++){var P=C.ik[t],D=a.findIkConstraint(P);if(!D)throw new Error(`Couldn't find IK constraint ${P} for skin ${C.name}.`);T.constraints.push(D)}if(C.transform)for(let t=0;t<C.transform.length;t++){var V=C.transform[t],L=a.findTransformConstraint(V);if(!L)throw new Error(`Couldn't find transform constraint ${V} for skin ${C.name}.`);T.constraints.push(L)}if(C.path)for(let t=0;t<C.path.length;t++){var N=C.path[t],q=a.findPathConstraint(N);if(!q)throw new Error(`Couldn't find path constraint ${N} for skin ${C.name}.`);T.constraints.push(q)}for(I in C.attachments){var F=a.findSlot(I);if(!F)throw new Error(`Couldn't find slot ${I} for skin ${C.name}.`);var E,O=C.attachments[I];for(E in O){var U=this.readAttachment(O[E],T,F.index,E,a);U&&T.setAttachment(F.index,E,U)}}a.skins.push(T),"default"==T.name&&(a.defaultSkin=T)}for(let t=0,e=this.linkedMeshes.length;t<e;t++){var X=this.linkedMeshes[t],R=X.skin?a.findSkin(X.skin):a.defaultSkin;if(!R)throw new Error("Skin not found: "+X.skin);R=R.getAttachment(X.slotIndex,X.parent);if(!R)throw new Error("Parent mesh not found: "+X.parent);X.mesh.timelineAttachment=X.inheritTimeline?R:X.mesh,X.mesh.setParentMesh(R),null!=X.mesh.region&&X.mesh.updateRegion()}if(this.linkedMeshes.length=0,r.events)for(var B in r.events){var _=r.events[B],B=new Wt(B);B.intValue=Se(_,"int",0),B.floatValue=Se(_,"float",0),B.stringValue=Se(_,"string",""),B.audioPath=Se(_,"audio",null),B.audioPath&&(B.volume=Se(_,"volume",1),B.balance=Se(_,"balance",0)),a.events.push(B)}if(r.animations)for(var W in r.animations){var z=r.animations[W];this.readAnimation(z,W,a)}return a}readAttachment(e,t,s,a,r){var i=this.scale;switch(a=Se(e,"name",a),Se(e,"type","region")){case"region":var n=Se(e,"path",a),o=this.readSequence(Se(e,"sequence",null)),h=this.attachmentLoader.newRegionAttachment(t,a,n,o);if(!h)return null;h.path=n,h.x=Se(e,"x",0)*i,h.y=Se(e,"y",0)*i,h.scaleX=Se(e,"scaleX",1),h.scaleY=Se(e,"scaleY",1),h.rotation=Se(e,"rotation",0),h.width=e.width*i,h.height=e.height*i,h.sequence=o;n=Se(e,"color",null);return n&&h.color.setFromString(n),null!=h.region&&h.updateRegion(),h;case"boundingbox":o=this.attachmentLoader.newBoundingBoxAttachment(t,a);if(!o)return null;this.readVertices(e,o,e.vertexCount<<1);n=Se(e,"color",null);return n&&o.color.setFromString(n),o;case"mesh":case"linkedmesh":h=Se(e,"path",a),n=this.readSequence(Se(e,"sequence",null)),o=this.attachmentLoader.newMeshAttachment(t,a,h,n);if(!o)return null;o.path=h;h=Se(e,"color",null),h=(h&&o.color.setFromString(h),o.width=Se(e,"width",0)*i,o.height=Se(e,"height",0)*i,o.sequence=n,Se(e,"parent",null));return h?this.linkedMeshes.push(new ys(o,Se(e,"skin",null),s,h,Se(e,"timelines",!0))):(n=e.uvs,this.readVertices(e,o,n.length),o.triangles=e.triangles,o.regionUVs=n,null!=o.region&&o.updateRegion(),o.edges=Se(e,"edges",null),o.hullLength=2*Se(e,"hull",0)),o;case"path":h=this.attachmentLoader.newPathAttachment(t,a);if(!h)return null;h.closed=Se(e,"closed",!1),h.constantSpeed=Se(e,"constantSpeed",!0);var n=e.vertexCount,l=(this.readVertices(e,h,n<<1),pe.newArray(n/3,0));for(let t=0;t<e.lengths.length;t++)l[t]=e.lengths[t]*i;h.lengths=l;o=Se(e,"color",null);return o&&h.color.setFromString(o),h;case"point":n=this.attachmentLoader.newPointAttachment(t,a);if(!n)return null;n.x=Se(e,"x",0)*i,n.y=Se(e,"y",0)*i,n.rotation=Se(e,"rotation",0);o=Se(e,"color",null);return o&&n.color.setFromString(o),n;case"clipping":h=this.attachmentLoader.newClippingAttachment(t,a);return h?((o=Se(e,"end",null))&&(h.endSlot=r.findSlot(o)),n=e.vertexCount,this.readVertices(e,h,n<<1),(o=Se(e,"color",null))&&h.color.setFromString(o),h):null}return null}readSequence(t){var e;return null==t?null:((e=new B(Se(t,"count",0))).start=Se(t,"start",1),e.digits=Se(t,"digits",0),e.setupIndex=Se(t,"setup",0),e)}readVertices(t,e,s){var a=this.scale,r=(e.worldVerticesLength=s,t.vertices);if(s==r.length){var i=pe.toFloatArray(r);if(1!=a)for(let t=0,e=r.length;t<e;t++)i[t]*=a;e.vertices=i}else{var n=new Array,o=new Array;for(let t=0,e=r.length;t<e;){var h=r[t++];o.push(h);for(var l=t+4*h;t<l;t+=4)o.push(r[t]),n.push(r[t+1]*a),n.push(r[t+2]*a),n.push(r[t+3])}e.bones=o,e.vertices=pe.toFloatArray(n)}}readAnimation(s,P,l){var o=this.scale,c=new Array;if(s.slots)for(var D in s.slots){var V=s.slots[D],L=l.findSlot(D);if(!L)throw new Error("Slot not found: "+D);var t,e=L.index;for(t in V){var n=V[t];if(n){var h=n.length;if("attachment"==t){var N=new xe(h,e);for(let t=0;t<h;t++){var q=n[t];N.setFrame(t,Se(q,"time",0),Se(q,"name",null))}c.push(N)}else if("rgba"==t){var i=new _e(h,h<<2,e);let s=n[0],a=Se(s,"time",0),r=fe.fromString(s.color);for(let t=0,e=0;;t++){i.setFrame(t,a,r.r,r.g,r.b,r.a);var O=n[t+1];if(!O){i.shrink(e);break}var d=Se(O,"time",0),u=fe.fromString(O.color),m=s.curve;m&&(e=ke(m,i,e,t,0,a,d,r.r,u.r,1),e=ke(m,i,e,t,1,a,d,r.g,u.g,1),e=ke(m,i,e,t,2,a,d,r.b,u.b,1),e=ke(m,i,e,t,3,a,d,r.a,u.a,1)),a=d,r=u,s=O}c.push(i)}else if("rgb"==t){var f=new Pe(h,3*h,e);let s=n[0],a=Se(s,"time",0),r=fe.fromString(s.color);for(let t=0,e=0;;t++){f.setFrame(t,a,r.r,r.g,r.b);var U=n[t+1];if(!U){f.shrink(e);break}var W=Se(U,"time",0),z=fe.fromString(U.color),$=s.curve;$&&(e=ke($,f,e,t,0,a,W,r.r,z.r,1),e=ke($,f,e,t,1,a,W,r.g,z.g,1),e=ke($,f,e,t,2,a,W,r.b,z.b,1)),a=W,r=z,s=U}c.push(f)}else if("alpha"==t)c.push(Ae(n,new De(h,h,e),0,1));else if("rgba2"==t){var p=new Ve(h,7*h,e);let s=n[0],a=Se(s,"time",0),r=fe.fromString(s.light),i=fe.fromString(s.dark);for(let t=0,e=0;;t++){p.setFrame(t,a,r.r,r.g,r.b,r.a,i.r,i.g,i.b);var g=n[t+1];if(!g){p.shrink(e);break}var v=Se(g,"time",0),j=fe.fromString(g.light),H=fe.fromString(g.dark),x=s.curve;x&&(e=ke(x,p,e,t,0,a,v,r.r,j.r,1),e=ke(x,p,e,t,1,a,v,r.g,j.g,1),e=ke(x,p,e,t,2,a,v,r.b,j.b,1),e=ke(x,p,e,t,3,a,v,r.a,j.a,1),e=ke(x,p,e,t,4,a,v,i.r,H.r,1),e=ke(x,p,e,t,5,a,v,i.g,H.g,1),e=ke(x,p,e,t,6,a,v,i.b,H.b,1)),a=v,r=j,i=H,s=g}c.push(p)}else if("rgb2"==t){var w=new Le(h,6*h,e);let s=n[0],a=Se(s,"time",0),r=fe.fromString(s.light),i=fe.fromString(s.dark);for(let t=0,e=0;;t++){w.setFrame(t,a,r.r,r.g,r.b,i.r,i.g,i.b);var G=n[t+1];if(!G){w.shrink(e);break}var b=Se(G,"time",0),J=fe.fromString(G.light),K=fe.fromString(G.dark),y=s.curve;y&&(e=ke(y,w,e,t,0,a,b,r.r,J.r,1),e=ke(y,w,e,t,1,a,b,r.g,J.g,1),e=ke(y,w,e,t,2,a,b,r.b,J.b,1),e=ke(y,w,e,t,3,a,b,i.r,K.r,1),e=ke(y,w,e,t,4,a,b,i.g,K.g,1),e=ke(y,w,e,t,5,a,b,i.b,K.b,1)),a=b,r=J,i=K,s=G}c.push(w)}}}}if(s.bones)for(var Q in s.bones){var Z=s.bones[Q],tt=l.findBone(Q);if(!tt)throw new Error("Bone not found: "+Q);var a,r=tt.index;for(a in Z){var et,st,at,rt,A=Z[a],k=A.length;0!=k&&("rotate"===a?c.push(Ae(A,new ve(k,k,r),0,1)):"translate"===a?(et=new Ce(k,k<<1,r),c.push(As(A,et,"x","y",0,o))):"translatex"===a?(et=new Te(k,k,r),c.push(Ae(A,et,0,o))):"translatey"===a?(st=new Ye(k,k,r),c.push(Ae(A,st,0,o))):"scale"===a?(st=new Me(k,k<<1,r),c.push(As(A,st,"x","y",1,1))):"scalex"===a?(at=new Fe(k,k,r),c.push(Ae(A,at,1,1))):"scaley"===a?(at=new Ee(k,k,r),c.push(Ae(A,at,1,1))):"shear"===a?(rt=new Xe(k,k<<1,r),c.push(As(A,rt,"x","y",0,1))):"shearx"===a?(rt=new Re(k,k,r),c.push(Ae(A,rt,0,1))):"sheary"===a&&(k=new Be(k,k,r),c.push(Ae(A,k,0,1))))}}if(s.ik)for(var it in s.ik){var nt=s.ik[it];let i=nt[0];if(i){var ot=l.findIkConstraint(it);if(!ot)throw new Error("IK Constraint not found: "+it);var it=l.ikConstraints.indexOf(ot),ht=new qe(nt.length,nt.length<<1,it);let s=Se(i,"time",0),a=Se(i,"mix",1),r=Se(i,"softness",0)*o;for(let t=0,e=0;;t++){ht.setFrame(t,s,a,r,Se(i,"bendPositive",!0)?1:-1,Se(i,"compress",!1),Se(i,"stretch",!1));var lt=nt[t+1];if(!lt){ht.shrink(e);break}var ct=Se(lt,"time",0),dt=Se(lt,"mix",1),ut=Se(lt,"softness",0)*o,mt=i.curve;mt&&(e=ke(mt,ht,e,t,0,s,ct,a,dt,1),e=ke(mt,ht,e,t,1,s,ct,r,ut,o)),s=ct,a=dt,r=ut,i=lt}c.push(ht)}}if(s.transform)for(var ft in s.transform){var pt=s.transform[ft];let h=pt[0];if(h){var gt=l.findTransformConstraint(ft);if(!gt)throw new Error("Transform constraint not found: "+ft);var ft=l.transformConstraints.indexOf(gt),S=new Oe(pt.length,6*pt.length,ft);let s=Se(h,"time",0),a=Se(h,"mixRotate",1),r=Se(h,"mixX",1),i=Se(h,"mixY",r),n=Se(h,"mixScaleX",1),o=Se(h,"mixScaleY",n);var vt=Se(h,"mixShearY",1);for(let t=0,e=0;;t++){S.setFrame(t,s,a,r,i,n,o,vt);var I=pt[t+1];if(!I){S.shrink(e);break}var C=Se(I,"time",0),xt=Se(I,"mixRotate",1),wt=Se(I,"mixX",1),bt=Se(I,"mixY",wt),yt=Se(I,"mixScaleX",1),At=Se(I,"mixScaleY",yt),kt=Se(I,"mixShearY",1),T=h.curve;T&&(e=ke(T,S,e,t,0,s,C,a,xt,1),e=ke(T,S,e,t,1,s,C,r,wt,1),e=ke(T,S,e,t,2,s,C,i,bt,1),e=ke(T,S,e,t,3,s,C,n,yt,1),e=ke(T,S,e,t,4,s,C,o,At,1),e=ke(T,S,e,t,5,s,C,vt,kt,1)),s=C,a=xt,r=wt,i=bt,n=yt,o=At,n=yt,h=I}c.push(S)}}if(s.path)for(var St in s.path){var It=s.path[St],Ct=l.findPathConstraint(St);if(!Ct)throw new Error("Path constraint not found: "+St);var Tt,Yt=l.pathConstraints.indexOf(Ct);for(Tt in It){var Mt=It[Tt];let n=Mt[0];if(n){var Y=Mt.length;if("position"===Tt){var Ft=new Ue(Y,Y,Yt);c.push(Ae(Mt,Ft,0,0==Ct.positionMode?o:1))}else if("spacing"===Tt){Ft=new We(Y,Y,Yt);c.push(Ae(Mt,Ft,0,0==Ct.spacingMode||1==Ct.spacingMode?o:1))}else if("mix"===Tt){var M=new ze(Y,3*Y,Yt);let s=Se(n,"time",0),a=Se(n,"mixRotate",1),r=Se(n,"mixX",1),i=Se(n,"mixY",r);for(let t=0,e=0;;t++){M.setFrame(t,s,a,r,i);var F=Mt[t+1];if(!F){M.shrink(e);break}var Et=Se(F,"time",0),Xt=Se(F,"mixRotate",1),Rt=Se(F,"mixX",1),Bt=Se(F,"mixY",Rt),_t=n.curve;_t&&(e=ke(_t,M,e,t,0,s,Et,a,Xt,1),e=ke(_t,M,e,t,1,s,Et,r,Rt,1),e=ke(_t,M,e,t,2,s,Et,i,Bt,1)),s=Et,a=Xt,r=Rt,i=Bt,n=F}c.push(M)}}}}if(s.attachments)for(var Pt in s.attachments){var Dt,Vt=s.attachments[Pt],Lt=l.findSkin(Pt);if(!Lt)throw new Error("Skin not found: "+Pt);for(Dt in Vt){var Nt=Vt[Dt],qt=l.findSlot(Dt);if(!qt)throw new Error("Slot not found: "+Dt);var Ot,Ut=qt.index;for(Ot in Nt){var Wt,zt=Nt[Ot],$t=Lt.getAttachment(Ut,Ot);for(Wt in zt){var E=zt[Wt];let r=E[0];if(r)if("deform"==Wt){var jt=$t.bones,Ht=$t.vertices,Gt=jt?Ht.length/3*2:Ht.length,Jt=new Ne(E.length,E.length,Ut,$t);let a=Se(r,"time",0);for(let t=0,e=0;;t++){let s;var X=Se(r,"vertices",null);if(X){s=pe.newFloatArray(Gt);var R=Se(r,"offset",0);if(pe.arrayCopy(X,0,s,R,X.length),1!=o)for(let t=R,e=t+X.length;t<e;t++)s[t]*=o;if(!jt)for(let t=0;t<Gt;t++)s[t]+=Ht[t]}else s=jt?pe.newFloatArray(Gt):Ht;Jt.setFrame(t,a,s);R=E[t+1];if(!R){Jt.shrink(e);break}var X=Se(R,"time",0),Kt=r.curve;Kt&&(e=ke(Kt,Jt,e,t,0,a,X,0,1,1)),a=X,r=R}c.push(Jt)}else if("sequence"==Wt){var Qt=new ye(E.length,Ut,$t);let e=0;for(let t=0;t<E.length;t++){var Zt=Se(r,"delay",e),te=Se(r,"time",0),ee=Ie[Se(r,"mode","hold")],se=Se(r,"index",0);Qt.setFrame(t,te,ee,se,Zt),e=Zt,r=E[t+1]}c.push(Qt)}}}}}if(s.drawOrder){var ae=new be(s.drawOrder.length),re=l.slots.length;let e=0;for(let t=0;t<s.drawOrder.length;t++,e++){var ie=s.drawOrder[t];let a=null;var ne=Se(ie,"offsets",null);if(ne){a=pe.newArray(re,-1);var oe=pe.newArray(re-ne.length,0);let e=0,s=0;for(let t=0;t<ne.length;t++){var he=ne[t],le=l.findSlot(he.slot);if(!le)throw new Error("Slot not found: "+le);for(var ce=le.index;e!=ce;)oe[s++]=e++;a[e+he.offset]=e++}for(;e<re;)oe[s++]=e++;for(let t=re-1;0<=t;t--)-1==a[t]&&(a[t]=oe[--s])}ae.setFrame(e,Se(ie,"time",0),a)}c.push(ae)}if(s.events){var de=new we(s.events.length);let e=0;for(let t=0;t<s.events.length;t++,e++){var B=s.events[t],ue=l.findEvent(B.name);if(!ue)throw new Error("Event not found: "+B.name);var _=new $e(pe.toSinglePrecision(Se(B,"time",0)),ue);_.intValue=Se(B,"int",ue.intValue),_.floatValue=Se(B,"float",ue.floatValue),_.stringValue=Se(B,"string",ue.stringValue),_.data.audioPath&&(_.volume=Se(B,"volume",1),_.balance=Se(B,"balance",0)),de.setFrame(e,_)}c.push(de)}let me=0;for(let t=0,e=c.length;t<e;t++)me=Math.max(me,c[t].getDuration());l.animations.push(new ge(P,c,me))}},ys=class{constructor(t,e,s,a,r){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=a,this.inheritTimeline=r}};function Ae(e,s,a,r){let i=e[0],n=Se(i,"time",0),o=Se(i,"value",a)*r,h=0;for(let t=0;;t++){s.setFrame(t,n,o);var l=e[t+1];if(!l)return s.shrink(h),s;var c=Se(l,"time",0),d=Se(l,"value",a)*r;i.curve&&(h=ke(i.curve,s,h,t,0,n,c,o,d,r)),n=c,o=d,i=l}}function As(e,s,a,r,i,n){let o=e[0],h=Se(o,"time",0),l=Se(o,a,i)*n,c=Se(o,r,i)*n,d=0;for(let t=0;;t++){s.setFrame(t,h,l,c);var u=e[t+1];if(!u)return s.shrink(d),s;var m=Se(u,"time",0),f=Se(u,a,i)*n,p=Se(u,r,i)*n,g=o.curve;g&&(d=ke(g,s,d,t,0,h,m,l,f,n),d=ke(g,s,d,t,1,h,m,c,p,n)),h=m,l=f,c=p,o=u}}function ke(t,e,s,a,r,i,n,o,h,l){var c,d,u,m;return"stepped"==t?(e.setStepped(a),s):(d=t[c=r<<2],u=t[1+c]*l,m=t[2+c],t=t[3+c]*l,e.setBezier(s,a,r,i,o,d,u,m,t,n,h),s+1)}function Se(t,e,s){return void 0!==t[e]?t[e]:s}void 0===Math.fround&&(Math.fround=(Je=new Float32Array(1),function(t){return Je[0]=t,Je[0]}));var tt=y,ks=g({},"__esModule",{value:!0}),h=tt,Ss=void 0,Is=void 0;if(h&&"object"==typeof h||"function"==typeof h)for(let t of x(h))b.call(ks,t)||t===Ss||g(ks,t,{get:()=>h[t],enumerable:!(Is=v(h,t))||Is.enumerable});return ks})();pc.extend(pc,function(){function i(t,e,s){var a=s&&s.lexicographical,s=s&&s.zeroExtend,r=t.split("."),i=e.split(".");function n(t){return(a?/^\d+[A-Za-z]*$/:/^\d+$/).test(t)}if(!r.every(n)||!i.every(n))return NaN;if(s){for(;r.length<i.length;)r.push("0");for(;i.length<r.length;)i.push("0")}a||(r=r.map(Number),i=i.map(Number));for(var o=0;o<r.length;++o){if(i.length===o)return 1;if(r[o]!==i[o])return r[o]>i[o]?1:-1}return r.length!==i.length?-1:0}function n(t){this._image={width:t.width,height:t.height},this.pcTexture=t}function t(t,e,s,a){this._app=t,this._position=new pc.Vec3;for(const r of(t=new spine.TextureAtlas(e)).pages)r.setTexture(new n(a[r.name]));e=new spine.AtlasAttachmentLoader(t),(t=new spine.SkeletonJson(e)).scale*=.01,e=t.readSkeletonData(s),this.skeletonVersion=e.version,this._spine_3_6_0=i(this.skeletonVersion,"3.6.0")<=0,this._spine_3_7_99=i(this.skeletonVersion,"3.7.99")<=0,this._spine_3_7_99=i(this.skeletonVersion,"4.1.23")<=0,this.skeleton=new spine.Skeleton(e),this.skeleton.updateWorldTransform(),this.stateData=new spine.AnimationStateData(this.skeleton.data),this.states=[new spine.AnimationState(this.stateData)],this.clipper=new spine.SkeletonClipping,this._node=new pc.GraphNode,this._meshes=[],this._meshInstances=[],this._materials={},this._tint={},this._aabb=new pc.BoundingBox,this._aabbTempArray=[],this._aabbTempOffset=new pc.Vec2,this._aabbTempSize=new pc.Vec2,this._renderCounts={vertexCount:0,indexCount:0},this._vertexFormat=null,this._vertexBuffer=null,this._indexBuffer=null,this._priority=0,this._timeScale=1,this._layers=[pc.LAYERID_UI],this.init(),this.autoUpdate=!0,this._hidden=!1}var o=0,h=1,l=2,s={9728:pc.FILTER_NEAREST,9729:pc.FILTER_LINEAR,9984:pc.FILTER_NEAREST_MIPMAP_NEAREST,9985:pc.FILTER_LINEAR_MIPMAP_NEAREST,9986:pc.FILTER_NEAREST_MIPMAP_LINEAR,9987:pc.FILTER_LINEAR_MIPMAP_LINEAR},a={33648:pc.ADDRESS_MIRRORED_REPEAT,33071:pc.ADDRESS_CLAMP_TO_EDGE,10487:pc.ADDRESS_REPEAT},c=[0,1,2,2,3,0];n.prototype={setFilters:function(t,e){this.pcTexture.minFilter=s[t],this.pcTexture.magFilter=s[e]},setWraps:function(t,e){this.pcTexture.addressU=a[t],this.pcTexture.addressV=a[e]},getImage:function(){return this._image},dispose:function(){this.pcTexture.destroy()}};return t.prototype.destroy=function(){this.removeFromLayers();for(var t=0;t<this._meshInstances.length;t++)this._meshInstances[t].mesh.vertexBuffer=null,this._meshInstances[t].mesh.indexBuffer.length=0,this._meshInstances[t].material=null;this._vertexBuffer&&(this._vertexBuffer.destroy(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer.destroy(),this._indexBuffer=null),this._meshInstances=[],this.skeleton=null,this.stateData=null,this._materials={},this._node=null},t.prototype.hide=function(){if(!this._hidden){for(var t=0,e=this._meshInstances.length;t<e;t++)this._meshInstances[t].visible=!1;this._hidden=!0}},t.prototype.show=function(){if(this._hidden){for(var t=0,e=this._meshInstances.length;t<e;t++)this._meshInstances[t].visible=!0;this._hidden=!1}},t.prototype.init=function(){this._vertexFormat=new pc.VertexFormat(this._app.graphicsDevice,[{semantic:pc.SEMANTIC_POSITION,components:2,type:pc.TYPE_FLOAT32},{semantic:pc.SEMANTIC_NORMAL,components:4,type:pc.TYPE_UINT8,normalize:!0},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.TYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.TYPE_UINT8,normalize:!0}]);for(var t=this.skeleton.drawOrder,e=0,s=t.length;e<s;e++)this.initSlot(t[e])},t.prototype.initSlot=function(t){t.positions=[],t.uvs=[],t.indices=[],t.vertexColor={},t._active={name:"",type:o},this.initAttachment(t)},t.prototype.createMaterial=function(t){var e=new pc.StandardMaterial;return e.shadingModel=pc.SPECULAR_BLINN,e.diffuse=new pc.Color(1,1,1),e.emissiveMap=t,e.emissiveMapChannel="rgb",e.emissiveVertexColor=!0,e.emissiveVertexColorChannel="rgb",e.opacityMap=t,e.opacityMapChannel="a",e.opacityVertexColor=!0,e.opacityVertexColorChannel="a",e.depthWrite=!1,e.cull=pc.CULLFACE_NONE,e.blendType=pc.BLEND_PREMULTIPLIED,this._spine_3_6_0&&(t=["gl_FragColor.rgb *= vVertexColor.a;","gl_FragColor.a = dAlpha;"].join("\n"),e.chunks.outputAlphaPremulPS=t),e.update(),e},t.prototype.initAttachment=function(t){var e,s=t.attachment;s&&(t._active.name=s.name,s instanceof spine.RegionAttachment?t._active.type=l:s instanceof spine.MeshAttachment&&(t._active.type=h),s.region)&&s.region.texture&&(s=s.region.texture.pcTexture)&&(s instanceof pc.StandardMaterial?(this._materials[s.name]=s,t.material=s.name):(e=null,s.name?e=s.name:s.getSource()instanceof Image&&(e=s.getSource().getAttribute("src")),e&&(void 0===this._materials[e]&&(s=this.createMaterial(s),this._materials[e]=s),t.material=e)))},t.prototype.updateSlot=function(t,e){var s=t.attachment,a=s.name,r=s instanceof spine.RegionAttachment?l:s instanceof spine.MeshAttachment?h:o,r=(t._active.name===a&&t._active.type===r||this.initAttachment(t),t.positions.length=0,s instanceof spine.RegionAttachment?s.computeWorldVertices(t,t.positions,0,2):s instanceof spine.MeshAttachment&&s.computeWorldVertices(t,0,s.worldVerticesLength,t.positions,0,2),this._tint[a]),a=(t.vertexColor={r:Math.round(255*t.color.r*(r?r.r:1)),g:Math.round(255*t.color.g*(r?r.g:1)),b:Math.round(255*t.color.b*(r?r.b:1)),a:Math.round(255*t.color.a*(r?r.a:1))},s.triangles||c);if(e.isClipping()){e.clipTriangles(t.positions,0,a,a.length,s.uvs,spine.Color.WHITE,spine.Color.WHITE,!1),t.positions.length=0,t.uvs.length=0;for(var i=e.clippedVertices.length,n=0;n<i;n+=8)t.positions.push(e.clippedVertices[n],e.clippedVertices[n+1]),t.uvs.push(e.clippedVertices[n+6],1-e.clippedVertices[n+7]);t.indices=e.clippedTriangles.slice()}else{for(t.uvs.length=0,i=t.positions.length,n=0;n<i;n+=2)t.uvs.push(s.uvs[n],1-s.uvs[n+1]);t.indices=a}this._renderCounts.vertexCount+=t.positions.length/2,this._renderCounts.indexCount+=t.indices.length},t.prototype.updateSkeleton=function(t){this._renderCounts.vertexCount=0,this._renderCounts.indexCount=0;for(var e=this.clipper,s=!1,s=!0,a=this.skeleton.drawOrder,r=a.length,i=0;i<r;i++){var n,o=a[i];this._spine_3_7_99||o.bone.active?s?(n=o.getAttachment())instanceof spine.ClippingAttachment?e.clipStart(o,n):n instanceof spine.RegionAttachment||n instanceof spine.MeshAttachment?this.updateSlot(o,e):this._spine_3_7_99||e.clipEndWithSlot(o):e.clipEndWithSlot(o):e.clipEndWithSlot(o)}},t.prototype.render=function(){if(this._meshInstances.forEach(function(t){t.material=null}),this.removeFromLayers(),this._meshes=[],(this._meshInstances.length=0)<this._renderCounts.indexCount&&0<this._renderCounts.vertexCount){this.skeleton.getBounds(this._aabbTempOffset,this._aabbTempSize,this._aabbTempArray),this._aabb.center=new pc.Vec3(this._aabbTempOffset.x,this._aabbTempOffset.y,0),this._aabb.halfExtents=new pc.Vec3(.5*this._aabbTempSize.x,.5*this._aabbTempSize.y,0),(!this._vertexBuffer||this._vertexBuffer.getNumVertices()<this._renderCounts.vertexCount)&&(this._vertexBuffer&&this._vertexBuffer.destroy(),this._vertexBuffer=new pc.VertexBuffer(this._app.graphicsDevice,this._vertexFormat,this._renderCounts.vertexCount)),(!this._indexBuffer||this._indexBuffer.getNumIndices()<this._renderCounts.indexCount)&&(this._indexBuffer&&this._indexBuffer.destroy(),this._indexBuffer=new pc.IndexBuffer(this._app.graphicsDevice,pc.INDEXFORMAT_UINT16,this._renderCounts.indexCount));for(var t=null,e=0,s=0,a=new pc.VertexIterator(this._vertexBuffer),r=new Uint16Array(this._indexBuffer.lock()),i=0,n=0,o=this.skeleton.drawOrder,h=o.length,l=0;l<h;l++){var c=o[l];if(c.attachment&&c.material&&0<c.positions.length&&0<c.indices.length){t&&t!==c.material&&(this.SubmitBatch(e,s,t),t=c.material,e=i,s=0);for(var t=c.material,d=c.positions,u=c.vertexColor.r,m=c.vertexColor.g,f=c.vertexColor.b,p=c.vertexColor.a,g=c.uvs,v=d.length/2,x=0;x<v;x++)a.element[pc.SEMANTIC_POSITION].set(d[2*x],d[2*x+1]),a.element[pc.SEMANTIC_NORMAL].set(0,255,0,0),a.element[pc.SEMANTIC_COLOR].set(u,m,f,p),a.element[pc.SEMANTIC_TEXCOORD0].set(g[2*x],1-g[2*x+1]),a.next();var w=c.indices,b=w.length;for(x=0;x<b;x++)r[i+x]=w[x]+n;s+=b,i+=b,n+=v}}a.end(),this._indexBuffer.unlock(),this.SubmitBatch(e,s,t)}this.addToLayers()},t.prototype.SubmitBatch=function(t,e,s){var a;0<e&&((a=new pc.Mesh(this._app.graphicsDevice)).vertexBuffer=this._vertexBuffer,a.indexBuffer[0]=this._indexBuffer,a.primitive[0].type=pc.PRIMITIVE_TRIANGLES,a.primitive[0].base=t,a.primitive[0].count=e,a.primitive[0].indexed=!0,a.aabb=this._aabb,this._meshes.push(a),(t=new pc.MeshInstance(this._node,a,this._materials[s])).drawOrder=this.priority+this._meshInstances.length,t.visible=!this._hidden,this._meshInstances.push(t))},t.prototype.update=function(t){if(!this._hidden){t*=this._timeScale;for(var e=this.states.length,s=0;s<e;s++)this.states[s].update(t);for(s=0;s<e;s++)this.states[s].apply(this.skeleton);this.autoUpdate&&this.skeleton.updateWorldTransform(),this.updateSkeleton(),this.render()}},t.prototype.setPosition=function(t){this._position.copy(t)},t.prototype.setTint=function(t,e){this._tint[t]=e},t.prototype.removeFromLayers=function(){if(this._meshInstances.length)for(var t=0;t<this._layers.length;t++){var e=this._app.scene.layers.getLayerById(this._layers[t]);e&&e.removeMeshInstances(this._meshInstances)}},t.prototype.addToLayers=function(){if(this._meshInstances.length)for(var t=0;t<this._layers.length;t++){var e=this._app.scene.layers.getLayerById(this._layers[t]);e&&e.addMeshInstances(this._meshInstances)}},Object.defineProperty(t.prototype,"state",{get:function(){return this.states[0]}}),Object.defineProperty(t.prototype,"priority",{get:function(){return this._priority},set:function(t){this._priority=t}}),Object.defineProperty(t.prototype,"timeScale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t}}),Object.defineProperty(t.prototype,"layers",{get:function(){return this._layers},set:function(t){this.removeFromLayers(),this._layers=t||[],this.addToLayers()}}),{Spine:t}}()),pc.extend(pc,function(){function t(t){pc.ComponentSystem.call(this,t),this.id="spine",this.ComponentType=pc.SpineComponent,this.DataType=pc.SpineComponentData,this.schema=["enabled","atlasAsset","textureAssets","skeletonAsset","atlasData","textures","skeletonData","speed","spine"],this.on("beforeremove",this.onBeforeRemove,this),this.app.systems.on("update",this.onUpdate,this)}return(t.prototype=Object.create(pc.ComponentSystem.prototype)).constructor=t,Object.assign(t.prototype,{initializeComponentData:function(t,e,s){pc.ComponentSystem.prototype.initializeComponentData.call(this.system,t,e,["enabled","atlasAsset","textureAssets","skeletonAsset","atlasData","textures","skeletonData","spine"])},onBeforeRemove:function(t,e){var s=t.spine.data;s.spine&&s.spine.destroy(),t.spine.removeComponent()},onUpdate:function(t){var e,s,a,r=this.store;for(e in r)r.hasOwnProperty(e)&&(a=(s=r[e]).data).enabled&&s.entity.enabled&&a.spine&&(a.spine.setPosition(s.entity.getPosition()),a.spine.update(a.speed*t))}}),{SpineComponentSystem:t}}()),pc.extend(pc,function(){function t(t,e){pc.Component.call(this,t,e),this.on("set_atlasAsset",this.onSetAsset,this),this.on("set_textureAssets",this.onSetAssets,this),this.on("set_skeletonAsset",this.onSetAsset,this),this.on("set_atlasData",this.onSetResource,this),this.on("set_textures",this.onSetResource,this),this.on("set_skeletonData",this.onSetResource,this)}return(t.prototype=Object.create(pc.Component.prototype)).constructor=t,Object.assign(t.prototype,{_createSpine:function(){this.data.spine&&(this.data.spine.destroy(),this.data.spine=null);for(var t={},e=0,s=this.textureAssets.length;e<s;e++){var a=this.system.app.assets.get(this.textureAssets[e]),r=a.name||(a.file?a.file.filename:null),i=(r=r||pc.path.getBasename(a.file.url)).indexOf("?");t[r=-1!==i?r.substring(0,i):r]=a.resource}this.data.spine=new pc.Spine(this.system.app,this.atlasData,this.skeletonData,t),this.state=this.data.spine.state,this.states=this.data.spine.states,this.skeleton=this.data.spine.skeleton,this.entity.addChild(this.data.spine._node)},_onAssetReady:function(t){"texture"===t.type&&this.textures.push(t.resource),"json"===t.type&&(this.skeletonData=t.resource),"text"===t.type&&(this.atlasData=t.resource)},_onAssetAdd:function(t){t.off("change",this.onAssetChanged,this),t.on("change",this.onAssetChanged,this),t.off("remove",this.onAssetRemoved,this),t.on("remove",this.onAssetRemoved,this),t.ready(this._onAssetReady,this),this.system.app.assets.load(t)},onSetResource:function(){this.data.atlasData&&this.data.textures.length&&this.data.skeletonData&&this._createSpine()},onSetAsset:function(t,e,s){var a=this.system.app.assets,r=null;e&&(r=a.get(e))&&(r.off("change",this.onAssetChanged),r.off("remove",this.onAssetRemoved)),s&&((e=s)instanceof pc.Asset&&(e=s.id,this.data[t]=e),(r=a.get(e))?this._onAssetAdd(r):a.on("add:"+e))},onSetAssets:function(t,e,s){var a=this.system.app.assets,r=null;if(e.length)for(n=0,o=e.length;n<o;n++)(r=a.get(e[n]))&&(r.off("change",this.onAssetChanged),r.off("remove",this.onAssetRemoved));if(s&&s.length)for(var i=s.map(function(t){return t instanceof pc.Asset?t.id:t}),n=0,o=s.length;n<o;n++)(r=a.get(i[n]))?this._onAssetAdd(r):a.on("add:"+i[n])},onAssetChanged:function(t,e,s,a){},onAssetRemoved:function(t){},onEnable:function(){pc.Component.prototype.onEnable.call(this);var t=this.data.spine;t&&t.addToLayers()},onDisable:function(){pc.Component.prototype.onDisable.call(this);var t=this.data.spine;t&&t.removeFromLayers()},hide:function(){this.data.spine&&this.data.spine.hide()},show:function(){this.data.spine&&this.data.spine.show()},removeComponent:function(){var t;if(this.atlasAsset&&(t=this.system.app.assets.get(this.atlasAsset))&&(t.off("change",this.onAssetChanged),t.off("remove",this.onAssetRemoved)),this.skeletonAsset&&(t=this.system.app.assets.get(this.skeletonAsset))&&(t.off("change",this.onAssetChanged),t.off("remove",this.onAssetRemoved)),this.textureAssets&&this.textureAssets.length)for(var e=0;e<this.textureAssets.length;e++)(t=this.system.app.assets.get(this.textureAssets[e]))&&(t.off("change",this.onAssetChanged),t.off("remove",this.onAssetRemoved))}}),{SpineComponent:t}}()),pc.extend(pc,{SpineComponentData:function(){this.enabled=!0,this.atlasAsset=null,this.textureAssets=[],this.skeletonAsset=null,this.speed=1,this.spine=null,this.atlasData=null,this.textures=[],this.skeletonData=null}}),function(){var t,e;pc.Application.registerPlugin?pc.Application.registerPlugin("spine",function(t){new pc.SpineComponentSystem(t)}):(t=pc.Application.getApplication(),e=new pc.SpineComponentSystem(t),t.systems.add(e))}();