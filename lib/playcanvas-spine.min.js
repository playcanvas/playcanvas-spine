/* Copyright 2015-2016 PlayCanvas Ltd */
var spine={radDeg:180/Math.PI,degRad:Math.PI/180,Float32Array:"undefined"==typeof Float32Array?Array:Float32Array,Uint32Array:"undefined"==typeof Uint32Array?Array:Uint32Array,Uint16Array:"undefined"==typeof Uint16Array?Array:Uint16Array};spine.temp=new spine.Float32Array(2),spine.BoneData=function(t,e){this.name=t,this.parent=e},spine.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0},spine.BlendMode={normal:0,additive:1,multiply:2,screen:3},spine.SlotData=function(t,e){this.name=t,this.boneData=e},spine.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,blendMode:spine.BlendMode.normal},spine.IkConstraintData=function(t){this.name=t,this.bones=[]},spine.IkConstraintData.prototype={target:null,bendDirection:1,mix:1},spine.TransformConstraintData=function(t){this.name=t},spine.TransformConstraintData.prototype={bone:null,target:null,translateMix:1,x:0,y:0},spine.Bone=function(t,e,n){this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()},spine.Bone.yDown=!1,spine.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,a:0,b:0,worldX:0,c:0,d:0,worldY:0,worldSignX:1,worldSignY:1,update:function(){this.updateWorldTransform(this.x,this.y,this.rotation,this.scaleX,this.scaleY)},updateWorldTransformWith:function(){this.updateWorldTransform(this.x,this.y,this.rotation,this.scaleX,this.scaleY)},updateWorldTransform:function(t,e,n,i,s){this.appliedRotation=n,this.appliedScaleX=i,this.appliedScaleY=s,n*=spine.degRad;var a,r=(m=Math.cos(n))*i,o=-(g=Math.sin(n))*s,h=g*i,l=m*s,p=this.parent;if(p){var u=p.a,d=p.b,f=p.c,c=p.d;if(this.worldX=u*t+d*e+p.worldX,this.worldY=f*t+c*e+p.worldY,this.worldSignX=p.worldSignX*(i<0?-1:1),this.worldSignY=p.worldSignY*(s<0?-1:1),this.data.inheritRotation&&this.data.inheritScale)this.a=u*r+d*h,this.b=u*o+d*l,this.c=f*r+c*h,this.d=f*o+c*l;else{if(this.data.inheritRotation){f=d=0,c=u=1;do{n=p.appliedRotation*spine.degRad;var m,g,v=u*(m=Math.cos(n))+d*(g=Math.sin(n)),d=u*-g+d*m,u=v}while((v=f*m+c*g,c=f*-g+c*m,f=v,p.data.inheritRotation)&&(p=p.parent));this.a=u*r+d*h,this.b=u*o+d*l,this.c=f*r+c*h,this.d=f*o+c*l}else if(this.data.inheritScale){f=d=0,c=u=1;do{n=p.appliedRotation*spine.degRad,m=Math.cos(n),g=Math.sin(n);var y=p.appliedScaleX,w=p.appliedScaleY,A=m*y,x=-g*w,b=g*y,w=m*w,v=u*A+d*b}while((d=u*x+d*w,u=v,v=f*A+c*b,c=f*x+c*w,f=v,y<0&&(n=-n),v=u*(m=Math.cos(-n))+d*(g=Math.sin(-n)),d=u*-g+d*m,u=v,v=f*m+c*g,c=f*-g+c*m,f=v,p.data.inheritScale)&&(p=p.parent));this.a=u*r+d*h,this.b=u*o+d*l,this.c=f*r+c*h,this.d=f*o+c*l}else this.a=r,this.b=o,this.c=h,this.d=l;this.skeleton.flipX&&(this.a=-this.a,this.b=-this.b),this.skeleton.flipY!=spine.Bone.yDown&&(this.c=-this.c,this.d=-this.d)}}else(a=this.skeleton).flipX&&(t=-t,r=-r,o=-o),a.flipY!=spine.Bone.yDown&&(e=-e,h=-h,l=-l),this.a=r,this.b=o,this.c=h,this.d=l,this.worldX=t,this.worldY=e,this.worldSignX=i<0?-1:1,this.worldSignY=s<0?-1:1},setToSetupPose:function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY},getWorldRotationX:function(){return Math.atan2(this.c,this.a)*spine.radDeg},getWorldRotationY:function(){return Math.atan2(this.d,this.b)*spine.radDeg},getWorldScaleX:function(){return Math.sqrt(this.a*this.a+this.b*this.b)*this.worldSignX},getWorldScaleY:function(){return Math.sqrt(this.c*this.c+this.d*this.d)*this.worldSignY},worldToLocal:function(t){var e=t[0]-this.worldX,n=t[1]-this.worldY,i=this.a,s=this.b,a=this.c,r=this.d,o=1/(i*r-s*a);return t[0]=e*r*o-n*s*o,t[1]=n*i*o-e*a*o,t},localToWorld:function(t){var e=t[0],n=t[1];return t[0]=e*this.a+n*this.b+this.worldX,t[1]=e*this.c+n*this.d+this.worldY,t}},spine.Slot=function(t,e){this.data=t,this.bone=e,this.attachmentVertices=new spine.Float32Array,this.setToSetupPose()},spine.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(t){this.attachment!=t&&(this.attachment=t,this._attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},setAttachmentTime:function(t){this._attachmentTime=this.bone.skeleton.time-t},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var t=this.data;if(this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,t.attachmentName){for(var e=this.bone.skeleton.data.slots,n=0,i=e.length;n<i;n++)if(e[n]==t){this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachmentBySlotIndex(n,t.attachmentName));break}}else this.setAttachment(null)}},spine.IkConstraint=function(t,e){this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.bones=[];for(var n=0,i=t.bones.length;n<i;n++)this.bones[n]=e.findBone(t.bones[n].name);this.target=e.findBone(t.target.name)},spine.IkConstraint.prototype={apply:function(){this.update()},update:function(){var t=this.target,e=this.bones;switch(e.length){case 1:spine.IkConstraint.apply1(e[0],t.worldX,t.worldY,this.mix);break;case 2:spine.IkConstraint.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.mix)}}},spine.IkConstraint.apply1=function(t,e,n,i){var s=t.parent?t.parent.getWorldRotationX():0,a=t.rotation,n=Math.atan2(n-t.worldY,e-t.worldX)*spine.radDeg-s;180<(n=t.worldSignX!=t.worldSignY!=(t.skeleton.flipX!=(t.skeleton.flipY!=spine.Bone.yDown))?360-n:n)?n-=360:n<-180&&(n+=360),t.updateWorldTransform(t.x,t.y,a+(n-a)*i,t.appliedScaleX,t.appliedScaleY)},spine.IkConstraint.apply2=function(t,e,P,U,n,i){if(0!=i){var R,B,s,a,r,o,h=t.x,l=t.y,p=t.appliedScaleX,u=t.appliedScaleY,d=p<0?(p=-p,R=180,-1):(R=0,1),f=(u<0&&(u=-u,d=-d),e.x),c=e.y,m=e.appliedScaleX,W=Math.abs(p-u)<=1e-4,g=(W||0==c||(e.worldX=t.a*f+t.worldX,e.worldY=t.c*f+t.worldY,c=0),B=m<0?(m=-m,180):0,t.parent),v=(g=g?(A=g.a,S=g.b,V=g.c,Y=1/(A*(b=g.d)-S*V),s=((D=P-(r=g.worldX))*b-(O=U-(g=g.worldY))*S)*Y-h,a=(O*A-D*V)*Y-l,r=((D=e.worldX-r)*b-(O=e.worldY-g)*S)*Y-h,(O*A-D*V)*Y-l):(s=P-h,a=U-l,r=e.worldX-h,e.worldY-l),Math.sqrt(r*r+g*g)),y=e.data.length*m;t:if(W)var w=(s*s+a*a-v*v-(y*=p)*y)/(2*v*y),A=(w<-1?w=-1:1<w&&(w=1),o=Math.acos(w)*n,v+y*w),w=y*Math.sin(o),x=Math.atan2(a*A-s*w,s*A+a*w);else{var b,A=p*y,S=u*y,E=Math.atan2(a,s),k=A*A,C=S*S,T=s*s+a*a,w=C*(v*v)+k*T-k*C,M=-2*C*v,I=C-k;if(0<=(b=M*M-4*I*w)){var _=Math.sqrt(b),M=(_=-(M+(_=M<0?-_:_))/2)/I,I=w/_,w=Math.abs(M)<Math.abs(I)?M:I;if(w*w<=T){var O=Math.sqrt(T-w*w)*n;x=E-Math.atan2(O,w),o=Math.atan2(O/u,(w-v)/p);break t}}var D,_=0,M=Number.MAX_VALUE,I=0,w=0,L=0,X=0,N=0,H=0,F=(D=v+A)*D,k=(X<F&&(L=0,X=F,N=D),(F=(D=v-A)*D)<M&&(_=Math.PI,M=F,I=D),Math.acos(-A*v/(k-C))),O=(D=A*Math.cos(k)+v,S*Math.sin(k));(F=D*D+O*O)<M&&(_=k,M=F,I=D,w=O),X<F&&(L=k,X=F,N=D,H=O),o=T<=(M+X)/2?(x=E-Math.atan2(w*n,I),_*n):(x=E-Math.atan2(H*n,N),L*n)}var V=Math.atan2(c,f)*d,Y=(180<(x=(x-V)*spine.radDeg+R)?x-=360:x<-180&&(x+=360),180<(o=(o+V)*spine.radDeg*d+B)?o-=360:o<-180&&(o+=360),t.rotation);t.updateWorldTransform(h,l,Y+(x-Y)*i,t.appliedScaleX,t.appliedScaleY),Y=e.rotation,e.updateWorldTransform(f,c,Y+(o-Y)*i,e.appliedScaleX,e.appliedScaleY)}},spine.TransformConstraint=function(t,e){this.data=t,this.translateMix=t.translateMix,this.x=t.x,this.y=t.y,this.bone=e.findBone(t.bone.name),this.target=e.findBone(t.target.name)},spine.TransformConstraint.prototype={apply:function(){this.update()},update:function(){var t,e,n=this.translateMix;0<n&&((t=spine.temp)[0]=x,t[1]=y,this.target.localToWorld(t),(e=this.bone).worldX+=(t[0]-e.worldX)*n,e.worldY+=(t[1]-e.worldY)*n)}},spine.Skin=function(t){this.name=t,this.attachments={}},spine.Skin.prototype={addAttachment:function(t,e,n){this.attachments[t+":"+e]=n},getAttachment:function(t,e){return this.attachments[t+":"+e]},_attachAll:function(t,e){for(var n in e.attachments){var i=n.indexOf(":"),s=parseInt(n.substring(0,i)),n=n.substring(i+1),i=t.slots[s];i.attachment&&i.attachment.name==n&&(s=this.getAttachment(s,n))&&i.setAttachment(s)}}},spine.Animation=function(t,e,n){this.name=t,this.timelines=e,this.duration=n},spine.Animation.prototype={apply:function(t,e,n,i,s){i&&0!=this.duration&&(n%=this.duration,0<e)&&(e%=this.duration);for(var a=this.timelines,r=0,o=a.length;r<o;r++)a[r].apply(t,e,n,s,1)},mix:function(t,e,n,i,s,a){i&&0!=this.duration&&(n%=this.duration,0<e)&&(e%=this.duration);for(var r=this.timelines,o=0,h=r.length;o<h;o++)r[o].apply(t,e,n,s,a)}},spine.Animation.binarySearch=function(t,e,n){var i=0,s=Math.floor(t.length/n)-2;if(!s)return n;for(var a=s>>>1;;){if(t[(a+1)*n]<=e?i=a+1:s=a,i==s)return(i+1)*n;a=i+s>>>1}},spine.Animation.binarySearch1=function(t,e){var n=0,i=t.length-2;if(!i)return 1;for(var s=i>>>1;;){if(t[s+1]<=e?n=s+1:i=s,n==i)return n+1;s=n+i>>>1}},spine.Animation.linearSearch=function(t,e,n){for(var i=0,s=t.length-n;i<=s;i+=n)if(t[i]>e)return i;return-1},spine.Curves=function(t){t=19*(t-1);this.curves=new spine.Float32Array(t),this.curves.length=t},spine.Curves.prototype={setLinear:function(t){this.curves[19*t]=0},setStepped:function(t){this.curves[19*t]=1},setCurve:function(t,e,n,i,s){for(var a=.1*.1*.1,r=6*a,o=2*-e+i,h=2*-n+s,i=3*(e-i)+1,s=3*(n-s)+1,l=e*(3*.1)+o*(.1*.1*3)+i*a,p=n*(3*.1)+h*(.1*.1*3)+s*a,u=o*(.1*.1*6)+i*r,d=h*(.1*.1*6)+s*r,f=i*r,c=s*r,m=19*t,g=this.curves,v=(g[m++]=2,l),y=p,w=m+19-1;m<w;m+=2)g[m]=v,g[m+1]=y,l+=u,p+=d,u+=f,d+=c,v+=l,y+=p},getCurvePercent:function(t,e){e=e<0?0:1<e?1:e;var n=this.curves,i=19*t,t=n[i];if(0===t)return e;if(1==t)return 0;for(var s,a,r=0,o=++i,h=i+19-1;i<h;i+=2)if(e<=(r=n[i]))return(a=i==o?s=0:(s=n[i-2],n[i-1]))+(n[i+1]-a)*(e-s)/(r-s);t=n[i-1];return t+(1-t)*(e-r)/(1-r)}},spine.RotateTimeline=function(t){this.curves=new spine.Curves(t),this.frames=new spine.Float32Array(2*t),this.frames.length=2*t},spine.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,n){this.frames[t*=2]=e,this.frames[t+1]=n},apply:function(t,e,n,i,s){var a=this.frames;if(!(n<a[0])){t=t.bones[this.boneIndex];if(n>=a[a.length-2])for(var r=t.data.rotation+a[a.length-1]-t.rotation;180<r;)r-=360;else{for(var o=spine.Animation.binarySearch(a,n,2),h=a[o-1],l=a[o],n=1-(n-l)/(a[o-2]-l),n=this.curves.getCurvePercent(o/2-1,n),r=a[o+1]-h;180<r;)r-=360;for(;r<-180;)r+=360;for(r=t.data.rotation+(h+r*n)-t.rotation;180<r;)r-=360}for(;r<-180;)r+=360;t.rotation+=r*s}}},spine.TranslateTimeline=function(t){this.curves=new spine.Curves(t),this.frames=new spine.Float32Array(3*t),this.frames.length=3*t},spine.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,n,i){this.frames[t*=3]=e,this.frames[t+1]=n,this.frames[t+2]=i},apply:function(t,e,n,i,s){var a,r,o,h=this.frames;n<h[0]||(t=t.bones[this.boneIndex],n>=h[h.length-3]?(t.x+=(t.data.x+h[h.length-2]-t.x)*s,t.y+=(t.data.y+h[h.length-1]-t.y)*s):(r=h[(a=spine.Animation.binarySearch(h,n,3))-2],o=h[a-1],n=1-(n-(n=h[a]))/(h[a+-3]-n),n=this.curves.getCurvePercent(a/3-1,n),t.x+=(t.data.x+r+(h[a+1]-r)*n-t.x)*s,t.y+=(t.data.y+o+(h[a+2]-o)*n-t.y)*s))}},spine.ScaleTimeline=function(t){this.curves=new spine.Curves(t),this.frames=new spine.Float32Array(3*t),this.frames.length=3*t},spine.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,n,i){this.frames[t*=3]=e,this.frames[t+1]=n,this.frames[t+2]=i},apply:function(t,e,n,i,s){var a,r,o,h=this.frames;n<h[0]||(t=t.bones[this.boneIndex],n>=h[h.length-3]?(t.scaleX+=(t.data.scaleX*h[h.length-2]-t.scaleX)*s,t.scaleY+=(t.data.scaleY*h[h.length-1]-t.scaleY)*s):(r=h[(a=spine.Animation.binarySearch(h,n,3))-2],o=h[a-1],n=1-(n-(n=h[a]))/(h[a+-3]-n),n=this.curves.getCurvePercent(a/3-1,n),t.scaleX+=(t.data.scaleX*(r+(h[a+1]-r)*n)-t.scaleX)*s,t.scaleY+=(t.data.scaleY*(o+(h[a+2]-o)*n)-t.scaleY)*s))}},spine.ColorTimeline=function(t){this.curves=new spine.Curves(t),this.frames=new spine.Float32Array(5*t),this.frames.length=5*t},spine.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(t,e,n,i,s,a){this.frames[t*=5]=e,this.frames[t+1]=n,this.frames[t+2]=i,this.frames[t+3]=s,this.frames[t+4]=a},apply:function(t,e,n,i,s){var a,r,o,h,l,p,u,d,f=this.frames;n<f[0]||(l=n>=f[f.length-5]?(a=f[(h=f.length-1)-3],r=f[h-2],o=f[h-1],f[h]):(l=f[(h=spine.Animation.binarySearch(f,n,5))-4],d=f[h-3],p=f[h-2],u=f[h-1],n=1-(n-(n=f[h]))/(f[h-5]-n),n=this.curves.getCurvePercent(h/5-1,n),a=l+(f[h+1]-l)*n,r=d+(f[h+2]-d)*n,o=p+(f[h+3]-p)*n,u+(f[h+4]-u)*n),d=t.slots[this.slotIndex],s<1?(d.r+=(a-d.r)*s,d.g+=(r-d.g)*s,d.b+=(o-d.b)*s,d.a+=(l-d.a)*s):(d.r=a,d.g=r,d.b=o,d.a=l))}},spine.AttachmentTimeline=function(t){this.curves=new spine.Curves(t),this.frames=new spine.Float32Array(t),this.frames.length=t,this.attachmentNames=[],this.attachmentNames.length=t},spine.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n},apply:function(t,e,n,i,s){var a=this.frames;n<a[0]?n<e&&this.apply(t,e,Number.MAX_VALUE,null,0):(n<e&&(e=-1),a[a=n>=a[a.length-1]?a.length-1:spine.Animation.binarySearch1(a,n)-1]<e||(n=this.attachmentNames[a],t.slots[this.slotIndex].setAttachment(n?t.getAttachmentBySlotIndex(this.slotIndex,n):null)))}},spine.EventTimeline=function(t){this.frames=new spine.Float32Array(t),this.frames.length=t,this.events=[],this.events.length=t},spine.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(t,e){this.frames[t]=e.time,this.events[t]=e},apply:function(t,e,n,i,s){if(i){var a=this.frames,r=a.length;if(n<e)this.apply(t,e,Number.MAX_VALUE,i,s),e=-1;else if(e>=a[r-1])return;if(!(n<a[0])){if(e<a[0])o=0;else for(var o,h=a[o=spine.Animation.binarySearch1(a,e)];0<o&&a[o-1]==h;)o--;for(var l=this.events;o<r&&n>=a[o];o++)i[i.length]=l[o]}}}},spine.DrawOrderTimeline=function(t){this.frames=new spine.Float32Array(t),this.frames.length=t,this.drawOrders=[],this.drawOrders.length=t},spine.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(t,e,n){this.frames[t]=e,this.drawOrders[t]=n},apply:function(t,e,n,i,s){var a=this.frames;if(!(n<a[0])){var a=n>=a[a.length-1]?a.length-1:spine.Animation.binarySearch1(a,n)-1,r=t.drawOrder,o=t.slots,h=this.drawOrders[a];if(h)for(l=0,p=h.length;l<p;l++)r[l]=t.slots[h[l]];else for(var l=0,p=o.length;l<p;l++)r[l]=o[l]}}},spine.FfdTimeline=function(t){this.curves=new spine.Curves(t),this.frames=new spine.Float32Array(t),this.frames.length=t,this.frameVertices=[],this.frameVertices.length=t},spine.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,n){this.frames[t]=e,this.frameVertices[t]=n},apply:function(t,e,n,i,s){var t=t.slots[this.slotIndex],a=t.attachment;if(a&&(a==this.attachment||a.inheritFFD&&a.parentMesh==this.attachment)){a=this.frames;if(!(n<a[0])){var r=this.frameVertices,o=r[0].length,h=t.attachmentVertices;if(h.length!=o&&(t.attachmentVertices=h=new spine.Float32Array(o),s=1),n>=a[a.length-1]){var l=r[a.length-1];if(s<1)for(var p=0;p<o;p++)h[p]+=(l[p]-h[p])*s;else for(p=0;p<o;p++)h[p]=l[p]}else{var t=spine.Animation.binarySearch1(a,n),u=a[t],d=1-(n-u)/(a[t-1]-u),d=this.curves.getCurvePercent(t-1,d<0?0:1<d?1:d),f=r[t-1],c=r[t];if(s<1)for(p=0;p<o;p++){var m=f[p];h[p]+=(m+(c[p]-m)*d-h[p])*s}else for(p=0;p<o;p++){m=f[p];h[p]=m+(c[p]-m)*d}}}}}},spine.IkConstraintTimeline=function(t){this.curves=new spine.Curves(t),this.frames=new spine.Float32Array(3*t),this.frames.length=3*t},spine.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,n,i){this.frames[t*=3]=e,this.frames[t+1]=n,this.frames[t+2]=i},apply:function(t,e,n,i,s){var a,r,o=this.frames;n<o[0]||(t=t.ikConstraints[this.ikConstraintIndex],n>=o[o.length-3]?(t.mix+=(o[o.length-2]-t.mix)*s,t.bendDirection=o[o.length-1]):(r=o[(a=spine.Animation.binarySearch(o,n,3))+-2],n=1-(n-(n=o[a]))/(o[a+-3]-n),n=this.curves.getCurvePercent(a/3-1,n),r=r+(o[a+1]-r)*n,t.mix+=(r-t.mix)*s,t.bendDirection=o[a+-1]))}},spine.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[],this.transformConstraints=[]},spine.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(t){for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].name==t)return e[n];return null},findBoneIndex:function(t){for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},findSlot:function(t){for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].name==t)return slot[n];return null},findSlotIndex:function(t){for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},findSkin:function(t){for(var e=this.skins,n=0,i=e.length;n<i;n++)if(e[n].name==t)return e[n];return null},findEvent:function(t){for(var e=this.events,n=0,i=e.length;n<i;n++)if(e[n].name==t)return e[n];return null},findAnimation:function(t){for(var e=this.animations,n=0,i=e.length;n<i;n++)if(e[n].name==t)return e[n];return null},findIkConstraint:function(t){for(var e=this.ikConstraints,n=0,i=e.length;n<i;n++)if(e[n].name==t)return e[n];return null},findTransformConstraints:function(t){for(var e=this.transformConstraints,n=0,i=e.length;n<i;n++)if(e[n].name==t)return e[n];return null}},spine.Skeleton=function(t){this.data=t,this.bones=[];for(var e=0,n=t.bones.length;e<n;e++){var i=t.bones[e],s=i.parent?this.bones[t.bones.indexOf(i.parent)]:null;this.bones[e]=new spine.Bone(i,this,s)}this.slots=[],this.drawOrder=[];for(e=0,n=t.slots.length;e<n;e++){var a=t.slots[e],r=this.bones[t.bones.indexOf(a.boneData)],a=new spine.Slot(a,r);this.slots[e]=a,this.drawOrder[e]=a}this.ikConstraints=[];for(e=0,n=t.ikConstraints.length;e<n;e++)this.ikConstraints[e]=new spine.IkConstraint(t.ikConstraints[e],this);this.transformConstraints=[];for(e=0,n=t.transformConstraints.length;e<n;e++)this.transformConstraints[e]=new spine.TransformConstraint(t.transformConstraints[e],this);this.cache=[],this.updateCache()},spine.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateCache:function(){for(var t=this.bones,e=this.cache,n=this.ikConstraints,i=this.transformConstraints,s=n.length,a=i.length,r=e.length=0,o=t.length;r<o;r++){var h=t[r];e[e.length]=h;for(var l=0;l<s;l++){var p=n[l];if(h==p.bones[p.bones.length-1]){e[e.length]=p;break}}}for(r=0;r<a;r++)for(var u=i[r],l=e.length-1;0<=l;l--){var d=e[l];if(d==u.bone||d==u.target){e.splice(l+1,0,u);break}}},updateWorldTransform:function(){for(var t=this.cache,e=0,n=t.length;e<n;e++)t[e].update()},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,e=0,n=t.length;e<n;e++)t[e].setToSetupPose();for(var i=this.ikConstraints,e=0,n=i.length;e<n;e++)(s=i[e]).bendDirection=s.data.bendDirection,s.mix=s.data.mix;for(var s,a=this.transformConstraints,e=0,n=a.length;e<n;e++)(s=a[e]).translateMix=s.data.translateMix,s.x=s.data.x,s.y=s.data.y},setSlotsToSetupPose:function(){for(var t=this.slots,e=this.drawOrder,n=0,i=t.length;n<i;n++)e[n]=t[n],t[n].setToSetupPose(n)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(t){for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return e[n];return null},findBoneIndex:function(t){for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1},findSlot:function(t){for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return e[n];return null},findSlotIndex:function(t){for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1},setSkinByName:function(t){var e=this.data.findSkin(t);if(!e)throw"Skin not found: "+t;this.setSkin(e)},setSkin:function(t){if(t)if(this.skin)t._attachAll(this,this.skin);else for(var e=this.slots,n=0,i=e.length;n<i;n++){var s=e[n],a=s.data.attachmentName;a&&(a=t.getAttachment(n,a))&&s.setAttachment(a)}this.skin=t},getAttachmentBySlotName:function(t,e){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(t),e)},getAttachmentBySlotIndex:function(t,e){if(this.skin){var n=this.skin.getAttachment(t,e);if(n)return n}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},setAttachment:function(t,e){for(var n=this.slots,i=0,s=n.length;i<s;i++){var a=n[i];if(a.data.name==t){var r=null;if(e&&!(r=this.getAttachmentBySlotIndex(i,e)))throw"Attachment not found: "+e+", for slot: "+t;return void a.setAttachment(r)}}throw"Slot not found: "+t},findIkConstraint:function(t){for(var e=this.ikConstraints,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return e[n];return null},findTransformConstraint:function(t){for(var e=this.transformConstraints,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return e[n];return null},update:function(t){this.time+=t}},spine.EventData=function(t){this.name=t},spine.EventData.prototype={intValue:0,floatValue:0,stringValue:null},spine.Event=function(t,e){this.time=t,this.data=e},spine.Event.prototype={intValue:0,floatValue:0,stringValue:null},spine.AttachmentType={region:0,boundingbox:1,mesh:2,weightedmesh:3,linkedmesh:4,weightedlinkedmesh:5},spine.RegionAttachment=function(t){this.name=t,this.offset=new spine.Float32Array(8),this.offset.length=8,this.uvs=new spine.Float32Array(8),this.uvs.length=8},spine.RegionAttachment.prototype={type:spine.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,e,n,i,s){var a=this.uvs;s?(a[2]=t,a[3]=i,a[4]=t,a[5]=e,a[6]=n,a[7]=e,a[0]=n,a[1]=i):(a[0]=t,a[1]=i,a[2]=t,a[3]=e,a[4]=n,a[5]=e,a[6]=n,a[7]=i)},updateOffset:function(){var t=this.width/this.regionOriginalWidth*this.scaleX,e=this.height/this.regionOriginalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.regionOffsetX*t,i=-this.height/2*this.scaleY+this.regionOffsetY*e,t=n+this.regionWidth*t,e=i+this.regionHeight*e,s=this.rotation*spine.degRad,a=Math.cos(s),s=Math.sin(s),r=n*a+this.x,n=n*s,o=i*a+this.y,i=i*s,h=t*a+this.x,t=t*s,a=e*a+this.y,e=e*s,s=this.offset;s[0]=r-i,s[1]=o+n,s[2]=r-e,s[3]=a+n,s[4]=h-e,s[5]=a+t,s[6]=h-i,s[7]=o+t},computeVertices:function(t,e,n,i){t+=n.worldX,e+=n.worldY;var s=n.a,a=n.b,r=n.c,n=n.d,o=this.offset;i[0]=o[0]*s+o[1]*a+t,i[1]=o[0]*r+o[1]*n+e,i[2]=o[2]*s+o[3]*a+t,i[3]=o[2]*r+o[3]*n+e,i[4]=o[4]*s+o[5]*a+t,i[5]=o[4]*r+o[5]*n+e,i[6]=o[6]*s+o[7]*a+t,i[7]=o[6]*r+o[7]*n+e}},spine.MeshAttachment=function(t){this.name=t},spine.MeshAttachment.prototype={type:spine.AttachmentType.mesh,vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,inheritFFD:!0,parentMesh:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var t=this.regionU2-this.regionU,e=this.regionV2-this.regionV,n=this.regionUVs.length;if(this.uvs&&this.uvs.length==n||(this.uvs=new spine.Float32Array(n)),this.regionRotate)for(var i=0;i<n;i+=2)this.uvs[i]=this.regionU+this.regionUVs[i+1]*t,this.uvs[i+1]=this.regionV+e-this.regionUVs[i]*e;else for(i=0;i<n;i+=2)this.uvs[i]=this.regionU+this.regionUVs[i]*t,this.uvs[i+1]=this.regionV+this.regionUVs[i+1]*e},computeWorldVertices:function(t,e,n,i){var s=n.bone,a=(t+=s.worldX,e+=s.worldY,s.a),r=s.b,o=s.c,h=s.d,l=this.vertices,p=l.length;n.attachmentVertices.length==p&&(l=n.attachmentVertices);for(var u=0;u<p;u+=2){var d=l[u],f=l[u+1];i[u]=d*a+f*r+t,i[u+1]=d*o+f*h+e}},setParentMesh:function(t){(this.parentMesh=t)&&(this.vertices=t.vertices,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.edges=t.edges,this.width=t.width,this.height=t.height)}},spine.WeightedMeshAttachment=function(t){this.name=t},spine.WeightedMeshAttachment.prototype={type:spine.AttachmentType.weightedmesh,bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,inheritFFD:!0,parentMesh:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(t,e,n,i,s){var a=this.regionU2-this.regionU,r=this.regionV2-this.regionV,o=this.regionUVs.length;if(this.uvs&&this.uvs.length==o||(this.uvs=new spine.Float32Array(o)),this.regionRotate)for(var h=0;h<o;h+=2)this.uvs[h]=this.regionU+this.regionUVs[h+1]*a,this.uvs[h+1]=this.regionV+r-this.regionUVs[h]*r;else for(h=0;h<o;h+=2)this.uvs[h]=this.regionU+this.regionUVs[h]*a,this.uvs[h+1]=this.regionV+this.regionUVs[h+1]*r},computeWorldVertices:function(t,e,n,i){var s,a,r,o,h,l,p,u=n.bone.skeleton.bones,d=this.weights,f=this.bones,c=0,m=0,g=0,v=0,y=f.length;if(n.attachmentVertices.length)for(var w=n.attachmentVertices;m<y;c+=2){for(r=a=0,s=f[m++]+m;m<s;m++,g+=3,v+=2)o=u[f[m]],h=d[g]+w[v],l=d[g+1]+w[v+1],p=d[g+2],a+=(h*o.a+l*o.b+o.worldX)*p,r+=(h*o.c+l*o.d+o.worldY)*p;i[c]=a+t,i[c+1]=r+e}else for(;m<y;c+=2){for(r=a=0,s=f[m++]+m;m<s;m++,g+=3)o=u[f[m]],h=d[g],l=d[g+1],p=d[g+2],a+=(h*o.a+l*o.b+o.worldX)*p,r+=(h*o.c+l*o.d+o.worldY)*p;i[c]=a+t,i[c+1]=r+e}},setParentMesh:function(t){(this.parentMesh=t)&&(this.bones=t.bones,this.weights=t.weights,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.edges=t.edges,this.width=t.width,this.height=t.height)}},spine.BoundingBoxAttachment=function(t){this.name=t,this.vertices=new spine.Float32Array},spine.BoundingBoxAttachment.prototype={type:spine.AttachmentType.boundingbox,computeWorldVertices:function(t,e,n,i){t+=n.worldX,e+=n.worldY;for(var s=n.a,a=n.b,r=n.c,o=n.d,h=this.vertices,l=0,p=h.length;l<p;l+=2){var u=h[l],d=h[l+1];i[l]=u*s+d*a+t,i[l+1]=u*r+d*o+e}}},spine.AnimationStateData=function(t){this.skeletonData=t,this.animationToMixTime={}},spine.AnimationStateData.prototype={defaultMix:0,setMixByName:function(t,e,n){var i=this.skeletonData.findAnimation(t);if(!i)throw"Animation not found: "+t;t=this.skeletonData.findAnimation(e);if(!t)throw"Animation not found: "+e;this.setMix(i,t,n)},setMix:function(t,e,n){this.animationToMixTime[t.name+":"+e.name]=n},getMix:function(t,e){t=t.name+":"+e.name;return this.animationToMixTime.hasOwnProperty(t)?this.animationToMixTime[t]:this.defaultMix}},spine.TrackEntry=function(){},spine.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null},spine.AnimationState=function(t){this.data=t,this.tracks=[],this.events=[]},spine.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(t){t*=this.timeScale;for(var e=0;e<this.tracks.length;e++){var n,i=this.tracks[e];i&&(i.time+=t*i.timeScale,i.previous&&(n=t*i.previous.timeScale,i.previous.time+=n,i.mixTime+=n),(n=i.next)?(n.time=i.lastTime-n.delay,0<=n.time&&this.setCurrent(e,n)):!i.loop&&i.lastTime>=i.endTime&&this.clearTrack(e))}},apply:function(t){for(var e=0;e<this.tracks.length;e++){var n=this.tracks[e];if(n){this.events.length=0;var i,s=n.time,a=n.lastTime,r=n.endTime,o=n.loop,h=(!o&&r<s&&(s=r),n.previous);h?(i=h.time,!h.loop&&i>h.endTime&&(i=h.endTime),h.animation.apply(t,i,i,h.loop,null),1<=(i=n.mixTime/n.mixDuration*n.mix)&&(i=1,n.previous=null),n.animation.mix(t,n.lastTime,s,o,this.events,i)):1==n.mix?n.animation.apply(t,n.lastTime,s,o,this.events):n.animation.mix(t,n.lastTime,s,o,this.events,n.mix);for(var l=0,p=this.events.length;l<p;l++){var u=this.events[l];n.onEvent&&n.onEvent(e,u),this.onEvent&&this.onEvent(e,u)}(o?s%r<a%r:a<r&&r<=s)&&(h=Math.floor(s/r),n.onComplete&&n.onComplete(e,h),this.onComplete)&&this.onComplete(e,h),n.lastTime=n.time}}},clearTracks:function(){for(var t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0},clearTrack:function(t){var e;t>=this.tracks.length||(e=this.tracks[t])&&(e.onEnd&&e.onEnd(t),this.onEnd&&this.onEnd(t),this.tracks[t]=null)},_expandToIndex:function(t){if(t<this.tracks.length)return this.tracks[t];for(;t>=this.tracks.length;)this.tracks[this.tracks.length]=null;return null},setCurrent:function(t,e){var n,i=this._expandToIndex(t);i&&(n=i.previous,i.previous=null,i.onEnd&&i.onEnd(t),this.onEnd&&this.onEnd(t),e.mixDuration=this.data.getMix(i.animation,e.animation),0<e.mixDuration)&&(e.mixTime=0,n&&i.mixTime/i.mixDuration<.5?e.previous=n:e.previous=i),(this.tracks[t]=e).onStart&&e.onStart(t),this.onStart&&this.onStart(t)},setAnimationByName:function(t,e,n){var i=this.data.skeletonData.findAnimation(e);if(i)return this.setAnimation(t,i,n);throw"Animation not found: "+e},setAnimation:function(t,e,n){var i=new spine.TrackEntry;return i.animation=e,i.loop=n,i.endTime=e.duration,this.setCurrent(t,i),i},addAnimationByName:function(t,e,n,i){var s=this.data.skeletonData.findAnimation(e);if(s)return this.addAnimation(t,s,n,i);throw"Animation not found: "+e},addAnimation:function(t,e,n,i){var s=new spine.TrackEntry,a=(s.animation=e,s.loop=n,s.endTime=e.duration,this._expandToIndex(t));if(a){for(;a.next;)a=a.next;a.next=s}else this.tracks[t]=s;return i<=0&&(a?i+=a.endTime-this.data.getMix(a.animation,e):i=0),s.delay=i,s},getCurrent:function(t){return t>=this.tracks.length?null:this.tracks[t]}},spine.SkeletonJson=function(t){this.attachmentLoader=t,this.linkedMeshes=[]},spine.SkeletonJson.prototype={scale:1,readSkeletonData:function(t,e){var n=new spine.SkeletonData,e=(n.name=e,t.skeleton);e&&(n.hash=e.hash,n.version=e.spine,n.width=e.width||0,n.height=e.height||0);for(var i=0,s=(h=t.bones).length;i<s;i++){var a=h[i],r=null;if(a.parent&&!(r=n.findBone(a.parent)))throw"Parent bone not found: "+a.parent;(v=new spine.BoneData(a.name,r)).length=(a.length||0)*this.scale,v.x=(a.x||0)*this.scale,v.y=(a.y||0)*this.scale,v.rotation=a.rotation||0,v.scaleX=a.hasOwnProperty("scaleX")?a.scaleX:1,v.scaleY=a.hasOwnProperty("scaleY")?a.scaleY:1,v.inheritScale=!a.hasOwnProperty("inheritScale")||a.inheritScale,v.inheritRotation=!a.hasOwnProperty("inheritRotation")||a.inheritRotation,n.bones[i]=v}var o=t.ik;if(o)for(i=0,s=o.length;i<s;i++){for(var h,l=o[i],p=new spine.IkConstraintData(l.name),u=0,P=(h=l.bones).length;u<P;u++){var d=n.findBone(h[u]);if(!d)throw"IK bone not found: "+h[u];p.bones[u]=d}if(p.target=n.findBone(l.target),!p.target)throw"Target bone not found: "+l.target;p.bendDirection=!l.hasOwnProperty("bendPositive")||l.bendPositive?1:-1,p.mix=l.hasOwnProperty("mix")?l.mix:1,n.ikConstraints[i]=p}var f=t.transform;if(f)for(i=0,s=f.length;i<s;i++){var c=f[i],m=new spine.TransformConstraintData(c.name);if(m.bone=n.findBone(c.bone),!m.bone)throw"Bone not found: "+c.bone;if(m.target=n.findBone(c.target),!m.target)throw"Target bone not found: "+c.target;m.mix=c.hasOwnProperty("translateMix")?l.translateMix:1,m.x=(c.x||0)*this.scale,m.y=(c.y||0)*this.scale,n.transformConstraints[i]=m}for(var g=t.slots,i=0,s=g.length;i<s;i++){var v,y=g[i];if(!(v=n.findBone(y.bone)))throw"Slot bone not found: "+y.bone;var w=new spine.SlotData(y.name,v),A=y.color;A&&(w.r=this.toColor(A,0),w.g=this.toColor(A,1),w.b=this.toColor(A,2),w.a=this.toColor(A,3)),w.attachmentName=y.attachment,w.blendMode=spine.BlendMode[y.blend||"normal"],n.slots[i]=w}var x,b=t.skins;for(x in b)if(b.hasOwnProperty(x)){var S,k=b[x],C=new spine.Skin(x);for(S in k)if(k.hasOwnProperty(S)){var T,M,U=n.findSlotIndex(S),I=k[S];for(T in I)I.hasOwnProperty(T)&&(M=this.readAttachment(C,U,T,I[T]))&&C.addAttachment(U,T,M)}"default"==(n.skins[n.skins.length]=C).name&&(n.defaultSkin=C)}for(i=0,s=this.linkedMeshes.length;i<s;i++){var _=this.linkedMeshes[i];if(!(C=_.skin?n.findSkin(_.skin):n.defaultSkin))throw"Skin not found: "+_.skin;if(!(r=C.getAttachment(_.slotIndex,_.parent)))throw"Parent mesh not found: "+_.parent;_.mesh.setParentMesh(r),_.mesh.updateUVs()}this.linkedMeshes.length=0;var O,D,X,F=t.events;for(O in F)F.hasOwnProperty(O)&&(D=F[O],(X=new spine.EventData(O)).intValue=D.int||0,X.floatValue=D.float||0,X.stringValue=D.string||null,n.events[n.events.length]=X);var V,Y=t.animations;for(V in Y)Y.hasOwnProperty(V)&&this.readAnimation(V,Y[V],n);return n},readAttachment:function(t,e,n,i){n=i.name||n;var s,a=i.type||"region",r=(a=spine.AttachmentType[a="skinnedmesh"==a?"weightedmesh":a],i.path||n),o=this.scale;switch(a){case spine.AttachmentType.region:var h=this.attachmentLoader.newRegionAttachment(t,n,r);if(!h)return null;h.path=r,h.x=(i.x||0)*o,h.y=(i.y||0)*o,h.scaleX=i.hasOwnProperty("scaleX")?i.scaleX:1,h.scaleY=i.hasOwnProperty("scaleY")?i.scaleY:1,h.rotation=i.rotation||0,h.width=(i.width||0)*o,h.height=(i.height||0)*o;var l=i.color;return l&&(h.r=this.toColor(l,0),h.g=this.toColor(l,1),h.b=this.toColor(l,2),h.a=this.toColor(l,3)),h.updateOffset(),h;case spine.AttachmentType.mesh:case spine.AttachmentType.linkedmesh:return(s=this.attachmentLoader.newMeshAttachment(t,n,r))?(s.path=r,(l=i.color)&&(s.r=this.toColor(l,0),s.g=this.toColor(l,1),s.b=this.toColor(l,2),s.a=this.toColor(l,3)),s.width=(i.width||0)*o,s.height=(i.height||0)*o,i.parent?(s.inheritFFD=!i.hasOwnProperty("ffd")||i.ffd,this.linkedMeshes[this.linkedMeshes.length]={mesh:s,skin:i.skin,slotIndex:e,parent:i.parent}):(s.vertices=this.getFloatArray(i,"vertices",o),s.triangles=this.getUint32Array(i,"triangles"),s.regionUVs=this.getFloatArray(i,"uvs",1),s.updateUVs(),s.hullLength=2*(i.hull||0),i.edges&&(s.edges=this.getUint16Array(i,"edges"))),s):null;case spine.AttachmentType.weightedmesh:case spine.AttachmentType.weightedlinkedmesh:if(!(s=this.attachmentLoader.newWeightedMeshAttachment(t,n,r)))return null;if(s.path=r,(l=i.color)&&(s.r=this.toColor(l,0),s.g=this.toColor(l,1),s.b=this.toColor(l,2),s.a=this.toColor(l,3)),s.width=(i.width||0)*o,s.height=(i.height||0)*o,i.parent)s.inheritFFD=!i.hasOwnProperty("ffd")||i.ffd,this.linkedMeshes[this.linkedMeshes.length]={mesh:s,skin:i.skin,slotIndex:e,parent:i.parent};else{for(var h=this.getFloatArray(i,"uvs",1),p=this.getFloatArray(i,"vertices",1),u=new spine.Float32Array(3*h.length*3),d=new spine.Uint32Array(3*h.length),f=0,c=0,m=0,g=p.length;f<g;)for(var v=0|p[f++],y=f+4*(d[c++]=v);f<y;)d[c++]=p[f],u[m++]=p[f+1]*o,u[m++]=p[f+2]*o,u[m++]=p[f+3],f+=4;s.bones=d,s.weights=u,s.triangles=this.getUint32Array(i,"triangles"),s.regionUVs=h,s.updateUVs(),s.hullLength=2*(i.hull||0),i.edges&&(s.edges=this.getUint16Array(i,"edges"))}return s;case spine.AttachmentType.boundingbox:for(var w=this.attachmentLoader.newBoundingBoxAttachment(t,n),f=0,g=(p=i.vertices).length;f<g;f++)w.vertices[f]=p[f]*o;return w}throw"Unknown attachment type: "+a},readAnimation:function(P,t,e){var n,i=[],s=0,a=t.slots;for(n in a)if(a.hasOwnProperty(n)){var r=a[n],o=e.findSlotIndex(n);for(v in r)if(r.hasOwnProperty(v)){var h=r[v];if("color"==v){(A=new spine.ColorTimeline(h.length)).slotIndex=o;for(var l=0,p=0,u=h.length;p<u;p++){var d=(f=h[p]).color,U=this.toColor(d,0),R=this.toColor(d,1),B=this.toColor(d,2),d=this.toColor(d,3);A.setFrame(l,f.time,U,R,B,d),this.readCurve(A,l,f),l++}i[i.length]=A,s=Math.max(s,A.frames[5*A.getFrameCount()-5])}else{if("attachment"!=v)throw"Invalid timeline type for a slot: "+v+" ("+n+")";for(l=((A=new spine.AttachmentTimeline(h.length)).slotIndex=o,0),p=0,u=h.length;p<u;p++){var f=h[p];A.setFrame(l++,f.time,f.name)}i[i.length]=A,s=Math.max(s,A.frames[A.getFrameCount()-1])}}}var c,m=t.bones;for(c in m)if(m.hasOwnProperty(c)){var g=e.findBoneIndex(c);if(-1==g)throw"Bone not found: "+c;var v,W=m[c];for(v in W)if(W.hasOwnProperty(v)){h=W[v];if("rotate"==v){for(l=((A=new spine.RotateTimeline(h.length)).boneIndex=g,0),p=0,u=h.length;p<u;p++){f=h[p];A.setFrame(l,f.time,f.angle),this.readCurve(A,l,f),l++}i[i.length]=A,s=Math.max(s,A.frames[2*A.getFrameCount()-2])}else{if("translate"!=v&&"scale"!=v)throw"Invalid timeline type for a bone: "+v+" ("+c+")";for(var E=1,l=("scale"==v?A=new spine.ScaleTimeline(h.length):(A=new spine.TranslateTimeline(h.length),E=this.scale),A.boneIndex=g,0),p=0,u=h.length;p<u;p++){var L=((f=h[p]).x||0)*E,N=(f.y||0)*E;A.setFrame(l,f.time,L,N),this.readCurve(A,l,f),l++}i[i.length]=A,s=Math.max(s,A.frames[3*A.getFrameCount()-3])}}}var y,H=t.ik;for(y in H)if(H.hasOwnProperty(y)){for(var j=e.findIkConstraint(y),h=H[y],l=((A=new spine.IkConstraintTimeline(h.length)).ikConstraintIndex=e.ikConstraints.indexOf(j),0),p=0,u=h.length;p<u;p++){var z=(f=h[p]).hasOwnProperty("mix")?f.mix:1,q=!f.hasOwnProperty("bendPositive")||f.bendPositive?1:-1;A.setFrame(l,f.time,z,q),this.readCurve(A,l,f),l++}i[i.length]=A,s=Math.max(s,A.frames[3*A.getFrameCount()-3])}var J,G=t.ffd;for(J in G){var K=e.findSkin(J);for(n in r=G[J]){var w,o=e.findSlotIndex(n),$=r[n];for(w in $){var h=$[w],A=new spine.FfdTimeline(h.length),x=K.getAttachment(o,w);if(!x)throw"FFD attachment not found: "+w;A.slotIndex=o;for(var Q=(A.attachment=x).type==spine.AttachmentType.mesh,b=Q?x.vertices.length:x.weights.length/3*2,l=0,p=0,u=h.length;p<u;p++){if((f=h[p]).vertices){var S,Z=f.vertices,tt=((S=new spine.Float32Array(b)).length=b,f.offset||0),k=Z.length;if(1==this.scale)for(var C=0;C<k;C++)S[C+tt]=Z[C];else for(C=0;C<k;C++)S[C+tt]=Z[C]*this.scale;if(Q)for(var et=x.vertices,C=0,k=S.length;C<k;C++)S[C]+=et[C]}else Q?S=x.vertices:(S=new spine.Float32Array(b)).length=b;A.setFrame(l,f.time,S),this.readCurve(A,l,f),l++}i[i.length]=A,s=Math.max(s,A.frames[A.getFrameCount()-1])}}}var T=t.drawOrder;if(T=T||t.draworder){for(var A=new spine.DrawOrderTimeline(T.length),M=e.slots.length,l=0,p=0,u=T.length;p<u;p++){var nt=T[p],I=null;if(nt.offsets){for(C=((I=new spine.Uint32Array(M)).length=M)-1;0<=C;C--)I[C]=4294967295;for(var _=nt.offsets,O=new spine.Uint32Array(M-_.length),D=(O.length=M-_.length,0),it=0,C=0,k=_.length;C<k;C++){var st=_[C];if(-1==(o=e.findSlotIndex(st.slot)))throw"Slot not found: "+st.slot;for(;D!=o;)O[it++]=D++;I[D+st.offset]=D++}for(;D<M;)O[it++]=D++;for(C=M-1;0<=C;C--)4294967295==I[C]&&(I[C]=O[--it])}A.setFrame(l++,nt.time,I)}i[i.length]=A,s=Math.max(s,A.frames[A.getFrameCount()-1])}var X=t.events;if(X){for(A=new spine.EventTimeline(X.length),l=0,p=0,u=X.length;p<u;p++){var F=X[p],V=e.findEvent(F.name);if(!V)throw"Event not found: "+F.name;var Y=new spine.Event(F.time,V);Y.intValue=F.hasOwnProperty("int")?F.int:V.intValue,Y.floatValue=F.hasOwnProperty("float")?F.float:V.floatValue,Y.stringValue=F.hasOwnProperty("string")?F.string:V.stringValue,A.setFrame(l++,Y)}i[i.length]=A,s=Math.max(s,A.frames[A.getFrameCount()-1])}e.animations[e.animations.length]=new spine.Animation(P,i,s)},readCurve:function(t,e,n){n=n.curve;n?"stepped"==n?t.curves.setStepped(e):n instanceof Array&&t.curves.setCurve(e,n[0],n[1],n[2],n[3]):t.curves.setLinear(e)},toColor:function(t,e){if(8!=t.length)throw"Color hexidecimal length must be 8, recieved: "+t;return parseInt(t.substring(2*e,2*e+2),16)/255},getFloatArray:function(t,e,n){var i=t[e],s=new spine.Float32Array(i.length),a=0,r=i.length;if(1==n)for(;a<r;a++)s[a]=i[a];else for(;a<r;a++)s[a]=i[a]*n;return s},getUint32Array:function(t,e){for(var n=t[e],i=new spine.Uint32Array(n.length),s=0,a=n.length;s<a;s++)i[s]=0|n[s];return i},getUint16Array:function(t,e){for(var n=t[e],i=new spine.Uint16Array(n.length),s=0,a=n.length;s<a;s++)i[s]=0|n[s];return i}},spine.Atlas=function(t,e){this.textureLoader=e,this.pages=[],this.regions=[];for(var n=new spine.AtlasReader(t),i=[],s=(i.length=4,null);;){var a,r,o,h,l,p=n.readLine();if(null===p)break;(p=n.trim(p)).length?s?((a=new spine.AtlasRegion).name=p,a.page=s,a.rotate="true"==n.readValue(),n.readTuple(i),l=parseInt(i[0]),r=parseInt(i[1]),n.readTuple(i),o=parseInt(i[0]),h=parseInt(i[1]),a.u=l/s.width,a.v=r/s.height,a.rotate?(a.u2=(l+h)/s.width,a.v2=(r+o)/s.height):(a.u2=(l+o)/s.width,a.v2=(r+h)/s.height),a.x=l,a.y=r,a.width=Math.abs(o),a.height=Math.abs(h),4==n.readTuple(i)&&(a.splits=[parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],4==n.readTuple(i))&&(a.pads=[parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],n.readTuple(i)),a.originalWidth=parseInt(i[0]),a.originalHeight=parseInt(i[1]),n.readTuple(i),a.offsetX=parseInt(i[0]),a.offsetY=parseInt(i[1]),a.index=parseInt(n.readValue()),this.regions[this.regions.length]=a):((s=new spine.AtlasPage).name=p,2==n.readTuple(i)&&(s.width=parseInt(i[0]),s.height=parseInt(i[1]),n.readTuple(i)),s.format=spine.Atlas.Format[i[0]],n.readTuple(i),s.minFilter=spine.Atlas.TextureFilter[i[0]],s.magFilter=spine.Atlas.TextureFilter[i[1]],l=n.readValue(),s.uWrap=spine.Atlas.TextureWrap.clampToEdge,s.vWrap=spine.Atlas.TextureWrap.clampToEdge,"x"==l?s.uWrap=spine.Atlas.TextureWrap.repeat:"y"==l?s.vWrap=spine.Atlas.TextureWrap.repeat:"xy"==l&&(s.uWrap=s.vWrap=spine.Atlas.TextureWrap.repeat),e.load(s,p,this),this.pages[this.pages.length]=s):s=null}},spine.Atlas.prototype={findRegion:function(t){for(var e=this.regions,n=0,i=e.length;n<i;n++)if(e[n].name==t)return e[n];return null},dispose:function(){for(var t=this.pages,e=0,n=t.length;e<n;e++)this.textureLoader.unload(t[e].rendererObject)},updateUVs:function(t){for(var e=this.regions,n=0,i=e.length;n<i;n++){var s=e[n];s.page==t&&(s.u=s.x/t.width,s.v=s.y/t.height,s.rotate?(s.u2=(s.x+s.height)/t.width,s.v2=(s.y+s.width)/t.height):(s.u2=(s.x+s.width)/t.width,s.v2=(s.y+s.height)/t.height))}}},spine.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},spine.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},spine.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},spine.AtlasPage=function(){},spine.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},spine.AtlasRegion=function(){},spine.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},spine.AtlasReader=function(t){this.lines=t.split(/\r\n|\r|\n/)},spine.AtlasReader.prototype={index:0,trim:function(t){return t.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw"Invalid line: "+t;return this.trim(t.substring(e+1))},readTuple:function(t){var e=this.readLine(),n=e.indexOf(":");if(-1==n)throw"Invalid line: "+e;for(var i=0,s=n+1;i<3;i++){var a=e.indexOf(",",s);if(-1==a)break;t[i]=this.trim(e.substr(s,a-s)),s=a+1}return t[i]=this.trim(e.substring(s)),i+1}},spine.AtlasAttachmentLoader=function(t){this.atlas=t},spine.AtlasAttachmentLoader.prototype={newRegionAttachment:function(t,e,n){var i,s=this.atlas.findRegion(n);if(s)return(i=new spine.RegionAttachment(e)).rendererObject=s,i.setUVs(s.u,s.v,s.u2,s.v2,s.rotate),i.regionOffsetX=s.offsetX,i.regionOffsetY=s.offsetY,i.regionWidth=s.width,i.regionHeight=s.height,i.regionOriginalWidth=s.originalWidth,i.regionOriginalHeight=s.originalHeight,i;throw"Region not found in atlas: "+n+" (region attachment: "+e+")"},newMeshAttachment:function(t,e,n){var i,s=this.atlas.findRegion(n);if(s)return(i=new spine.MeshAttachment(e)).rendererObject=s,i.regionU=s.u,i.regionV=s.v,i.regionU2=s.u2,i.regionV2=s.v2,i.regionRotate=s.rotate,i.regionOffsetX=s.offsetX,i.regionOffsetY=s.offsetY,i.regionWidth=s.width,i.regionHeight=s.height,i.regionOriginalWidth=s.originalWidth,i.regionOriginalHeight=s.originalHeight,i;throw"Region not found in atlas: "+n+" (mesh attachment: "+e+")"},newWeightedMeshAttachment:function(t,e,n){var i,s=this.atlas.findRegion(n);if(s)return(i=new spine.WeightedMeshAttachment(e)).rendererObject=s,i.regionU=s.u,i.regionV=s.v,i.regionU2=s.u2,i.regionV2=s.v2,i.regionRotate=s.rotate,i.regionOffsetX=s.offsetX,i.regionOffsetY=s.offsetY,i.regionWidth=s.width,i.regionHeight=s.height,i.regionOriginalWidth=s.originalWidth,i.regionOriginalHeight=s.originalHeight,i;throw"Region not found in atlas: "+n+" (weighted mesh attachment: "+e+")"},newBoundingBoxAttachment:function(t,e){return new spine.BoundingBoxAttachment(e)}},spine.SkeletonBounds=function(){this.polygonPool=[],this.polygons=[],this.boundingBoxes=[]},spine.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(t,e){for(var n=t.slots,i=n.length,s=t.x,a=t.y,r=this.boundingBoxes,o=this.polygonPool,h=this.polygons,l=r.length=0,p=h.length;l<p;l++)o[o.length]=h[l];for(l=h.length=0;l<i;l++){var u,d,f=n[l],c=f.attachment;c.type==spine.AttachmentType.boundingbox&&(r[r.length]=c,0<(u=o.length)?(d=o[u-1],o.splice(u-1,1)):d=new spine.Float32Array,(h[h.length]=d).length=c.vertices.length,c.computeWorldVertices(s,a,f.bone,d))}e&&this.aabbCompute()},aabbCompute:function(){for(var t=this.polygons,e=Number.MAX_VALUE,n=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=-Number.MAX_VALUE,a=0,r=t.length;a<r;a++)for(var o=t[a],h=0,l=o.length;h<l;h+=2)var p=o[h],u=o[h+1],e=Math.min(e,p),n=Math.min(n,u),i=Math.max(i,p),s=Math.max(s,u);this.minX=e,this.minY=n,this.maxX=i,this.maxY=s},aabbContainsPoint:function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},aabbIntersectsSegment:function(t,e,n,i){var s=this.minX,a=this.minY,r=this.maxX,o=this.maxY;return!(t<=s&&n<=s||e<=a&&i<=a||r<=t&&r<=n||o<=e&&o<=i)&&(a<(n=(i=(i-e)/(n-t))*(s-t)+e)&&n<o||a<(n=i*(r-t)+e)&&n<o||s<(n=(a-e)/i+t)&&n<r||s<(n=(o-e)/i+t)&&n<r)},aabbIntersectsSkeleton:function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},containsPoint:function(t,e){for(var n=this.polygons,i=0,s=n.length;i<s;i++)if(this.polygonContainsPoint(n[i],t,e))return this.boundingBoxes[i];return null},intersectsSegment:function(t,e,n,i){for(var s=this.polygons,a=0,r=s.length;a<r;a++)if(s[a].intersectsSegment(t,e,n,i))return this.boundingBoxes[a];return null},polygonContainsPoint:function(t,e,n){for(var i=t.length,s=i-2,a=!1,r=0;r<i;r+=2){var o,h=t[r+1],l=t[s+1];(h<n&&n<=l||l<n&&n<=h)&&(o=t[r])+(n-h)/(l-h)*(t[s]-o)<e&&(a=!a),s=r}return a},polygonIntersectsSegment:function(t,e,n,i,s){for(var a=t.length,r=e-i,o=n-s,h=e*s-n*i,l=t[a-2],p=t[a-1],u=0;u<a;u+=2){var d=t[u],f=t[u+1],c=l*f-p*d,m=l-d,g=p-f,v=r*g-o*m,m=(h*m-r*c)/v;if((l<=m&&m<=d||d<=m&&m<=l)&&(e<=m&&m<=i||i<=m&&m<=e)){m=(h*g-o*c)/v;if((p<=m&&m<=f||f<=m&&m<=p)&&(n<=m&&m<=s||s<=m&&m<=n))return!0}l=d,p=f}return!1},getPolygon:function(t){t=this.boundingBoxes.indexOf(t);return-1==t?null:this.polygons[t]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}},pc.extend(pc,function(){function s(t){this._textureData=t}function t(t,e,n,i){this._app=t,this._position=new pc.Vec3,t=new spine.Atlas(e,new s(i)),(e=new spine.SkeletonJson(new spine.AtlasAttachmentLoader(t))).scale*=.01,i=e.readSkeletonData(n),this.skeleton=new spine.Skeleton(i),this.skeleton.updateWorldTransform(),this.stateData=new spine.AnimationStateData(this.skeleton.data),this.states=[new spine.AnimationState(this.stateData)],this._node=new pc.GraphNode,this._meshInstances=[],this._materials={},this._priority=0,this._layers=[pc.LAYERID_WORLD],this.update(0),this.autoUpdate=!0,this._model=new pc.Model,this._model.graph=this._node,this._model.meshInstances=this._meshInstances,this._modelChanged=!0,this._reordered=!0,this._hidden=!1}s.prototype={load:function(t,e,n){e=this._textureData[e];e&&(t.rendererObject=e,t.width=e.width,t.height=e.height,n.updateUVs(t))},unload:function(t){t.destroy()}};return t.prototype={destroy:function(){this._model&&this._removeFromLayers(),this._model=null,this._meshInstances=[],this.skeleton=null,this.stateData=null,this.state=null,this._materials={},this._node=null},hide:function(){if(!this._hidden){for(var t=this.skeleton.drawOrder,e=0,n=t.length;e<n;e++){var i=t[e];i.current&&i.current.meshInstance&&(i.current.meshInstance.visible=!1)}this._hidden=!0}},show:function(){if(this._hidden){for(var t=this.skeleton.drawOrder,e=0,n=t.length;e<n;e++){var i=t[e];i.current&&i.current.meshInstance&&(i.current.meshInstance.visible=!0)}this._hidden=!1}},updateSlot:function(t,e){var n=e.attachment;if(e.current&&e.current.meshInstance&&(e.current.meshInstance.visible=!1),n){var i=n.name;if(void 0===e.positions&&(e.vertices=[],e.positions=[]),void 0===e.meshes&&(e.current={mesh:null,meshInstance:null},e.meshes={},e.meshInstances={},e.materials={}),n.computeVertices&&n.computeVertices(this.skeleton.x,this.skeleton.y,e.bone,e.vertices),n.computeWorldVertices&&n.computeWorldVertices(this.skeleton.x,this.skeleton.y,e,e.vertices),n instanceof spine.RegionAttachment)e.positions=[e.vertices[0],e.vertices[1],this._position.z,e.vertices[2],e.vertices[3],this._position.z,e.vertices[4],e.vertices[5],this._position.z,e.vertices[6],e.vertices[7],this._position.z],void 0===e.meshes[i]&&(s={normals:[0,1,0,0,1,0,0,1,0,0,1,0],uvs:[n.uvs[0],n.uvs[1],n.uvs[2],n.uvs[3],n.uvs[4],n.uvs[5],n.uvs[6],n.uvs[7]],indices:[0,3,2,2,1,0]},e.meshes[i]=pc.createMesh(this._app.graphicsDevice,e.positions,s),e.meshes[i].name=i);else if(n instanceof spine.WeightedMeshAttachment||n instanceof spine.MeshAttachment){for(var s,a=0,r=[],o=0,h=e.vertices.length;o<h;o+=2)e.positions[a]=e.vertices[o],e.positions[a+1]=e.vertices[o+1],e.positions[a+2]=this._position.z,r[a]=0,r[a+1]=1,r[a+2]=0,a+=3;void 0===e.meshes[i]&&(s={normals:r,uvs:n.uvs.map(function(t,e){return e%2?1-t:t}),indices:n.triangles.reverse()},e.meshes[i]=pc.createMesh(this._app.graphicsDevice,e.positions,s),e.meshes[i].name=i)}void 0===e.materials[i]&&(s=n.rendererObject.page.rendererObject)&&(s instanceof pc.StandardMaterial?(e.materials[i]=s,this._materials[s.name]=s):(n=null,(n=s.getSource()instanceof Image?s.getSource().getAttribute("src"):n)&&void 0!==this._materials[n]?e.materials[i]=this._materials[n]:(e.materials[i]=new pc.StandardMaterial,e.materials[i].shadingModel=pc.SPECULAR_BLINN,e.materials[i].diffuse=new pc.Color(0,0,0),e.materials[i].emissiveMap=s,e.materials[i].opacityMap=s,e.materials[i].opacityMapChannel="a",e.materials[i].depthWrite=!1,e.materials[i].cull=pc.CULLFACE_NONE,e.materials[i].blendType=pc.BLEND_PREMULTIPLIED,e.materials[i].update(),e.materials[i].chunks.outputAlphaPremulPS=pc.shaderChunks.outputAlphaPS,n&&(this._materials[n]=e.materials[i])))),void 0===e.meshInstances[i]&&(e.meshInstances[i]=new pc.MeshInstance(this._node,e.meshes[i],e.materials[i]),this._meshInstances.push(e.meshInstances[i]),this._modelChanged=!0,this._reordered=!0),e.meshes[i].updateVertices(e.positions),e.current.mesh=e.meshes[i],e.current.meshInstance=e.meshInstances[i],e.current.meshInstance.visible=!0}},reorder:function(){for(var t=this.skeleton.drawOrder,e=0,n=t.length;e<n;e++){var i,s=t[e];s.attachment&&(i=s.attachment.name,s=s.meshInstances[i])&&(s.drawOrder=e+1e3*this.priority)}},update:function(t){if(!this._hidden){for(var e=0,n=this.states.length;e<n;e++)this.states[e].update(t);for(e=0,n=this.states.length;e<n;e++)this.states[e].apply(this.skeleton);this.autoUpdate&&this.skeleton.updateWorldTransform();for(var i=this.skeleton.drawOrder,e=0,n=i.length;e<n;e++){var s=i[e];this.updateSlot(e,s)}this._modelChanged&&this._model&&(this._removeFromLayers(),this._addToLayers(),this._modelChanged=!1),this._reordered&&this.reorder(),this._reordered=!1}},setPosition:function(t){this._position.copy(t)},_removeFromLayers:function(){for(var t=0;t<this._layers.length;t++){var e=this._layers[t],e=this._app.scene.layers.getLayerById(e);e&&e.removeMeshInstances(this._model.meshInstances)}},_addToLayers:function(){for(var t=0;t<this._layers.length;t++){var e=this._layers[t],e=this._app.scene.layers.getLayerById(e);e&&e.addMeshInstances(this._model.meshInstances)}}},Object.defineProperty(t.prototype,"state",{get:function(){return this.states[0]}}),Object.defineProperty(t.prototype,"priority",{get:function(){return this._priority},set:function(t){this._priority=t,this._reordered=!0}}),Object.defineProperty(t.prototype,"layers",{get:function(){return this._layers},set:function(t){this._model&&this._removeFromLayers(),this._layers=t||[],this._model&&this._addToLayers()}}),{Spine:t}}()),pc.extend(pc,function(){var i=function(t){this.id="spine",this.description="",this.ComponentType=pc.SpineComponent,this.DataType=pc.SpineComponentData,this.schema=["enabled","atlasAsset","textureAssets","skeletonAsset","atlasData","textures","skeletonData","speed","spine"],this.on("remove",this.onRemove,this),this.app.systems.on("update",this.onUpdate,this)},i=pc.inherits(i,pc.ComponentSystem);return pc.extend(i.prototype,{initializeComponentData:function(t,e,n){i._super.initializeComponentData.call(this,t,e,["enabled","atlasAsset","textureAssets","skeletonAsset","atlasData","textures","skeletonData","spine"])},removeComponent:function(t){t=t.spine.data;t.spine&&t.spine.destroy()},onUpdate:function(t){var e,n,i,s=this.store;for(e in s)s.hasOwnProperty(e)&&(i=(n=s[e]).data).enabled&&n.entity.enabled&&i.spine&&(i.spine.setPosition(n.entity.getPosition()),i.spine.update(i.speed*t))},onRemove:function(t,e){}}),{SpineComponentSystem:i}}()),pc.extend(pc,function(){var e=function(t,e){this.on("set_atlasAsset",this.onSetAsset,this),this.on("set_textureAssets",this.onSetAssets,this),this.on("set_skeletonAsset",this.onSetAsset,this),this.on("set_atlasData",this.onSetResource,this),this.on("set_textures",this.onSetResource,this),this.on("set_skeletonData",this.onSetResource,this)},e=pc.inherits(e,pc.Component);return pc.extend(e.prototype,{_createSpine:function(){this.data.spine&&(this.data.spine.destroy(),this.data.spine=null);for(var t={},e=0,n=this.textureAssets.length;e<n;e++){var i=this.system.app.assets.get(this.textureAssets[e]),s=pc.path.getBasename(i.file.url),a=s.indexOf("?");t[s=-1!==a?s.substring(0,a):s]=i.resource}this.data.spine=new pc.Spine(this.system.app,this.atlasData,this.skeletonData,t),this.state=this.data.spine.state,this.states=this.data.spine.states,this.skeleton=this.data.spine.skeleton,this.entity.addChild(this.data.spine._node)},_onAssetReady:function(t){"texture"===t.type&&this.textures.push(t.resource),"json"===t.type&&(this.skeletonData=t.resource),"text"===t.type&&(this.atlasData=t.resource)},_onAssetAdd:function(t){t.off("change",this.onAssetChanged,this),t.on("change",this.onAssetChanged,this),t.off("remove",this.onAssetRemoved,this),t.on("remove",this.onAssetRemoved,this),t.ready(this._onAssetReady,this),this.system.app.assets.load(t)},onSetResource:function(){this.data.atlasData&&this.data.textures.length&&this.data.skeletonData&&this._createSpine()},onSetAsset:function(t,e,n){var i=this.system.app.assets,s=null;e&&(s=i.get(e))&&(s.off("change",this.onAssetChanged),s.off("remove",this.onAssetRemoved)),n&&((e=n)instanceof pc.Asset&&(e=n.id,this.data[t]=e),(s=i.get(e))?this._onAssetAdd(s):i.on("add:"+e))},onSetAssets:function(t,e,n){var i=this.system.app.assets,s=null;if(e.length)for(r=0,o=e.length;r<o;r++)(s=i.get(e[r]))&&(s.off("change",this.onAssetChanged),s.off("remove",this.onAssetRemoved));if(n&&n.length)for(var a=n.map(function(t){return t instanceof pc.Asset?t.id:t}),r=0,o=n.length;r<o;r++)(s=i.get(a[r]))?this._onAssetAdd(s):i.on("add:"+a[r])},onAssetChanged:function(t,e,n,i){},onAssetRemoved:function(t){},onEnable:function(){e._super.onEnable.call(this);var t=this.data.spine;t&&t._model&&this.system.app.scene.addModel(t._model)},onDisable:function(){e._super.onDisable.call(this);var t=this.data.spine;t&&t._model&&this.system.app.scene.removeModel(t._model)},hide:function(){this.data.spine&&this.data.spine.hide()},show:function(){this.data.spine&&this.data.spine.show()}}),{SpineComponent:e}}()),pc.extend(pc,{SpineComponentData:function(){this.enabled=!0,this.atlasAsset=null,this.textureAssets=[],this.skeletonAsset=null,this.speed=1,this.spine=null,this.atlasData=null,this.textures=[],this.skeletonData=null}}),function(){var t,e;pc.Mesh.prototype.updateVertices=function(t,e,n,i){for(var s=t.length/3,a=new pc.VertexIterator(this.vertexBuffer),r=0;r<s;r++)a.element[pc.SEMANTIC_POSITION].set(t[3*r],t[3*r+1],t[3*r+2]),e&&a.element[pc.SEMANTIC_NORMAL].set(e[3*r],e[3*r+1],e[3*r+2]),n&&a.element[pc.SEMANTIC_TANGENT].set(n[4*r],n[4*r+1],n[4*r+2],n[4*r+3]),i&&a.element[pc.SEMANTIC_TEXCOORD0].set(i[2*r],i[2*r+1]),a.next();a.end()},pc.Application.registerPlugin?pc.Application.registerPlugin("spine",function(t){new pc.SpineComponentSystem(t)}):(t=pc.Application.getApplication(),e=new pc.SpineComponentSystem(t),t.systems.add(e))}();